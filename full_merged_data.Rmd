---
title: "fnl_passing_all"
author: "Baltika"
date: "19 01 2020"
output: pdf_document
---

```{r}
library('igraph')
library('dplyr')
library('varhandle')
library(factoextra)
library(dummies)
library(stringr)
library(dplyr)
library(openxlsx)
library(tidyr)

column_names = c('total_passes_closeness',	'total_passes_betw',	'total_passes_pagerank',	'total_passes_transitivity',	'forward_passes_closeness',	'forward_passes_betw', 'forward_passes_pagerank',	'forward_passes_transitivity',	'back_passes_closeness',	'back_passes_betw',	'back_passes_pagerank',	'back_passes_transitivity',	'long_passes_closeness',	'long_passes_betw',	'long_passes_pagerank',	'long_passes_transitivity',	'final_3rd_passes_closeness',	'final_3rd_passes_betw',	'final_3rd_passes_pagerank',	'final_3rd_passes_transitivity',	'progressive_passes_closeness',	'progressive_passes_betw',	'progressive_passes_pagerank',	'progressive_passes_transitivity')




#total_passes
Armavir_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Armavir/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Armavir_players = Armavir_total_passes$X
Armavir_total_passes$X = NULL
rownames(Armavir_total_passes) = Armavir_players
Armavir_total_passes_matrix <- as.matrix(Armavir_total_passes)
Armavir_total_passes_graph = graph_from_adjacency_matrix(Armavir_total_passes_matrix, mode = "directed", weighted = TRUE)
Armavir_total_passes_closeness= centr_clo(Armavir_total_passes_graph, mode='total', normalized = TRUE)
Armavir_total_passes_betw = centralization.betweenness(Armavir_total_passes_graph, normalized =TRUE)
Armavir_total_passes_pagerank= page_rank(Armavir_total_passes_graph, algo ="power", vids = V(Armavir_total_passes_graph), directed = TRUE, weights = E(Armavir_total_passes_graph)$weight)
Armavir_total_passes_closeness = Armavir_total_passes_closeness[['res']]
Armavir_total_passes_betw = Armavir_total_passes_betw[['res']]
Armavir_total_passes_pagerank = Armavir_total_passes_pagerank[["vector"]]
Armavir_total_passes_transitivity = transitivity(Armavir_total_passes_graph,  type="weighted")
Armavir_total_passes_closeness[is.nan(Armavir_total_passes_closeness)] = 0
Armavir_total_passes_betw[is.nan(Armavir_total_passes_betw)] = 0
Armavir_total_passes_pagerank[is.nan(Armavir_total_passes_pagerank)] = 0
Armavir_total_passes_transitivity[is.nan(Armavir_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Armavir_total_passes_metrics=cbind(Armavir_players,Armavir_total_passes_closeness, Armavir_total_passes_betw,  Armavir_total_passes_pagerank, Armavir_total_passes_transitivity)
colnames(Armavir_total_passes_metrics)[1] = 'Player' 

#forward_passes
Armavir_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Armavir/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Armavir_players = Armavir_forward_passes$X
Armavir_forward_passes$X = NULL
rownames(Armavir_forward_passes) = Armavir_players
Armavir_forward_passes_matrix <- as.matrix(Armavir_forward_passes)
Armavir_forward_passes_graph = graph_from_adjacency_matrix(Armavir_forward_passes_matrix, mode = "directed", weighted = TRUE)
Armavir_forward_passes_closeness= centr_clo(Armavir_forward_passes_graph, mode='total', normalized = TRUE)
Armavir_forward_passes_betw = centralization.betweenness(Armavir_forward_passes_graph, normalized =TRUE)
Armavir_forward_passes_pagerank= page_rank(Armavir_forward_passes_graph, algo ="power", vids = V(Armavir_forward_passes_graph), directed = TRUE, weights = E(Armavir_forward_passes_graph)$weight)
Armavir_forward_passes_closeness = Armavir_forward_passes_closeness[['res']]
Armavir_forward_passes_betw = Armavir_forward_passes_betw[['res']]
Armavir_forward_passes_pagerank = Armavir_forward_passes_pagerank[["vector"]]
Armavir_forward_passes_transitivity = transitivity(Armavir_forward_passes_graph,  type="weighted")
Armavir_forward_passes_closeness[is.nan(Armavir_forward_passes_closeness)] = 0
Armavir_forward_passes_betw[is.nan(Armavir_forward_passes_betw)] = 0
Armavir_forward_passes_pagerank[is.nan(Armavir_forward_passes_pagerank)] = 0
Armavir_forward_passes_transitivity[is.nan(Armavir_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Armavir_forward_passes_metrics=cbind(Armavir_players,Armavir_forward_passes_closeness, Armavir_forward_passes_betw,  Armavir_forward_passes_pagerank, Armavir_forward_passes_transitivity)
colnames(Armavir_forward_passes_metrics)[1] = 'Player' 


#back_passes
Armavir_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Armavir/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Armavir_players = Armavir_back_passes$X
Armavir_back_passes$X = NULL
rownames(Armavir_back_passes) = Armavir_players
Armavir_back_passes_matrix <- as.matrix(Armavir_back_passes)
Armavir_back_passes_graph = graph_from_adjacency_matrix(Armavir_back_passes_matrix, mode = "directed", weighted = TRUE)
Armavir_back_passes_closeness= centr_clo(Armavir_back_passes_graph, mode='total', normalized = TRUE)
Armavir_back_passes_betw = centralization.betweenness(Armavir_back_passes_graph, normalized =TRUE)
Armavir_back_passes_pagerank= page_rank(Armavir_back_passes_graph, algo ="power", vids = V(Armavir_back_passes_graph), directed = TRUE, weights = E(Armavir_back_passes_graph)$weight)
Armavir_back_passes_closeness = Armavir_back_passes_closeness[['res']]
Armavir_back_passes_betw = Armavir_back_passes_betw[['res']]
Armavir_back_passes_pagerank = Armavir_back_passes_pagerank[["vector"]]
Armavir_back_passes_transitivity = transitivity(Armavir_back_passes_graph,  type="weighted")
Armavir_back_passes_closeness[is.nan(Armavir_back_passes_closeness)] = 0
Armavir_back_passes_betw[is.nan(Armavir_back_passes_betw)] = 0
Armavir_back_passes_pagerank[is.nan(Armavir_back_passes_pagerank)] = 0
Armavir_back_passes_transitivity[is.nan(Armavir_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Armavir_back_passes_metrics=cbind(Armavir_players,Armavir_back_passes_closeness, Armavir_back_passes_betw,  Armavir_back_passes_pagerank, Armavir_back_passes_transitivity)
colnames(Armavir_back_passes_metrics)[1] = 'Player'  


#long_passes
Armavir_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Armavir/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Armavir_players = Armavir_long_passes$X
Armavir_long_passes$X = NULL
rownames(Armavir_long_passes) = Armavir_players
Armavir_long_passes_matrix <- as.matrix(Armavir_long_passes)
Armavir_long_passes_graph = graph_from_adjacency_matrix(Armavir_long_passes_matrix, mode = "directed", weighted = TRUE)
Armavir_long_passes_closeness= centr_clo(Armavir_long_passes_graph, mode='total', normalized = TRUE)
Armavir_long_passes_betw = centralization.betweenness(Armavir_long_passes_graph, normalized =TRUE)
Armavir_long_passes_pagerank= page_rank(Armavir_long_passes_graph, algo ="power", vids = V(Armavir_long_passes_graph), directed = TRUE, weights = E(Armavir_long_passes_graph)$weight)
Armavir_long_passes_closeness = Armavir_long_passes_closeness[['res']]
Armavir_long_passes_betw = Armavir_long_passes_betw[['res']]
Armavir_long_passes_pagerank = Armavir_long_passes_pagerank[["vector"]]
Armavir_long_passes_transitivity = transitivity(Armavir_long_passes_graph,  type="weighted")
Armavir_long_passes_closeness[is.nan(Armavir_long_passes_closeness)] = 0
Armavir_long_passes_betw[is.nan(Armavir_long_passes_betw)] = 0
Armavir_long_passes_pagerank[is.nan(Armavir_long_passes_pagerank)] = 0
Armavir_long_passes_transitivity[is.nan(Armavir_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Armavir_long_passes_metrics=cbind(Armavir_players,Armavir_long_passes_closeness, Armavir_long_passes_betw,  Armavir_long_passes_pagerank, Armavir_long_passes_transitivity)
colnames(Armavir_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Armavir_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Armavir/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Armavir_players = Armavir_final_3rd_passes$X
Armavir_final_3rd_passes$X = NULL
rownames(Armavir_final_3rd_passes) = Armavir_players
Armavir_final_3rd_passes_matrix <- as.matrix(Armavir_final_3rd_passes)
Armavir_final_3rd_passes_graph = graph_from_adjacency_matrix(Armavir_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Armavir_final_3rd_passes_closeness= centr_clo(Armavir_final_3rd_passes_graph, mode='total', normalized = TRUE)
Armavir_final_3rd_passes_betw = centralization.betweenness(Armavir_final_3rd_passes_graph, normalized =TRUE)
Armavir_final_3rd_passes_pagerank= page_rank(Armavir_final_3rd_passes_graph, algo ="power", vids = V(Armavir_final_3rd_passes_graph), directed = TRUE, weights = E(Armavir_final_3rd_passes_graph)$weight)
Armavir_final_3rd_passes_closeness = Armavir_final_3rd_passes_closeness[['res']]
Armavir_final_3rd_passes_betw = Armavir_final_3rd_passes_betw[['res']]
Armavir_final_3rd_passes_pagerank = Armavir_final_3rd_passes_pagerank[["vector"]]
Armavir_final_3rd_passes_transitivity = transitivity(Armavir_final_3rd_passes_graph,  type="weighted")
Armavir_final_3rd_passes_closeness[is.nan(Armavir_final_3rd_passes_closeness)] = 0
Armavir_final_3rd_passes_betw[is.nan(Armavir_final_3rd_passes_betw)] = 0
Armavir_final_3rd_passes_pagerank[is.nan(Armavir_final_3rd_passes_pagerank)] = 0
Armavir_final_3rd_passes_transitivity[is.nan(Armavir_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Armavir_final_3rd_passes_metrics=cbind(Armavir_players,Armavir_final_3rd_passes_closeness, Armavir_final_3rd_passes_betw,  Armavir_final_3rd_passes_pagerank, Armavir_final_3rd_passes_transitivity)
colnames(Armavir_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Armavir_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Armavir/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Armavir_players = Armavir_progressive_passes$X
Armavir_progressive_passes$X = NULL
rownames(Armavir_progressive_passes) = Armavir_players
Armavir_progressive_passes_matrix <- as.matrix(Armavir_progressive_passes)
Armavir_progressive_passes_graph = graph_from_adjacency_matrix(Armavir_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Armavir_progressive_passes_closeness= centr_clo(Armavir_progressive_passes_graph, mode='total', normalized = TRUE)
Armavir_progressive_passes_betw = centralization.betweenness(Armavir_progressive_passes_graph, normalized =TRUE)
Armavir_progressive_passes_pagerank= page_rank(Armavir_progressive_passes_graph, algo ="power", vids = V(Armavir_progressive_passes_graph), directed = TRUE, weights = E(Armavir_progressive_passes_graph)$weight)
Armavir_progressive_passes_closeness = Armavir_progressive_passes_closeness[['res']]
Armavir_progressive_passes_betw = Armavir_progressive_passes_betw[['res']]
Armavir_progressive_passes_pagerank = Armavir_progressive_passes_pagerank[["vector"]]
Armavir_progressive_passes_transitivity = transitivity(Armavir_progressive_passes_graph,  type="weighted")
Armavir_progressive_passes_closeness[is.nan(Armavir_progressive_passes_closeness)] = 0
Armavir_progressive_passes_betw[is.nan(Armavir_progressive_passes_betw)] = 0
Armavir_progressive_passes_pagerank[is.nan(Armavir_progressive_passes_pagerank)] = 0
Armavir_progressive_passes_transitivity[is.nan(Armavir_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Armavir_progressive_passes_metrics=cbind(Armavir_players,Armavir_progressive_passes_closeness, Armavir_progressive_passes_betw,  Armavir_progressive_passes_pagerank, Armavir_progressive_passes_transitivity)
colnames(Armavir_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Armavir_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Armavir_total_passes_metrics, 
Armavir_forward_passes_metrics,
Armavir_back_passes_metrics,
Armavir_long_passes_metrics,
Armavir_final_3rd_passes_metrics,
Armavir_progressive_passes_metrics))



#norm_data
rownames(Armavir_all_passing_stats) = Armavir_players
Armavir_all_passing_stats$Player = NULL
Armavir_all_passing_stats = unfactor(Armavir_all_passing_stats)
Armavir_all_passing_stats_norm =  data.frame(lapply(Armavir_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Armavir_all_passing_stats_norm) = Armavir_players
colnames(Armavir_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Armavir_all_passing_stats, 'Armavir_passing.csv')


Avangard_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Avangard/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Avangard_players = Avangard_total_passes$X
Avangard_total_passes$X = NULL
rownames(Avangard_total_passes) = Avangard_players
Avangard_total_passes_matrix <- as.matrix(Avangard_total_passes)
Avangard_total_passes_graph = graph_from_adjacency_matrix(Avangard_total_passes_matrix, mode = "directed", weighted = TRUE)
Avangard_total_passes_closeness= centr_clo(Avangard_total_passes_graph, mode='total', normalized = TRUE)
Avangard_total_passes_betw = centralization.betweenness(Avangard_total_passes_graph, normalized =TRUE)
Avangard_total_passes_pagerank= page_rank(Avangard_total_passes_graph, algo ="power", vids = V(Avangard_total_passes_graph), directed = TRUE, weights = E(Avangard_total_passes_graph)$weight)
Avangard_total_passes_closeness = Avangard_total_passes_closeness[['res']]
Avangard_total_passes_betw = Avangard_total_passes_betw[['res']]
Avangard_total_passes_pagerank = Avangard_total_passes_pagerank[["vector"]]
Avangard_total_passes_transitivity = transitivity(Avangard_total_passes_graph,  type="weighted")
Avangard_total_passes_closeness[is.nan(Avangard_total_passes_closeness)] = 0
Avangard_total_passes_betw[is.nan(Avangard_total_passes_betw)] = 0
Avangard_total_passes_pagerank[is.nan(Avangard_total_passes_pagerank)] = 0
Avangard_total_passes_transitivity[is.nan(Avangard_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Avangard_total_passes_metrics=cbind(Avangard_players,Avangard_total_passes_closeness, Avangard_total_passes_betw,  Avangard_total_passes_pagerank, Avangard_total_passes_transitivity)
colnames(Avangard_total_passes_metrics)[1] = 'Player' 

#forward_passes
Avangard_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Avangard/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Avangard_players = Avangard_forward_passes$X
Avangard_forward_passes$X = NULL
rownames(Avangard_forward_passes) = Avangard_players
Avangard_forward_passes_matrix <- as.matrix(Avangard_forward_passes)
Avangard_forward_passes_graph = graph_from_adjacency_matrix(Avangard_forward_passes_matrix, mode = "directed", weighted = TRUE)
Avangard_forward_passes_closeness= centr_clo(Avangard_forward_passes_graph, mode='total', normalized = TRUE)
Avangard_forward_passes_betw = centralization.betweenness(Avangard_forward_passes_graph, normalized =TRUE)
Avangard_forward_passes_pagerank= page_rank(Avangard_forward_passes_graph, algo ="power", vids = V(Avangard_forward_passes_graph), directed = TRUE, weights = E(Avangard_forward_passes_graph)$weight)
Avangard_forward_passes_closeness = Avangard_forward_passes_closeness[['res']]
Avangard_forward_passes_betw = Avangard_forward_passes_betw[['res']]
Avangard_forward_passes_pagerank = Avangard_forward_passes_pagerank[["vector"]]
Avangard_forward_passes_transitivity = transitivity(Avangard_forward_passes_graph,  type="weighted")
Avangard_forward_passes_closeness[is.nan(Avangard_forward_passes_closeness)] = 0
Avangard_forward_passes_betw[is.nan(Avangard_forward_passes_betw)] = 0
Avangard_forward_passes_pagerank[is.nan(Avangard_forward_passes_pagerank)] = 0
Avangard_forward_passes_transitivity[is.nan(Avangard_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Avangard_forward_passes_metrics=cbind(Avangard_players,Avangard_forward_passes_closeness, Avangard_forward_passes_betw,  Avangard_forward_passes_pagerank, Avangard_forward_passes_transitivity)
colnames(Avangard_forward_passes_metrics)[1] = 'Player' 


#back_passes
Avangard_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Avangard/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Avangard_players = Avangard_back_passes$X
Avangard_back_passes$X = NULL
rownames(Avangard_back_passes) = Avangard_players
Avangard_back_passes_matrix <- as.matrix(Avangard_back_passes)
Avangard_back_passes_graph = graph_from_adjacency_matrix(Avangard_back_passes_matrix, mode = "directed", weighted = TRUE)
Avangard_back_passes_closeness= centr_clo(Avangard_back_passes_graph, mode='total', normalized = TRUE)
Avangard_back_passes_betw = centralization.betweenness(Avangard_back_passes_graph, normalized =TRUE)
Avangard_back_passes_pagerank= page_rank(Avangard_back_passes_graph, algo ="power", vids = V(Avangard_back_passes_graph), directed = TRUE, weights = E(Avangard_back_passes_graph)$weight)
Avangard_back_passes_closeness = Avangard_back_passes_closeness[['res']]
Avangard_back_passes_betw = Avangard_back_passes_betw[['res']]
Avangard_back_passes_pagerank = Avangard_back_passes_pagerank[["vector"]]
Avangard_back_passes_transitivity = transitivity(Avangard_back_passes_graph,  type="weighted")
Avangard_back_passes_closeness[is.nan(Avangard_back_passes_closeness)] = 0
Avangard_back_passes_betw[is.nan(Avangard_back_passes_betw)] = 0
Avangard_back_passes_pagerank[is.nan(Avangard_back_passes_pagerank)] = 0
Avangard_back_passes_transitivity[is.nan(Avangard_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Avangard_back_passes_metrics=cbind(Avangard_players,Avangard_back_passes_closeness, Avangard_back_passes_betw,  Avangard_back_passes_pagerank, Avangard_back_passes_transitivity)
colnames(Avangard_back_passes_metrics)[1] = 'Player'  


#long_passes
Avangard_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Avangard/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Avangard_players = Avangard_long_passes$X
Avangard_long_passes$X = NULL
rownames(Avangard_long_passes) = Avangard_players
Avangard_long_passes_matrix <- as.matrix(Avangard_long_passes)
Avangard_long_passes_graph = graph_from_adjacency_matrix(Avangard_long_passes_matrix, mode = "directed", weighted = TRUE)
Avangard_long_passes_closeness= centr_clo(Avangard_long_passes_graph, mode='total', normalized = TRUE)
Avangard_long_passes_betw = centralization.betweenness(Avangard_long_passes_graph, normalized =TRUE)
Avangard_long_passes_pagerank= page_rank(Avangard_long_passes_graph, algo ="power", vids = V(Avangard_long_passes_graph), directed = TRUE, weights = E(Avangard_long_passes_graph)$weight)
Avangard_long_passes_closeness = Avangard_long_passes_closeness[['res']]
Avangard_long_passes_betw = Avangard_long_passes_betw[['res']]
Avangard_long_passes_pagerank = Avangard_long_passes_pagerank[["vector"]]
Avangard_long_passes_transitivity = transitivity(Avangard_long_passes_graph,  type="weighted")
Avangard_long_passes_closeness[is.nan(Avangard_long_passes_closeness)] = 0
Avangard_long_passes_betw[is.nan(Avangard_long_passes_betw)] = 0
Avangard_long_passes_pagerank[is.nan(Avangard_long_passes_pagerank)] = 0
Avangard_long_passes_transitivity[is.nan(Avangard_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Avangard_long_passes_metrics=cbind(Avangard_players,Avangard_long_passes_closeness, Avangard_long_passes_betw,  Avangard_long_passes_pagerank, Avangard_long_passes_transitivity)
colnames(Avangard_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Avangard_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Avangard/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Avangard_players = Avangard_final_3rd_passes$X
Avangard_final_3rd_passes$X = NULL
rownames(Avangard_final_3rd_passes) = Avangard_players
Avangard_final_3rd_passes_matrix <- as.matrix(Avangard_final_3rd_passes)
Avangard_final_3rd_passes_graph = graph_from_adjacency_matrix(Avangard_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Avangard_final_3rd_passes_closeness= centr_clo(Avangard_final_3rd_passes_graph, mode='total', normalized = TRUE)
Avangard_final_3rd_passes_betw = centralization.betweenness(Avangard_final_3rd_passes_graph, normalized =TRUE)
Avangard_final_3rd_passes_pagerank= page_rank(Avangard_final_3rd_passes_graph, algo ="power", vids = V(Avangard_final_3rd_passes_graph), directed = TRUE, weights = E(Avangard_final_3rd_passes_graph)$weight)
Avangard_final_3rd_passes_closeness = Avangard_final_3rd_passes_closeness[['res']]
Avangard_final_3rd_passes_betw = Avangard_final_3rd_passes_betw[['res']]
Avangard_final_3rd_passes_pagerank = Avangard_final_3rd_passes_pagerank[["vector"]]
Avangard_final_3rd_passes_transitivity = transitivity(Avangard_final_3rd_passes_graph,  type="weighted")
Avangard_final_3rd_passes_closeness[is.nan(Avangard_final_3rd_passes_closeness)] = 0
Avangard_final_3rd_passes_betw[is.nan(Avangard_final_3rd_passes_betw)] = 0
Avangard_final_3rd_passes_pagerank[is.nan(Avangard_final_3rd_passes_pagerank)] = 0
Avangard_final_3rd_passes_transitivity[is.nan(Avangard_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Avangard_final_3rd_passes_metrics=cbind(Avangard_players,Avangard_final_3rd_passes_closeness, Avangard_final_3rd_passes_betw,  Avangard_final_3rd_passes_pagerank, Avangard_final_3rd_passes_transitivity)
colnames(Avangard_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Avangard_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Avangard/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Avangard_players = Avangard_progressive_passes$X
Avangard_progressive_passes$X = NULL
rownames(Avangard_progressive_passes) = Avangard_players
Avangard_progressive_passes_matrix <- as.matrix(Avangard_progressive_passes)
Avangard_progressive_passes_graph = graph_from_adjacency_matrix(Avangard_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Avangard_progressive_passes_closeness= centr_clo(Avangard_progressive_passes_graph, mode='total', normalized = TRUE)
Avangard_progressive_passes_betw = centralization.betweenness(Avangard_progressive_passes_graph, normalized =TRUE)
Avangard_progressive_passes_pagerank= page_rank(Avangard_progressive_passes_graph, algo ="power", vids = V(Avangard_progressive_passes_graph), directed = TRUE, weights = E(Avangard_progressive_passes_graph)$weight)
Avangard_progressive_passes_closeness = Avangard_progressive_passes_closeness[['res']]
Avangard_progressive_passes_betw = Avangard_progressive_passes_betw[['res']]
Avangard_progressive_passes_pagerank = Avangard_progressive_passes_pagerank[["vector"]]
Avangard_progressive_passes_transitivity = transitivity(Avangard_progressive_passes_graph,  type="weighted")
Avangard_progressive_passes_closeness[is.nan(Avangard_progressive_passes_closeness)] = 0
Avangard_progressive_passes_betw[is.nan(Avangard_progressive_passes_betw)] = 0
Avangard_progressive_passes_pagerank[is.nan(Avangard_progressive_passes_pagerank)] = 0
Avangard_progressive_passes_transitivity[is.nan(Avangard_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Avangard_progressive_passes_metrics=cbind(Avangard_players,Avangard_progressive_passes_closeness, Avangard_progressive_passes_betw,  Avangard_progressive_passes_pagerank, Avangard_progressive_passes_transitivity)
colnames(Avangard_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Avangard_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Avangard_total_passes_metrics, 
Avangard_forward_passes_metrics,
Avangard_back_passes_metrics,
Avangard_long_passes_metrics,
Avangard_final_3rd_passes_metrics,
Avangard_progressive_passes_metrics))



#norm_data
rownames(Avangard_all_passing_stats) = Avangard_players
Avangard_all_passing_stats$Player = NULL
Avangard_all_passing_stats = unfactor(Avangard_all_passing_stats)
Avangard_all_passing_stats_norm =  data.frame(lapply(Avangard_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Avangard_all_passing_stats_norm) = Avangard_players
colnames(Avangard_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Avangard_all_passing_stats, 'Avangard_passing.csv')


Baltika_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Baltika/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Baltika_players = Baltika_total_passes$X
Baltika_total_passes$X = NULL
rownames(Baltika_total_passes) = Baltika_players
Baltika_total_passes_matrix <- as.matrix(Baltika_total_passes)
Baltika_total_passes_graph = graph_from_adjacency_matrix(Baltika_total_passes_matrix, mode = "directed", weighted = TRUE)
Baltika_total_passes_closeness= centr_clo(Baltika_total_passes_graph, mode='total', normalized = TRUE)
Baltika_total_passes_betw = centralization.betweenness(Baltika_total_passes_graph, normalized =TRUE)
Baltika_total_passes_pagerank= page_rank(Baltika_total_passes_graph, algo ="power", vids = V(Baltika_total_passes_graph), directed = TRUE, weights = E(Baltika_total_passes_graph)$weight)
Baltika_total_passes_closeness = Baltika_total_passes_closeness[['res']]
Baltika_total_passes_betw = Baltika_total_passes_betw[['res']]
Baltika_total_passes_pagerank = Baltika_total_passes_pagerank[["vector"]]
Baltika_total_passes_transitivity = transitivity(Baltika_total_passes_graph,  type="weighted")
Baltika_total_passes_closeness[is.nan(Baltika_total_passes_closeness)] = 0
Baltika_total_passes_betw[is.nan(Baltika_total_passes_betw)] = 0
Baltika_total_passes_pagerank[is.nan(Baltika_total_passes_pagerank)] = 0
Baltika_total_passes_transitivity[is.nan(Baltika_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Baltika_total_passes_metrics=cbind(Baltika_players,Baltika_total_passes_closeness, Baltika_total_passes_betw,  Baltika_total_passes_pagerank, Baltika_total_passes_transitivity)
colnames(Baltika_total_passes_metrics)[1] = 'Player' 

#forward_passes
Baltika_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Baltika/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Baltika_players = Baltika_forward_passes$X
Baltika_forward_passes$X = NULL
rownames(Baltika_forward_passes) = Baltika_players
Baltika_forward_passes_matrix <- as.matrix(Baltika_forward_passes)
Baltika_forward_passes_graph = graph_from_adjacency_matrix(Baltika_forward_passes_matrix, mode = "directed", weighted = TRUE)
Baltika_forward_passes_closeness= centr_clo(Baltika_forward_passes_graph, mode='total', normalized = TRUE)
Baltika_forward_passes_betw = centralization.betweenness(Baltika_forward_passes_graph, normalized =TRUE)
Baltika_forward_passes_pagerank= page_rank(Baltika_forward_passes_graph, algo ="power", vids = V(Baltika_forward_passes_graph), directed = TRUE, weights = E(Baltika_forward_passes_graph)$weight)
Baltika_forward_passes_closeness = Baltika_forward_passes_closeness[['res']]
Baltika_forward_passes_betw = Baltika_forward_passes_betw[['res']]
Baltika_forward_passes_pagerank = Baltika_forward_passes_pagerank[["vector"]]
Baltika_forward_passes_transitivity = transitivity(Baltika_forward_passes_graph,  type="weighted")
Baltika_forward_passes_closeness[is.nan(Baltika_forward_passes_closeness)] = 0
Baltika_forward_passes_betw[is.nan(Baltika_forward_passes_betw)] = 0
Baltika_forward_passes_pagerank[is.nan(Baltika_forward_passes_pagerank)] = 0
Baltika_forward_passes_transitivity[is.nan(Baltika_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Baltika_forward_passes_metrics=cbind(Baltika_players,Baltika_forward_passes_closeness, Baltika_forward_passes_betw,  Baltika_forward_passes_pagerank, Baltika_forward_passes_transitivity)
colnames(Baltika_forward_passes_metrics)[1] = 'Player' 


#back_passes
Baltika_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Baltika/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Baltika_players = Baltika_back_passes$X
Baltika_back_passes$X = NULL
rownames(Baltika_back_passes) = Baltika_players
Baltika_back_passes_matrix <- as.matrix(Baltika_back_passes)
Baltika_back_passes_graph = graph_from_adjacency_matrix(Baltika_back_passes_matrix, mode = "directed", weighted = TRUE)
Baltika_back_passes_closeness= centr_clo(Baltika_back_passes_graph, mode='total', normalized = TRUE)
Baltika_back_passes_betw = centralization.betweenness(Baltika_back_passes_graph, normalized =TRUE)
Baltika_back_passes_pagerank= page_rank(Baltika_back_passes_graph, algo ="power", vids = V(Baltika_back_passes_graph), directed = TRUE, weights = E(Baltika_back_passes_graph)$weight)
Baltika_back_passes_closeness = Baltika_back_passes_closeness[['res']]
Baltika_back_passes_betw = Baltika_back_passes_betw[['res']]
Baltika_back_passes_pagerank = Baltika_back_passes_pagerank[["vector"]]
Baltika_back_passes_transitivity = transitivity(Baltika_back_passes_graph,  type="weighted")
Baltika_back_passes_closeness[is.nan(Baltika_back_passes_closeness)] = 0
Baltika_back_passes_betw[is.nan(Baltika_back_passes_betw)] = 0
Baltika_back_passes_pagerank[is.nan(Baltika_back_passes_pagerank)] = 0
Baltika_back_passes_transitivity[is.nan(Baltika_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Baltika_back_passes_metrics=cbind(Baltika_players,Baltika_back_passes_closeness, Baltika_back_passes_betw,  Baltika_back_passes_pagerank, Baltika_back_passes_transitivity)
colnames(Baltika_back_passes_metrics)[1] = 'Player'  


#long_passes
Baltika_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Baltika/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Baltika_players = Baltika_long_passes$X
Baltika_long_passes$X = NULL
rownames(Baltika_long_passes) = Baltika_players
Baltika_long_passes_matrix <- as.matrix(Baltika_long_passes)
Baltika_long_passes_graph = graph_from_adjacency_matrix(Baltika_long_passes_matrix, mode = "directed", weighted = TRUE)
Baltika_long_passes_closeness= centr_clo(Baltika_long_passes_graph, mode='total', normalized = TRUE)
Baltika_long_passes_betw = centralization.betweenness(Baltika_long_passes_graph, normalized =TRUE)
Baltika_long_passes_pagerank= page_rank(Baltika_long_passes_graph, algo ="power", vids = V(Baltika_long_passes_graph), directed = TRUE, weights = E(Baltika_long_passes_graph)$weight)
Baltika_long_passes_closeness = Baltika_long_passes_closeness[['res']]
Baltika_long_passes_betw = Baltika_long_passes_betw[['res']]
Baltika_long_passes_pagerank = Baltika_long_passes_pagerank[["vector"]]
Baltika_long_passes_transitivity = transitivity(Baltika_long_passes_graph,  type="weighted")
Baltika_long_passes_closeness[is.nan(Baltika_long_passes_closeness)] = 0
Baltika_long_passes_betw[is.nan(Baltika_long_passes_betw)] = 0
Baltika_long_passes_pagerank[is.nan(Baltika_long_passes_pagerank)] = 0
Baltika_long_passes_transitivity[is.nan(Baltika_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Baltika_long_passes_metrics=cbind(Baltika_players,Baltika_long_passes_closeness, Baltika_long_passes_betw,  Baltika_long_passes_pagerank, Baltika_long_passes_transitivity)
colnames(Baltika_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Baltika_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Baltika/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Baltika_players = Baltika_final_3rd_passes$X
Baltika_final_3rd_passes$X = NULL
rownames(Baltika_final_3rd_passes) = Baltika_players
Baltika_final_3rd_passes_matrix <- as.matrix(Baltika_final_3rd_passes)
Baltika_final_3rd_passes_graph = graph_from_adjacency_matrix(Baltika_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Baltika_final_3rd_passes_closeness= centr_clo(Baltika_final_3rd_passes_graph, mode='total', normalized = TRUE)
Baltika_final_3rd_passes_betw = centralization.betweenness(Baltika_final_3rd_passes_graph, normalized =TRUE)
Baltika_final_3rd_passes_pagerank= page_rank(Baltika_final_3rd_passes_graph, algo ="power", vids = V(Baltika_final_3rd_passes_graph), directed = TRUE, weights = E(Baltika_final_3rd_passes_graph)$weight)
Baltika_final_3rd_passes_closeness = Baltika_final_3rd_passes_closeness[['res']]
Baltika_final_3rd_passes_betw = Baltika_final_3rd_passes_betw[['res']]
Baltika_final_3rd_passes_pagerank = Baltika_final_3rd_passes_pagerank[["vector"]]
Baltika_final_3rd_passes_transitivity = transitivity(Baltika_final_3rd_passes_graph,  type="weighted")
Baltika_final_3rd_passes_closeness[is.nan(Baltika_final_3rd_passes_closeness)] = 0
Baltika_final_3rd_passes_betw[is.nan(Baltika_final_3rd_passes_betw)] = 0
Baltika_final_3rd_passes_pagerank[is.nan(Baltika_final_3rd_passes_pagerank)] = 0
Baltika_final_3rd_passes_transitivity[is.nan(Baltika_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Baltika_final_3rd_passes_metrics=cbind(Baltika_players,Baltika_final_3rd_passes_closeness, Baltika_final_3rd_passes_betw,  Baltika_final_3rd_passes_pagerank, Baltika_final_3rd_passes_transitivity)
colnames(Baltika_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Baltika_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Baltika/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Baltika_players = Baltika_progressive_passes$X
Baltika_progressive_passes$X = NULL
rownames(Baltika_progressive_passes) = Baltika_players
Baltika_progressive_passes_matrix <- as.matrix(Baltika_progressive_passes)
Baltika_progressive_passes_graph = graph_from_adjacency_matrix(Baltika_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Baltika_progressive_passes_closeness= centr_clo(Baltika_progressive_passes_graph, mode='total', normalized = TRUE)
Baltika_progressive_passes_betw = centralization.betweenness(Baltika_progressive_passes_graph, normalized =TRUE)
Baltika_progressive_passes_pagerank= page_rank(Baltika_progressive_passes_graph, algo ="power", vids = V(Baltika_progressive_passes_graph), directed = TRUE, weights = E(Baltika_progressive_passes_graph)$weight)
Baltika_progressive_passes_closeness = Baltika_progressive_passes_closeness[['res']]
Baltika_progressive_passes_betw = Baltika_progressive_passes_betw[['res']]
Baltika_progressive_passes_pagerank = Baltika_progressive_passes_pagerank[["vector"]]
Baltika_progressive_passes_transitivity = transitivity(Baltika_progressive_passes_graph,  type="weighted")
Baltika_progressive_passes_closeness[is.nan(Baltika_progressive_passes_closeness)] = 0
Baltika_progressive_passes_betw[is.nan(Baltika_progressive_passes_betw)] = 0
Baltika_progressive_passes_pagerank[is.nan(Baltika_progressive_passes_pagerank)] = 0
Baltika_progressive_passes_transitivity[is.nan(Baltika_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Baltika_progressive_passes_metrics=cbind(Baltika_players,Baltika_progressive_passes_closeness, Baltika_progressive_passes_betw,  Baltika_progressive_passes_pagerank, Baltika_progressive_passes_transitivity)
colnames(Baltika_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Baltika_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Baltika_total_passes_metrics, 
Baltika_forward_passes_metrics,
Baltika_back_passes_metrics,
Baltika_long_passes_metrics,
Baltika_final_3rd_passes_metrics,
Baltika_progressive_passes_metrics))



#norm_data
rownames(Baltika_all_passing_stats) = Baltika_players
Baltika_all_passing_stats$Player = NULL
Baltika_all_passing_stats = unfactor(Baltika_all_passing_stats)
Baltika_all_passing_stats_norm =  data.frame(lapply(Baltika_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Baltika_all_passing_stats_norm) = Baltika_players
colnames(Baltika_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Baltika_all_passing_stats, 'Baltika_passing.csv')



Chayka_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Chayka/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Chayka_players = Chayka_total_passes$X
Chayka_total_passes$X = NULL
rownames(Chayka_total_passes) = Chayka_players
Chayka_total_passes_matrix <- as.matrix(Chayka_total_passes)
Chayka_total_passes_graph = graph_from_adjacency_matrix(Chayka_total_passes_matrix, mode = "directed", weighted = TRUE)
Chayka_total_passes_closeness= centr_clo(Chayka_total_passes_graph, mode='total', normalized = TRUE)
Chayka_total_passes_betw = centralization.betweenness(Chayka_total_passes_graph, normalized =TRUE)
Chayka_total_passes_pagerank= page_rank(Chayka_total_passes_graph, algo ="power", vids = V(Chayka_total_passes_graph), directed = TRUE, weights = E(Chayka_total_passes_graph)$weight)
Chayka_total_passes_closeness = Chayka_total_passes_closeness[['res']]
Chayka_total_passes_betw = Chayka_total_passes_betw[['res']]
Chayka_total_passes_pagerank = Chayka_total_passes_pagerank[["vector"]]
Chayka_total_passes_transitivity = transitivity(Chayka_total_passes_graph,  type="weighted")
Chayka_total_passes_closeness[is.nan(Chayka_total_passes_closeness)] = 0
Chayka_total_passes_betw[is.nan(Chayka_total_passes_betw)] = 0
Chayka_total_passes_pagerank[is.nan(Chayka_total_passes_pagerank)] = 0
Chayka_total_passes_transitivity[is.nan(Chayka_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Chayka_total_passes_metrics=cbind(Chayka_players,Chayka_total_passes_closeness, Chayka_total_passes_betw,  Chayka_total_passes_pagerank, Chayka_total_passes_transitivity)
colnames(Chayka_total_passes_metrics)[1] = 'Player' 

#forward_passes
Chayka_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Chayka/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Chayka_players = Chayka_forward_passes$X
Chayka_forward_passes$X = NULL
rownames(Chayka_forward_passes) = Chayka_players
Chayka_forward_passes_matrix <- as.matrix(Chayka_forward_passes)
Chayka_forward_passes_graph = graph_from_adjacency_matrix(Chayka_forward_passes_matrix, mode = "directed", weighted = TRUE)
Chayka_forward_passes_closeness= centr_clo(Chayka_forward_passes_graph, mode='total', normalized = TRUE)
Chayka_forward_passes_betw = centralization.betweenness(Chayka_forward_passes_graph, normalized =TRUE)
Chayka_forward_passes_pagerank= page_rank(Chayka_forward_passes_graph, algo ="power", vids = V(Chayka_forward_passes_graph), directed = TRUE, weights = E(Chayka_forward_passes_graph)$weight)
Chayka_forward_passes_closeness = Chayka_forward_passes_closeness[['res']]
Chayka_forward_passes_betw = Chayka_forward_passes_betw[['res']]
Chayka_forward_passes_pagerank = Chayka_forward_passes_pagerank[["vector"]]
Chayka_forward_passes_transitivity = transitivity(Chayka_forward_passes_graph,  type="weighted")
Chayka_forward_passes_closeness[is.nan(Chayka_forward_passes_closeness)] = 0
Chayka_forward_passes_betw[is.nan(Chayka_forward_passes_betw)] = 0
Chayka_forward_passes_pagerank[is.nan(Chayka_forward_passes_pagerank)] = 0
Chayka_forward_passes_transitivity[is.nan(Chayka_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Chayka_forward_passes_metrics=cbind(Chayka_players,Chayka_forward_passes_closeness, Chayka_forward_passes_betw,  Chayka_forward_passes_pagerank, Chayka_forward_passes_transitivity)
colnames(Chayka_forward_passes_metrics)[1] = 'Player' 


#back_passes
Chayka_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Chayka/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Chayka_players = Chayka_back_passes$X
Chayka_back_passes$X = NULL
rownames(Chayka_back_passes) = Chayka_players
Chayka_back_passes_matrix <- as.matrix(Chayka_back_passes)
Chayka_back_passes_graph = graph_from_adjacency_matrix(Chayka_back_passes_matrix, mode = "directed", weighted = TRUE)
Chayka_back_passes_closeness= centr_clo(Chayka_back_passes_graph, mode='total', normalized = TRUE)
Chayka_back_passes_betw = centralization.betweenness(Chayka_back_passes_graph, normalized =TRUE)
Chayka_back_passes_pagerank= page_rank(Chayka_back_passes_graph, algo ="power", vids = V(Chayka_back_passes_graph), directed = TRUE, weights = E(Chayka_back_passes_graph)$weight)
Chayka_back_passes_closeness = Chayka_back_passes_closeness[['res']]
Chayka_back_passes_betw = Chayka_back_passes_betw[['res']]
Chayka_back_passes_pagerank = Chayka_back_passes_pagerank[["vector"]]
Chayka_back_passes_transitivity = transitivity(Chayka_back_passes_graph,  type="weighted")
Chayka_back_passes_closeness[is.nan(Chayka_back_passes_closeness)] = 0
Chayka_back_passes_betw[is.nan(Chayka_back_passes_betw)] = 0
Chayka_back_passes_pagerank[is.nan(Chayka_back_passes_pagerank)] = 0
Chayka_back_passes_transitivity[is.nan(Chayka_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Chayka_back_passes_metrics=cbind(Chayka_players,Chayka_back_passes_closeness, Chayka_back_passes_betw,  Chayka_back_passes_pagerank, Chayka_back_passes_transitivity)
colnames(Chayka_back_passes_metrics)[1] = 'Player'  


#long_passes
Chayka_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Chayka/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Chayka_players = Chayka_long_passes$X
Chayka_long_passes$X = NULL
rownames(Chayka_long_passes) = Chayka_players
Chayka_long_passes_matrix <- as.matrix(Chayka_long_passes)
Chayka_long_passes_graph = graph_from_adjacency_matrix(Chayka_long_passes_matrix, mode = "directed", weighted = TRUE)
Chayka_long_passes_closeness= centr_clo(Chayka_long_passes_graph, mode='total', normalized = TRUE)
Chayka_long_passes_betw = centralization.betweenness(Chayka_long_passes_graph, normalized =TRUE)
Chayka_long_passes_pagerank= page_rank(Chayka_long_passes_graph, algo ="power", vids = V(Chayka_long_passes_graph), directed = TRUE, weights = E(Chayka_long_passes_graph)$weight)
Chayka_long_passes_closeness = Chayka_long_passes_closeness[['res']]
Chayka_long_passes_betw = Chayka_long_passes_betw[['res']]
Chayka_long_passes_pagerank = Chayka_long_passes_pagerank[["vector"]]
Chayka_long_passes_transitivity = transitivity(Chayka_long_passes_graph,  type="weighted")
Chayka_long_passes_closeness[is.nan(Chayka_long_passes_closeness)] = 0
Chayka_long_passes_betw[is.nan(Chayka_long_passes_betw)] = 0
Chayka_long_passes_pagerank[is.nan(Chayka_long_passes_pagerank)] = 0
Chayka_long_passes_transitivity[is.nan(Chayka_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Chayka_long_passes_metrics=cbind(Chayka_players,Chayka_long_passes_closeness, Chayka_long_passes_betw,  Chayka_long_passes_pagerank, Chayka_long_passes_transitivity)
colnames(Chayka_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Chayka_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Chayka/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Chayka_players = Chayka_final_3rd_passes$X
Chayka_final_3rd_passes$X = NULL
rownames(Chayka_final_3rd_passes) = Chayka_players
Chayka_final_3rd_passes_matrix <- as.matrix(Chayka_final_3rd_passes)
Chayka_final_3rd_passes_graph = graph_from_adjacency_matrix(Chayka_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Chayka_final_3rd_passes_closeness= centr_clo(Chayka_final_3rd_passes_graph, mode='total', normalized = TRUE)
Chayka_final_3rd_passes_betw = centralization.betweenness(Chayka_final_3rd_passes_graph, normalized =TRUE)
Chayka_final_3rd_passes_pagerank= page_rank(Chayka_final_3rd_passes_graph, algo ="power", vids = V(Chayka_final_3rd_passes_graph), directed = TRUE, weights = E(Chayka_final_3rd_passes_graph)$weight)
Chayka_final_3rd_passes_closeness = Chayka_final_3rd_passes_closeness[['res']]
Chayka_final_3rd_passes_betw = Chayka_final_3rd_passes_betw[['res']]
Chayka_final_3rd_passes_pagerank = Chayka_final_3rd_passes_pagerank[["vector"]]
Chayka_final_3rd_passes_transitivity = transitivity(Chayka_final_3rd_passes_graph,  type="weighted")
Chayka_final_3rd_passes_closeness[is.nan(Chayka_final_3rd_passes_closeness)] = 0
Chayka_final_3rd_passes_betw[is.nan(Chayka_final_3rd_passes_betw)] = 0
Chayka_final_3rd_passes_pagerank[is.nan(Chayka_final_3rd_passes_pagerank)] = 0
Chayka_final_3rd_passes_transitivity[is.nan(Chayka_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Chayka_final_3rd_passes_metrics=cbind(Chayka_players,Chayka_final_3rd_passes_closeness, Chayka_final_3rd_passes_betw,  Chayka_final_3rd_passes_pagerank, Chayka_final_3rd_passes_transitivity)
colnames(Chayka_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Chayka_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Chayka/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Chayka_players = Chayka_progressive_passes$X
Chayka_progressive_passes$X = NULL
rownames(Chayka_progressive_passes) = Chayka_players
Chayka_progressive_passes_matrix <- as.matrix(Chayka_progressive_passes)
Chayka_progressive_passes_graph = graph_from_adjacency_matrix(Chayka_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Chayka_progressive_passes_closeness= centr_clo(Chayka_progressive_passes_graph, mode='total', normalized = TRUE)
Chayka_progressive_passes_betw = centralization.betweenness(Chayka_progressive_passes_graph, normalized =TRUE)
Chayka_progressive_passes_pagerank= page_rank(Chayka_progressive_passes_graph, algo ="power", vids = V(Chayka_progressive_passes_graph), directed = TRUE, weights = E(Chayka_progressive_passes_graph)$weight)
Chayka_progressive_passes_closeness = Chayka_progressive_passes_closeness[['res']]
Chayka_progressive_passes_betw = Chayka_progressive_passes_betw[['res']]
Chayka_progressive_passes_pagerank = Chayka_progressive_passes_pagerank[["vector"]]
Chayka_progressive_passes_transitivity = transitivity(Chayka_progressive_passes_graph,  type="weighted")
Chayka_progressive_passes_closeness[is.nan(Chayka_progressive_passes_closeness)] = 0
Chayka_progressive_passes_betw[is.nan(Chayka_progressive_passes_betw)] = 0
Chayka_progressive_passes_pagerank[is.nan(Chayka_progressive_passes_pagerank)] = 0
Chayka_progressive_passes_transitivity[is.nan(Chayka_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Chayka_progressive_passes_metrics=cbind(Chayka_players,Chayka_progressive_passes_closeness, Chayka_progressive_passes_betw,  Chayka_progressive_passes_pagerank, Chayka_progressive_passes_transitivity)
colnames(Chayka_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Chayka_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Chayka_total_passes_metrics, 
Chayka_forward_passes_metrics,
Chayka_back_passes_metrics,
Chayka_long_passes_metrics,
Chayka_final_3rd_passes_metrics,
Chayka_progressive_passes_metrics))



#norm_data
rownames(Chayka_all_passing_stats) = Chayka_players
Chayka_all_passing_stats$Player = NULL
Chayka_all_passing_stats = unfactor(Chayka_all_passing_stats)
Chayka_all_passing_stats_norm =  data.frame(lapply(Chayka_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Chayka_all_passing_stats_norm) = Chayka_players
colnames(Chayka_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Chayka_all_passing_stats, 'Chayka_passing.csv')


Chertanovo_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Chertanovo/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Chertanovo_players = Chertanovo_total_passes$X
Chertanovo_total_passes$X = NULL
rownames(Chertanovo_total_passes) = Chertanovo_players
Chertanovo_total_passes_matrix <- as.matrix(Chertanovo_total_passes)
Chertanovo_total_passes_graph = graph_from_adjacency_matrix(Chertanovo_total_passes_matrix, mode = "directed", weighted = TRUE)
Chertanovo_total_passes_closeness= centr_clo(Chertanovo_total_passes_graph, mode='total', normalized = TRUE)
Chertanovo_total_passes_betw = centralization.betweenness(Chertanovo_total_passes_graph, normalized =TRUE)
Chertanovo_total_passes_pagerank= page_rank(Chertanovo_total_passes_graph, algo ="power", vids = V(Chertanovo_total_passes_graph), directed = TRUE, weights = E(Chertanovo_total_passes_graph)$weight)
Chertanovo_total_passes_closeness = Chertanovo_total_passes_closeness[['res']]
Chertanovo_total_passes_betw = Chertanovo_total_passes_betw[['res']]
Chertanovo_total_passes_pagerank = Chertanovo_total_passes_pagerank[["vector"]]
Chertanovo_total_passes_transitivity = transitivity(Chertanovo_total_passes_graph,  type="weighted")
Chertanovo_total_passes_closeness[is.nan(Chertanovo_total_passes_closeness)] = 0
Chertanovo_total_passes_betw[is.nan(Chertanovo_total_passes_betw)] = 0
Chertanovo_total_passes_pagerank[is.nan(Chertanovo_total_passes_pagerank)] = 0
Chertanovo_total_passes_transitivity[is.nan(Chertanovo_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Chertanovo_total_passes_metrics=cbind(Chertanovo_players,Chertanovo_total_passes_closeness, Chertanovo_total_passes_betw,  Chertanovo_total_passes_pagerank, Chertanovo_total_passes_transitivity)
colnames(Chertanovo_total_passes_metrics)[1] = 'Player' 

#forward_passes
Chertanovo_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Chertanovo/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Chertanovo_players = Chertanovo_forward_passes$X
Chertanovo_forward_passes$X = NULL
rownames(Chertanovo_forward_passes) = Chertanovo_players
Chertanovo_forward_passes_matrix <- as.matrix(Chertanovo_forward_passes)
Chertanovo_forward_passes_graph = graph_from_adjacency_matrix(Chertanovo_forward_passes_matrix, mode = "directed", weighted = TRUE)
Chertanovo_forward_passes_closeness= centr_clo(Chertanovo_forward_passes_graph, mode='total', normalized = TRUE)
Chertanovo_forward_passes_betw = centralization.betweenness(Chertanovo_forward_passes_graph, normalized =TRUE)
Chertanovo_forward_passes_pagerank= page_rank(Chertanovo_forward_passes_graph, algo ="power", vids = V(Chertanovo_forward_passes_graph), directed = TRUE, weights = E(Chertanovo_forward_passes_graph)$weight)
Chertanovo_forward_passes_closeness = Chertanovo_forward_passes_closeness[['res']]
Chertanovo_forward_passes_betw = Chertanovo_forward_passes_betw[['res']]
Chertanovo_forward_passes_pagerank = Chertanovo_forward_passes_pagerank[["vector"]]
Chertanovo_forward_passes_transitivity = transitivity(Chertanovo_forward_passes_graph,  type="weighted")
Chertanovo_forward_passes_closeness[is.nan(Chertanovo_forward_passes_closeness)] = 0
Chertanovo_forward_passes_betw[is.nan(Chertanovo_forward_passes_betw)] = 0
Chertanovo_forward_passes_pagerank[is.nan(Chertanovo_forward_passes_pagerank)] = 0
Chertanovo_forward_passes_transitivity[is.nan(Chertanovo_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Chertanovo_forward_passes_metrics=cbind(Chertanovo_players,Chertanovo_forward_passes_closeness, Chertanovo_forward_passes_betw,  Chertanovo_forward_passes_pagerank, Chertanovo_forward_passes_transitivity)
colnames(Chertanovo_forward_passes_metrics)[1] = 'Player' 


#back_passes
Chertanovo_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Chertanovo/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Chertanovo_players = Chertanovo_back_passes$X
Chertanovo_back_passes$X = NULL
rownames(Chertanovo_back_passes) = Chertanovo_players
Chertanovo_back_passes_matrix <- as.matrix(Chertanovo_back_passes)
Chertanovo_back_passes_graph = graph_from_adjacency_matrix(Chertanovo_back_passes_matrix, mode = "directed", weighted = TRUE)
Chertanovo_back_passes_closeness= centr_clo(Chertanovo_back_passes_graph, mode='total', normalized = TRUE)
Chertanovo_back_passes_betw = centralization.betweenness(Chertanovo_back_passes_graph, normalized =TRUE)
Chertanovo_back_passes_pagerank= page_rank(Chertanovo_back_passes_graph, algo ="power", vids = V(Chertanovo_back_passes_graph), directed = TRUE, weights = E(Chertanovo_back_passes_graph)$weight)
Chertanovo_back_passes_closeness = Chertanovo_back_passes_closeness[['res']]
Chertanovo_back_passes_betw = Chertanovo_back_passes_betw[['res']]
Chertanovo_back_passes_pagerank = Chertanovo_back_passes_pagerank[["vector"]]
Chertanovo_back_passes_transitivity = transitivity(Chertanovo_back_passes_graph,  type="weighted")
Chertanovo_back_passes_closeness[is.nan(Chertanovo_back_passes_closeness)] = 0
Chertanovo_back_passes_betw[is.nan(Chertanovo_back_passes_betw)] = 0
Chertanovo_back_passes_pagerank[is.nan(Chertanovo_back_passes_pagerank)] = 0
Chertanovo_back_passes_transitivity[is.nan(Chertanovo_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Chertanovo_back_passes_metrics=cbind(Chertanovo_players,Chertanovo_back_passes_closeness, Chertanovo_back_passes_betw,  Chertanovo_back_passes_pagerank, Chertanovo_back_passes_transitivity)
colnames(Chertanovo_back_passes_metrics)[1] = 'Player'  


#long_passes
Chertanovo_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Chertanovo/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Chertanovo_players = Chertanovo_long_passes$X
Chertanovo_long_passes$X = NULL
rownames(Chertanovo_long_passes) = Chertanovo_players
Chertanovo_long_passes_matrix <- as.matrix(Chertanovo_long_passes)
Chertanovo_long_passes_graph = graph_from_adjacency_matrix(Chertanovo_long_passes_matrix, mode = "directed", weighted = TRUE)
Chertanovo_long_passes_closeness= centr_clo(Chertanovo_long_passes_graph, mode='total', normalized = TRUE)
Chertanovo_long_passes_betw = centralization.betweenness(Chertanovo_long_passes_graph, normalized =TRUE)
Chertanovo_long_passes_pagerank= page_rank(Chertanovo_long_passes_graph, algo ="power", vids = V(Chertanovo_long_passes_graph), directed = TRUE, weights = E(Chertanovo_long_passes_graph)$weight)
Chertanovo_long_passes_closeness = Chertanovo_long_passes_closeness[['res']]
Chertanovo_long_passes_betw = Chertanovo_long_passes_betw[['res']]
Chertanovo_long_passes_pagerank = Chertanovo_long_passes_pagerank[["vector"]]
Chertanovo_long_passes_transitivity = transitivity(Chertanovo_long_passes_graph,  type="weighted")
Chertanovo_long_passes_closeness[is.nan(Chertanovo_long_passes_closeness)] = 0
Chertanovo_long_passes_betw[is.nan(Chertanovo_long_passes_betw)] = 0
Chertanovo_long_passes_pagerank[is.nan(Chertanovo_long_passes_pagerank)] = 0
Chertanovo_long_passes_transitivity[is.nan(Chertanovo_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Chertanovo_long_passes_metrics=cbind(Chertanovo_players,Chertanovo_long_passes_closeness, Chertanovo_long_passes_betw,  Chertanovo_long_passes_pagerank, Chertanovo_long_passes_transitivity)
colnames(Chertanovo_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Chertanovo_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Chertanovo/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Chertanovo_players = Chertanovo_final_3rd_passes$X
Chertanovo_final_3rd_passes$X = NULL
rownames(Chertanovo_final_3rd_passes) = Chertanovo_players
Chertanovo_final_3rd_passes_matrix <- as.matrix(Chertanovo_final_3rd_passes)
Chertanovo_final_3rd_passes_graph = graph_from_adjacency_matrix(Chertanovo_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Chertanovo_final_3rd_passes_closeness= centr_clo(Chertanovo_final_3rd_passes_graph, mode='total', normalized = TRUE)
Chertanovo_final_3rd_passes_betw = centralization.betweenness(Chertanovo_final_3rd_passes_graph, normalized =TRUE)
Chertanovo_final_3rd_passes_pagerank= page_rank(Chertanovo_final_3rd_passes_graph, algo ="power", vids = V(Chertanovo_final_3rd_passes_graph), directed = TRUE, weights = E(Chertanovo_final_3rd_passes_graph)$weight)
Chertanovo_final_3rd_passes_closeness = Chertanovo_final_3rd_passes_closeness[['res']]
Chertanovo_final_3rd_passes_betw = Chertanovo_final_3rd_passes_betw[['res']]
Chertanovo_final_3rd_passes_pagerank = Chertanovo_final_3rd_passes_pagerank[["vector"]]
Chertanovo_final_3rd_passes_transitivity = transitivity(Chertanovo_final_3rd_passes_graph,  type="weighted")
Chertanovo_final_3rd_passes_closeness[is.nan(Chertanovo_final_3rd_passes_closeness)] = 0
Chertanovo_final_3rd_passes_betw[is.nan(Chertanovo_final_3rd_passes_betw)] = 0
Chertanovo_final_3rd_passes_pagerank[is.nan(Chertanovo_final_3rd_passes_pagerank)] = 0
Chertanovo_final_3rd_passes_transitivity[is.nan(Chertanovo_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Chertanovo_final_3rd_passes_metrics=cbind(Chertanovo_players,Chertanovo_final_3rd_passes_closeness, Chertanovo_final_3rd_passes_betw,  Chertanovo_final_3rd_passes_pagerank, Chertanovo_final_3rd_passes_transitivity)
colnames(Chertanovo_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Chertanovo_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Chertanovo/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Chertanovo_players = Chertanovo_progressive_passes$X
Chertanovo_progressive_passes$X = NULL
rownames(Chertanovo_progressive_passes) = Chertanovo_players
Chertanovo_progressive_passes_matrix <- as.matrix(Chertanovo_progressive_passes)
Chertanovo_progressive_passes_graph = graph_from_adjacency_matrix(Chertanovo_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Chertanovo_progressive_passes_closeness= centr_clo(Chertanovo_progressive_passes_graph, mode='total', normalized = TRUE)
Chertanovo_progressive_passes_betw = centralization.betweenness(Chertanovo_progressive_passes_graph, normalized =TRUE)
Chertanovo_progressive_passes_pagerank= page_rank(Chertanovo_progressive_passes_graph, algo ="power", vids = V(Chertanovo_progressive_passes_graph), directed = TRUE, weights = E(Chertanovo_progressive_passes_graph)$weight)
Chertanovo_progressive_passes_closeness = Chertanovo_progressive_passes_closeness[['res']]
Chertanovo_progressive_passes_betw = Chertanovo_progressive_passes_betw[['res']]
Chertanovo_progressive_passes_pagerank = Chertanovo_progressive_passes_pagerank[["vector"]]
Chertanovo_progressive_passes_transitivity = transitivity(Chertanovo_progressive_passes_graph,  type="weighted")
Chertanovo_progressive_passes_closeness[is.nan(Chertanovo_progressive_passes_closeness)] = 0
Chertanovo_progressive_passes_betw[is.nan(Chertanovo_progressive_passes_betw)] = 0
Chertanovo_progressive_passes_pagerank[is.nan(Chertanovo_progressive_passes_pagerank)] = 0
Chertanovo_progressive_passes_transitivity[is.nan(Chertanovo_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Chertanovo_progressive_passes_metrics=cbind(Chertanovo_players,Chertanovo_progressive_passes_closeness, Chertanovo_progressive_passes_betw,  Chertanovo_progressive_passes_pagerank, Chertanovo_progressive_passes_transitivity)
colnames(Chertanovo_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Chertanovo_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Chertanovo_total_passes_metrics, 
Chertanovo_forward_passes_metrics,
Chertanovo_back_passes_metrics,
Chertanovo_long_passes_metrics,
Chertanovo_final_3rd_passes_metrics,
Chertanovo_progressive_passes_metrics))



#norm_data
rownames(Chertanovo_all_passing_stats) = Chertanovo_players
Chertanovo_all_passing_stats$Player = NULL
Chertanovo_all_passing_stats = unfactor(Chertanovo_all_passing_stats)
Chertanovo_all_passing_stats_norm =  data.frame(lapply(Chertanovo_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Chertanovo_all_passing_stats_norm) = Chertanovo_players
colnames(Chertanovo_all_passing_stats_norm) = column_names
setwd("~/Desktop/ML_SPORTS/fnl_all_model")
write.csv(Chertanovo_all_passing_stats, 'Chertanovo_passing.csv')


Fakel_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Fakel/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Fakel_players = Fakel_total_passes$X
Fakel_total_passes$X = NULL
rownames(Fakel_total_passes) = Fakel_players
Fakel_total_passes_matrix <- as.matrix(Fakel_total_passes)
Fakel_total_passes_graph = graph_from_adjacency_matrix(Fakel_total_passes_matrix, mode = "directed", weighted = TRUE)
Fakel_total_passes_closeness= centr_clo(Fakel_total_passes_graph, mode='total', normalized = TRUE)
Fakel_total_passes_betw = centralization.betweenness(Fakel_total_passes_graph, normalized =TRUE)
Fakel_total_passes_pagerank= page_rank(Fakel_total_passes_graph, algo ="power", vids = V(Fakel_total_passes_graph), directed = TRUE, weights = E(Fakel_total_passes_graph)$weight)
Fakel_total_passes_closeness = Fakel_total_passes_closeness[['res']]
Fakel_total_passes_betw = Fakel_total_passes_betw[['res']]
Fakel_total_passes_pagerank = Fakel_total_passes_pagerank[["vector"]]
Fakel_total_passes_transitivity = transitivity(Fakel_total_passes_graph,  type="weighted")
Fakel_total_passes_closeness[is.nan(Fakel_total_passes_closeness)] = 0
Fakel_total_passes_betw[is.nan(Fakel_total_passes_betw)] = 0
Fakel_total_passes_pagerank[is.nan(Fakel_total_passes_pagerank)] = 0
Fakel_total_passes_transitivity[is.nan(Fakel_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Fakel_total_passes_metrics=cbind(Fakel_players,Fakel_total_passes_closeness, Fakel_total_passes_betw,  Fakel_total_passes_pagerank, Fakel_total_passes_transitivity)
colnames(Fakel_total_passes_metrics)[1] = 'Player' 

#forward_passes
Fakel_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Fakel/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Fakel_players = Fakel_forward_passes$X
Fakel_forward_passes$X = NULL
rownames(Fakel_forward_passes) = Fakel_players
Fakel_forward_passes_matrix <- as.matrix(Fakel_forward_passes)
Fakel_forward_passes_graph = graph_from_adjacency_matrix(Fakel_forward_passes_matrix, mode = "directed", weighted = TRUE)
Fakel_forward_passes_closeness= centr_clo(Fakel_forward_passes_graph, mode='total', normalized = TRUE)
Fakel_forward_passes_betw = centralization.betweenness(Fakel_forward_passes_graph, normalized =TRUE)
Fakel_forward_passes_pagerank= page_rank(Fakel_forward_passes_graph, algo ="power", vids = V(Fakel_forward_passes_graph), directed = TRUE, weights = E(Fakel_forward_passes_graph)$weight)
Fakel_forward_passes_closeness = Fakel_forward_passes_closeness[['res']]
Fakel_forward_passes_betw = Fakel_forward_passes_betw[['res']]
Fakel_forward_passes_pagerank = Fakel_forward_passes_pagerank[["vector"]]
Fakel_forward_passes_transitivity = transitivity(Fakel_forward_passes_graph,  type="weighted")
Fakel_forward_passes_closeness[is.nan(Fakel_forward_passes_closeness)] = 0
Fakel_forward_passes_betw[is.nan(Fakel_forward_passes_betw)] = 0
Fakel_forward_passes_pagerank[is.nan(Fakel_forward_passes_pagerank)] = 0
Fakel_forward_passes_transitivity[is.nan(Fakel_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Fakel_forward_passes_metrics=cbind(Fakel_players,Fakel_forward_passes_closeness, Fakel_forward_passes_betw,  Fakel_forward_passes_pagerank, Fakel_forward_passes_transitivity)
colnames(Fakel_forward_passes_metrics)[1] = 'Player' 


#back_passes
Fakel_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Fakel/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Fakel_players = Fakel_back_passes$X
Fakel_back_passes$X = NULL
rownames(Fakel_back_passes) = Fakel_players
Fakel_back_passes_matrix <- as.matrix(Fakel_back_passes)
Fakel_back_passes_graph = graph_from_adjacency_matrix(Fakel_back_passes_matrix, mode = "directed", weighted = TRUE)
Fakel_back_passes_closeness= centr_clo(Fakel_back_passes_graph, mode='total', normalized = TRUE)
Fakel_back_passes_betw = centralization.betweenness(Fakel_back_passes_graph, normalized =TRUE)
Fakel_back_passes_pagerank= page_rank(Fakel_back_passes_graph, algo ="power", vids = V(Fakel_back_passes_graph), directed = TRUE, weights = E(Fakel_back_passes_graph)$weight)
Fakel_back_passes_closeness = Fakel_back_passes_closeness[['res']]
Fakel_back_passes_betw = Fakel_back_passes_betw[['res']]
Fakel_back_passes_pagerank = Fakel_back_passes_pagerank[["vector"]]
Fakel_back_passes_transitivity = transitivity(Fakel_back_passes_graph,  type="weighted")
Fakel_back_passes_closeness[is.nan(Fakel_back_passes_closeness)] = 0
Fakel_back_passes_betw[is.nan(Fakel_back_passes_betw)] = 0
Fakel_back_passes_pagerank[is.nan(Fakel_back_passes_pagerank)] = 0
Fakel_back_passes_transitivity[is.nan(Fakel_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Fakel_back_passes_metrics=cbind(Fakel_players,Fakel_back_passes_closeness, Fakel_back_passes_betw,  Fakel_back_passes_pagerank, Fakel_back_passes_transitivity)
colnames(Fakel_back_passes_metrics)[1] = 'Player'  


#long_passes
Fakel_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Fakel/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Fakel_players = Fakel_long_passes$X
Fakel_long_passes$X = NULL
rownames(Fakel_long_passes) = Fakel_players
Fakel_long_passes_matrix <- as.matrix(Fakel_long_passes)
Fakel_long_passes_graph = graph_from_adjacency_matrix(Fakel_long_passes_matrix, mode = "directed", weighted = TRUE)
Fakel_long_passes_closeness= centr_clo(Fakel_long_passes_graph, mode='total', normalized = TRUE)
Fakel_long_passes_betw = centralization.betweenness(Fakel_long_passes_graph, normalized =TRUE)
Fakel_long_passes_pagerank= page_rank(Fakel_long_passes_graph, algo ="power", vids = V(Fakel_long_passes_graph), directed = TRUE, weights = E(Fakel_long_passes_graph)$weight)
Fakel_long_passes_closeness = Fakel_long_passes_closeness[['res']]
Fakel_long_passes_betw = Fakel_long_passes_betw[['res']]
Fakel_long_passes_pagerank = Fakel_long_passes_pagerank[["vector"]]
Fakel_long_passes_transitivity = transitivity(Fakel_long_passes_graph,  type="weighted")
Fakel_long_passes_closeness[is.nan(Fakel_long_passes_closeness)] = 0
Fakel_long_passes_betw[is.nan(Fakel_long_passes_betw)] = 0
Fakel_long_passes_pagerank[is.nan(Fakel_long_passes_pagerank)] = 0
Fakel_long_passes_transitivity[is.nan(Fakel_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Fakel_long_passes_metrics=cbind(Fakel_players,Fakel_long_passes_closeness, Fakel_long_passes_betw,  Fakel_long_passes_pagerank, Fakel_long_passes_transitivity)
colnames(Fakel_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Fakel_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Fakel/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Fakel_players = Fakel_final_3rd_passes$X
Fakel_final_3rd_passes$X = NULL
rownames(Fakel_final_3rd_passes) = Fakel_players
Fakel_final_3rd_passes_matrix <- as.matrix(Fakel_final_3rd_passes)
Fakel_final_3rd_passes_graph = graph_from_adjacency_matrix(Fakel_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Fakel_final_3rd_passes_closeness= centr_clo(Fakel_final_3rd_passes_graph, mode='total', normalized = TRUE)
Fakel_final_3rd_passes_betw = centralization.betweenness(Fakel_final_3rd_passes_graph, normalized =TRUE)
Fakel_final_3rd_passes_pagerank= page_rank(Fakel_final_3rd_passes_graph, algo ="power", vids = V(Fakel_final_3rd_passes_graph), directed = TRUE, weights = E(Fakel_final_3rd_passes_graph)$weight)
Fakel_final_3rd_passes_closeness = Fakel_final_3rd_passes_closeness[['res']]
Fakel_final_3rd_passes_betw = Fakel_final_3rd_passes_betw[['res']]
Fakel_final_3rd_passes_pagerank = Fakel_final_3rd_passes_pagerank[["vector"]]
Fakel_final_3rd_passes_transitivity = transitivity(Fakel_final_3rd_passes_graph,  type="weighted")
Fakel_final_3rd_passes_closeness[is.nan(Fakel_final_3rd_passes_closeness)] = 0
Fakel_final_3rd_passes_betw[is.nan(Fakel_final_3rd_passes_betw)] = 0
Fakel_final_3rd_passes_pagerank[is.nan(Fakel_final_3rd_passes_pagerank)] = 0
Fakel_final_3rd_passes_transitivity[is.nan(Fakel_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Fakel_final_3rd_passes_metrics=cbind(Fakel_players,Fakel_final_3rd_passes_closeness, Fakel_final_3rd_passes_betw,  Fakel_final_3rd_passes_pagerank, Fakel_final_3rd_passes_transitivity)
colnames(Fakel_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Fakel_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Fakel/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Fakel_players = Fakel_progressive_passes$X
Fakel_progressive_passes$X = NULL
rownames(Fakel_progressive_passes) = Fakel_players
Fakel_progressive_passes_matrix <- as.matrix(Fakel_progressive_passes)
Fakel_progressive_passes_graph = graph_from_adjacency_matrix(Fakel_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Fakel_progressive_passes_closeness= centr_clo(Fakel_progressive_passes_graph, mode='total', normalized = TRUE)
Fakel_progressive_passes_betw = centralization.betweenness(Fakel_progressive_passes_graph, normalized =TRUE)
Fakel_progressive_passes_pagerank= page_rank(Fakel_progressive_passes_graph, algo ="power", vids = V(Fakel_progressive_passes_graph), directed = TRUE, weights = E(Fakel_progressive_passes_graph)$weight)
Fakel_progressive_passes_closeness = Fakel_progressive_passes_closeness[['res']]
Fakel_progressive_passes_betw = Fakel_progressive_passes_betw[['res']]
Fakel_progressive_passes_pagerank = Fakel_progressive_passes_pagerank[["vector"]]
Fakel_progressive_passes_transitivity = transitivity(Fakel_progressive_passes_graph,  type="weighted")
Fakel_progressive_passes_closeness[is.nan(Fakel_progressive_passes_closeness)] = 0
Fakel_progressive_passes_betw[is.nan(Fakel_progressive_passes_betw)] = 0
Fakel_progressive_passes_pagerank[is.nan(Fakel_progressive_passes_pagerank)] = 0
Fakel_progressive_passes_transitivity[is.nan(Fakel_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Fakel_progressive_passes_metrics=cbind(Fakel_players,Fakel_progressive_passes_closeness, Fakel_progressive_passes_betw,  Fakel_progressive_passes_pagerank, Fakel_progressive_passes_transitivity)
colnames(Fakel_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Fakel_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Fakel_total_passes_metrics, 
Fakel_forward_passes_metrics,
Fakel_back_passes_metrics,
Fakel_long_passes_metrics,
Fakel_final_3rd_passes_metrics,
Fakel_progressive_passes_metrics))



#norm_data
rownames(Fakel_all_passing_stats) = Fakel_players
Fakel_all_passing_stats$Player = NULL
Fakel_all_passing_stats = unfactor(Fakel_all_passing_stats)
Fakel_all_passing_stats_norm =  data.frame(lapply(Fakel_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Fakel_all_passing_stats_norm) = Fakel_players
colnames(Fakel_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Fakel_all_passing_stats, 'Fakel_passing.csv')



Khimki_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Khimki/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Khimki_players = Khimki_total_passes$X
Khimki_total_passes$X = NULL
rownames(Khimki_total_passes) = Khimki_players
Khimki_total_passes_matrix <- as.matrix(Khimki_total_passes)
Khimki_total_passes_graph = graph_from_adjacency_matrix(Khimki_total_passes_matrix, mode = "directed", weighted = TRUE)
Khimki_total_passes_closeness= centr_clo(Khimki_total_passes_graph, mode='total', normalized = TRUE)
Khimki_total_passes_betw = centralization.betweenness(Khimki_total_passes_graph, normalized =TRUE)
Khimki_total_passes_pagerank= page_rank(Khimki_total_passes_graph, algo ="power", vids = V(Khimki_total_passes_graph), directed = TRUE, weights = E(Khimki_total_passes_graph)$weight)
Khimki_total_passes_closeness = Khimki_total_passes_closeness[['res']]
Khimki_total_passes_betw = Khimki_total_passes_betw[['res']]
Khimki_total_passes_pagerank = Khimki_total_passes_pagerank[["vector"]]
Khimki_total_passes_transitivity = transitivity(Khimki_total_passes_graph,  type="weighted")
Khimki_total_passes_closeness[is.nan(Khimki_total_passes_closeness)] = 0
Khimki_total_passes_betw[is.nan(Khimki_total_passes_betw)] = 0
Khimki_total_passes_pagerank[is.nan(Khimki_total_passes_pagerank)] = 0
Khimki_total_passes_transitivity[is.nan(Khimki_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Khimki_total_passes_metrics=cbind(Khimki_players,Khimki_total_passes_closeness, Khimki_total_passes_betw,  Khimki_total_passes_pagerank, Khimki_total_passes_transitivity)
colnames(Khimki_total_passes_metrics)[1] = 'Player' 

#forward_passes
Khimki_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Khimki/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Khimki_players = Khimki_forward_passes$X
Khimki_forward_passes$X = NULL
rownames(Khimki_forward_passes) = Khimki_players
Khimki_forward_passes_matrix <- as.matrix(Khimki_forward_passes)
Khimki_forward_passes_graph = graph_from_adjacency_matrix(Khimki_forward_passes_matrix, mode = "directed", weighted = TRUE)
Khimki_forward_passes_closeness= centr_clo(Khimki_forward_passes_graph, mode='total', normalized = TRUE)
Khimki_forward_passes_betw = centralization.betweenness(Khimki_forward_passes_graph, normalized =TRUE)
Khimki_forward_passes_pagerank= page_rank(Khimki_forward_passes_graph, algo ="power", vids = V(Khimki_forward_passes_graph), directed = TRUE, weights = E(Khimki_forward_passes_graph)$weight)
Khimki_forward_passes_closeness = Khimki_forward_passes_closeness[['res']]
Khimki_forward_passes_betw = Khimki_forward_passes_betw[['res']]
Khimki_forward_passes_pagerank = Khimki_forward_passes_pagerank[["vector"]]
Khimki_forward_passes_transitivity = transitivity(Khimki_forward_passes_graph,  type="weighted")
Khimki_forward_passes_closeness[is.nan(Khimki_forward_passes_closeness)] = 0
Khimki_forward_passes_betw[is.nan(Khimki_forward_passes_betw)] = 0
Khimki_forward_passes_pagerank[is.nan(Khimki_forward_passes_pagerank)] = 0
Khimki_forward_passes_transitivity[is.nan(Khimki_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Khimki_forward_passes_metrics=cbind(Khimki_players,Khimki_forward_passes_closeness, Khimki_forward_passes_betw,  Khimki_forward_passes_pagerank, Khimki_forward_passes_transitivity)
colnames(Khimki_forward_passes_metrics)[1] = 'Player' 


#back_passes
Khimki_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Khimki/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Khimki_players = Khimki_back_passes$X
Khimki_back_passes$X = NULL
rownames(Khimki_back_passes) = Khimki_players
Khimki_back_passes_matrix <- as.matrix(Khimki_back_passes)
Khimki_back_passes_graph = graph_from_adjacency_matrix(Khimki_back_passes_matrix, mode = "directed", weighted = TRUE)
Khimki_back_passes_closeness= centr_clo(Khimki_back_passes_graph, mode='total', normalized = TRUE)
Khimki_back_passes_betw = centralization.betweenness(Khimki_back_passes_graph, normalized =TRUE)
Khimki_back_passes_pagerank= page_rank(Khimki_back_passes_graph, algo ="power", vids = V(Khimki_back_passes_graph), directed = TRUE, weights = E(Khimki_back_passes_graph)$weight)
Khimki_back_passes_closeness = Khimki_back_passes_closeness[['res']]
Khimki_back_passes_betw = Khimki_back_passes_betw[['res']]
Khimki_back_passes_pagerank = Khimki_back_passes_pagerank[["vector"]]
Khimki_back_passes_transitivity = transitivity(Khimki_back_passes_graph,  type="weighted")
Khimki_back_passes_closeness[is.nan(Khimki_back_passes_closeness)] = 0
Khimki_back_passes_betw[is.nan(Khimki_back_passes_betw)] = 0
Khimki_back_passes_pagerank[is.nan(Khimki_back_passes_pagerank)] = 0
Khimki_back_passes_transitivity[is.nan(Khimki_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Khimki_back_passes_metrics=cbind(Khimki_players,Khimki_back_passes_closeness, Khimki_back_passes_betw,  Khimki_back_passes_pagerank, Khimki_back_passes_transitivity)
colnames(Khimki_back_passes_metrics)[1] = 'Player'  


#long_passes
Khimki_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Khimki/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Khimki_players = Khimki_long_passes$X
Khimki_long_passes$X = NULL
rownames(Khimki_long_passes) = Khimki_players
Khimki_long_passes_matrix <- as.matrix(Khimki_long_passes)
Khimki_long_passes_graph = graph_from_adjacency_matrix(Khimki_long_passes_matrix, mode = "directed", weighted = TRUE)
Khimki_long_passes_closeness= centr_clo(Khimki_long_passes_graph, mode='total', normalized = TRUE)
Khimki_long_passes_betw = centralization.betweenness(Khimki_long_passes_graph, normalized =TRUE)
Khimki_long_passes_pagerank= page_rank(Khimki_long_passes_graph, algo ="power", vids = V(Khimki_long_passes_graph), directed = TRUE, weights = E(Khimki_long_passes_graph)$weight)
Khimki_long_passes_closeness = Khimki_long_passes_closeness[['res']]
Khimki_long_passes_betw = Khimki_long_passes_betw[['res']]
Khimki_long_passes_pagerank = Khimki_long_passes_pagerank[["vector"]]
Khimki_long_passes_transitivity = transitivity(Khimki_long_passes_graph,  type="weighted")
Khimki_long_passes_closeness[is.nan(Khimki_long_passes_closeness)] = 0
Khimki_long_passes_betw[is.nan(Khimki_long_passes_betw)] = 0
Khimki_long_passes_pagerank[is.nan(Khimki_long_passes_pagerank)] = 0
Khimki_long_passes_transitivity[is.nan(Khimki_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Khimki_long_passes_metrics=cbind(Khimki_players,Khimki_long_passes_closeness, Khimki_long_passes_betw,  Khimki_long_passes_pagerank, Khimki_long_passes_transitivity)
colnames(Khimki_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Khimki_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Khimki/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Khimki_players = Khimki_final_3rd_passes$X
Khimki_final_3rd_passes$X = NULL
rownames(Khimki_final_3rd_passes) = Khimki_players
Khimki_final_3rd_passes_matrix <- as.matrix(Khimki_final_3rd_passes)
Khimki_final_3rd_passes_graph = graph_from_adjacency_matrix(Khimki_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Khimki_final_3rd_passes_closeness= centr_clo(Khimki_final_3rd_passes_graph, mode='total', normalized = TRUE)
Khimki_final_3rd_passes_betw = centralization.betweenness(Khimki_final_3rd_passes_graph, normalized =TRUE)
Khimki_final_3rd_passes_pagerank= page_rank(Khimki_final_3rd_passes_graph, algo ="power", vids = V(Khimki_final_3rd_passes_graph), directed = TRUE, weights = E(Khimki_final_3rd_passes_graph)$weight)
Khimki_final_3rd_passes_closeness = Khimki_final_3rd_passes_closeness[['res']]
Khimki_final_3rd_passes_betw = Khimki_final_3rd_passes_betw[['res']]
Khimki_final_3rd_passes_pagerank = Khimki_final_3rd_passes_pagerank[["vector"]]
Khimki_final_3rd_passes_transitivity = transitivity(Khimki_final_3rd_passes_graph,  type="weighted")
Khimki_final_3rd_passes_closeness[is.nan(Khimki_final_3rd_passes_closeness)] = 0
Khimki_final_3rd_passes_betw[is.nan(Khimki_final_3rd_passes_betw)] = 0
Khimki_final_3rd_passes_pagerank[is.nan(Khimki_final_3rd_passes_pagerank)] = 0
Khimki_final_3rd_passes_transitivity[is.nan(Khimki_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Khimki_final_3rd_passes_metrics=cbind(Khimki_players,Khimki_final_3rd_passes_closeness, Khimki_final_3rd_passes_betw,  Khimki_final_3rd_passes_pagerank, Khimki_final_3rd_passes_transitivity)
colnames(Khimki_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Khimki_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Khimki/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Khimki_players = Khimki_progressive_passes$X
Khimki_progressive_passes$X = NULL
rownames(Khimki_progressive_passes) = Khimki_players
Khimki_progressive_passes_matrix <- as.matrix(Khimki_progressive_passes)
Khimki_progressive_passes_graph = graph_from_adjacency_matrix(Khimki_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Khimki_progressive_passes_closeness= centr_clo(Khimki_progressive_passes_graph, mode='total', normalized = TRUE)
Khimki_progressive_passes_betw = centralization.betweenness(Khimki_progressive_passes_graph, normalized =TRUE)
Khimki_progressive_passes_pagerank= page_rank(Khimki_progressive_passes_graph, algo ="power", vids = V(Khimki_progressive_passes_graph), directed = TRUE, weights = E(Khimki_progressive_passes_graph)$weight)
Khimki_progressive_passes_closeness = Khimki_progressive_passes_closeness[['res']]
Khimki_progressive_passes_betw = Khimki_progressive_passes_betw[['res']]
Khimki_progressive_passes_pagerank = Khimki_progressive_passes_pagerank[["vector"]]
Khimki_progressive_passes_transitivity = transitivity(Khimki_progressive_passes_graph,  type="weighted")
Khimki_progressive_passes_closeness[is.nan(Khimki_progressive_passes_closeness)] = 0
Khimki_progressive_passes_betw[is.nan(Khimki_progressive_passes_betw)] = 0
Khimki_progressive_passes_pagerank[is.nan(Khimki_progressive_passes_pagerank)] = 0
Khimki_progressive_passes_transitivity[is.nan(Khimki_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Khimki_progressive_passes_metrics=cbind(Khimki_players,Khimki_progressive_passes_closeness, Khimki_progressive_passes_betw,  Khimki_progressive_passes_pagerank, Khimki_progressive_passes_transitivity)
colnames(Khimki_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Khimki_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Khimki_total_passes_metrics, 
Khimki_forward_passes_metrics,
Khimki_back_passes_metrics,
Khimki_long_passes_metrics,
Khimki_final_3rd_passes_metrics,
Khimki_progressive_passes_metrics))



#norm_data
rownames(Khimki_all_passing_stats) = Khimki_players
Khimki_all_passing_stats$Player = NULL
Khimki_all_passing_stats = unfactor(Khimki_all_passing_stats)
Khimki_all_passing_stats_norm =  data.frame(lapply(Khimki_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Khimki_all_passing_stats_norm) = Khimki_players
colnames(Khimki_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Khimki_all_passing_stats, 'Khimki_passing.csv')


Krasnodar_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Krasnodar/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Krasnodar_players = Krasnodar_total_passes$X
Krasnodar_total_passes$X = NULL
rownames(Krasnodar_total_passes) = Krasnodar_players
Krasnodar_total_passes_matrix <- as.matrix(Krasnodar_total_passes)
Krasnodar_total_passes_graph = graph_from_adjacency_matrix(Krasnodar_total_passes_matrix, mode = "directed", weighted = TRUE)
Krasnodar_total_passes_closeness= centr_clo(Krasnodar_total_passes_graph, mode='total', normalized = TRUE)
Krasnodar_total_passes_betw = centralization.betweenness(Krasnodar_total_passes_graph, normalized =TRUE)
Krasnodar_total_passes_pagerank= page_rank(Krasnodar_total_passes_graph, algo ="power", vids = V(Krasnodar_total_passes_graph), directed = TRUE, weights = E(Krasnodar_total_passes_graph)$weight)
Krasnodar_total_passes_closeness = Krasnodar_total_passes_closeness[['res']]
Krasnodar_total_passes_betw = Krasnodar_total_passes_betw[['res']]
Krasnodar_total_passes_pagerank = Krasnodar_total_passes_pagerank[["vector"]]
Krasnodar_total_passes_transitivity = transitivity(Krasnodar_total_passes_graph,  type="weighted")
Krasnodar_total_passes_closeness[is.nan(Krasnodar_total_passes_closeness)] = 0
Krasnodar_total_passes_betw[is.nan(Krasnodar_total_passes_betw)] = 0
Krasnodar_total_passes_pagerank[is.nan(Krasnodar_total_passes_pagerank)] = 0
Krasnodar_total_passes_transitivity[is.nan(Krasnodar_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Krasnodar_total_passes_metrics=cbind(Krasnodar_players,Krasnodar_total_passes_closeness, Krasnodar_total_passes_betw,  Krasnodar_total_passes_pagerank, Krasnodar_total_passes_transitivity)
colnames(Krasnodar_total_passes_metrics)[1] = 'Player' 

#forward_passes
Krasnodar_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Krasnodar/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Krasnodar_players = Krasnodar_forward_passes$X
Krasnodar_forward_passes$X = NULL
rownames(Krasnodar_forward_passes) = Krasnodar_players
Krasnodar_forward_passes_matrix <- as.matrix(Krasnodar_forward_passes)
Krasnodar_forward_passes_graph = graph_from_adjacency_matrix(Krasnodar_forward_passes_matrix, mode = "directed", weighted = TRUE)
Krasnodar_forward_passes_closeness= centr_clo(Krasnodar_forward_passes_graph, mode='total', normalized = TRUE)
Krasnodar_forward_passes_betw = centralization.betweenness(Krasnodar_forward_passes_graph, normalized =TRUE)
Krasnodar_forward_passes_pagerank= page_rank(Krasnodar_forward_passes_graph, algo ="power", vids = V(Krasnodar_forward_passes_graph), directed = TRUE, weights = E(Krasnodar_forward_passes_graph)$weight)
Krasnodar_forward_passes_closeness = Krasnodar_forward_passes_closeness[['res']]
Krasnodar_forward_passes_betw = Krasnodar_forward_passes_betw[['res']]
Krasnodar_forward_passes_pagerank = Krasnodar_forward_passes_pagerank[["vector"]]
Krasnodar_forward_passes_transitivity = transitivity(Krasnodar_forward_passes_graph,  type="weighted")
Krasnodar_forward_passes_closeness[is.nan(Krasnodar_forward_passes_closeness)] = 0
Krasnodar_forward_passes_betw[is.nan(Krasnodar_forward_passes_betw)] = 0
Krasnodar_forward_passes_pagerank[is.nan(Krasnodar_forward_passes_pagerank)] = 0
Krasnodar_forward_passes_transitivity[is.nan(Krasnodar_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Krasnodar_forward_passes_metrics=cbind(Krasnodar_players,Krasnodar_forward_passes_closeness, Krasnodar_forward_passes_betw,  Krasnodar_forward_passes_pagerank, Krasnodar_forward_passes_transitivity)
colnames(Krasnodar_forward_passes_metrics)[1] = 'Player' 


#back_passes
Krasnodar_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Krasnodar/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Krasnodar_players = Krasnodar_back_passes$X
Krasnodar_back_passes$X = NULL
rownames(Krasnodar_back_passes) = Krasnodar_players
Krasnodar_back_passes_matrix <- as.matrix(Krasnodar_back_passes)
Krasnodar_back_passes_graph = graph_from_adjacency_matrix(Krasnodar_back_passes_matrix, mode = "directed", weighted = TRUE)
Krasnodar_back_passes_closeness= centr_clo(Krasnodar_back_passes_graph, mode='total', normalized = TRUE)
Krasnodar_back_passes_betw = centralization.betweenness(Krasnodar_back_passes_graph, normalized =TRUE)
Krasnodar_back_passes_pagerank= page_rank(Krasnodar_back_passes_graph, algo ="power", vids = V(Krasnodar_back_passes_graph), directed = TRUE, weights = E(Krasnodar_back_passes_graph)$weight)
Krasnodar_back_passes_closeness = Krasnodar_back_passes_closeness[['res']]
Krasnodar_back_passes_betw = Krasnodar_back_passes_betw[['res']]
Krasnodar_back_passes_pagerank = Krasnodar_back_passes_pagerank[["vector"]]
Krasnodar_back_passes_transitivity = transitivity(Krasnodar_back_passes_graph,  type="weighted")
Krasnodar_back_passes_closeness[is.nan(Krasnodar_back_passes_closeness)] = 0
Krasnodar_back_passes_betw[is.nan(Krasnodar_back_passes_betw)] = 0
Krasnodar_back_passes_pagerank[is.nan(Krasnodar_back_passes_pagerank)] = 0
Krasnodar_back_passes_transitivity[is.nan(Krasnodar_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Krasnodar_back_passes_metrics=cbind(Krasnodar_players,Krasnodar_back_passes_closeness, Krasnodar_back_passes_betw,  Krasnodar_back_passes_pagerank, Krasnodar_back_passes_transitivity)
colnames(Krasnodar_back_passes_metrics)[1] = 'Player'  


#long_passes
Krasnodar_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Krasnodar/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Krasnodar_players = Krasnodar_long_passes$X
Krasnodar_long_passes$X = NULL
rownames(Krasnodar_long_passes) = Krasnodar_players
Krasnodar_long_passes_matrix <- as.matrix(Krasnodar_long_passes)
Krasnodar_long_passes_graph = graph_from_adjacency_matrix(Krasnodar_long_passes_matrix, mode = "directed", weighted = TRUE)
Krasnodar_long_passes_closeness= centr_clo(Krasnodar_long_passes_graph, mode='total', normalized = TRUE)
Krasnodar_long_passes_betw = centralization.betweenness(Krasnodar_long_passes_graph, normalized =TRUE)
Krasnodar_long_passes_pagerank= page_rank(Krasnodar_long_passes_graph, algo ="power", vids = V(Krasnodar_long_passes_graph), directed = TRUE, weights = E(Krasnodar_long_passes_graph)$weight)
Krasnodar_long_passes_closeness = Krasnodar_long_passes_closeness[['res']]
Krasnodar_long_passes_betw = Krasnodar_long_passes_betw[['res']]
Krasnodar_long_passes_pagerank = Krasnodar_long_passes_pagerank[["vector"]]
Krasnodar_long_passes_transitivity = transitivity(Krasnodar_long_passes_graph,  type="weighted")
Krasnodar_long_passes_closeness[is.nan(Krasnodar_long_passes_closeness)] = 0
Krasnodar_long_passes_betw[is.nan(Krasnodar_long_passes_betw)] = 0
Krasnodar_long_passes_pagerank[is.nan(Krasnodar_long_passes_pagerank)] = 0
Krasnodar_long_passes_transitivity[is.nan(Krasnodar_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Krasnodar_long_passes_metrics=cbind(Krasnodar_players,Krasnodar_long_passes_closeness, Krasnodar_long_passes_betw,  Krasnodar_long_passes_pagerank, Krasnodar_long_passes_transitivity)
colnames(Krasnodar_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Krasnodar_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Krasnodar/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Krasnodar_players = Krasnodar_final_3rd_passes$X
Krasnodar_final_3rd_passes$X = NULL
rownames(Krasnodar_final_3rd_passes) = Krasnodar_players
Krasnodar_final_3rd_passes_matrix <- as.matrix(Krasnodar_final_3rd_passes)
Krasnodar_final_3rd_passes_graph = graph_from_adjacency_matrix(Krasnodar_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Krasnodar_final_3rd_passes_closeness= centr_clo(Krasnodar_final_3rd_passes_graph, mode='total', normalized = TRUE)
Krasnodar_final_3rd_passes_betw = centralization.betweenness(Krasnodar_final_3rd_passes_graph, normalized =TRUE)
Krasnodar_final_3rd_passes_pagerank= page_rank(Krasnodar_final_3rd_passes_graph, algo ="power", vids = V(Krasnodar_final_3rd_passes_graph), directed = TRUE, weights = E(Krasnodar_final_3rd_passes_graph)$weight)
Krasnodar_final_3rd_passes_closeness = Krasnodar_final_3rd_passes_closeness[['res']]
Krasnodar_final_3rd_passes_betw = Krasnodar_final_3rd_passes_betw[['res']]
Krasnodar_final_3rd_passes_pagerank = Krasnodar_final_3rd_passes_pagerank[["vector"]]
Krasnodar_final_3rd_passes_transitivity = transitivity(Krasnodar_final_3rd_passes_graph,  type="weighted")
Krasnodar_final_3rd_passes_closeness[is.nan(Krasnodar_final_3rd_passes_closeness)] = 0
Krasnodar_final_3rd_passes_betw[is.nan(Krasnodar_final_3rd_passes_betw)] = 0
Krasnodar_final_3rd_passes_pagerank[is.nan(Krasnodar_final_3rd_passes_pagerank)] = 0
Krasnodar_final_3rd_passes_transitivity[is.nan(Krasnodar_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Krasnodar_final_3rd_passes_metrics=cbind(Krasnodar_players,Krasnodar_final_3rd_passes_closeness, Krasnodar_final_3rd_passes_betw,  Krasnodar_final_3rd_passes_pagerank, Krasnodar_final_3rd_passes_transitivity)
colnames(Krasnodar_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Krasnodar_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Krasnodar/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Krasnodar_players = Krasnodar_progressive_passes$X
Krasnodar_progressive_passes$X = NULL
rownames(Krasnodar_progressive_passes) = Krasnodar_players
Krasnodar_progressive_passes_matrix <- as.matrix(Krasnodar_progressive_passes)
Krasnodar_progressive_passes_graph = graph_from_adjacency_matrix(Krasnodar_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Krasnodar_progressive_passes_closeness= centr_clo(Krasnodar_progressive_passes_graph, mode='total', normalized = TRUE)
Krasnodar_progressive_passes_betw = centralization.betweenness(Krasnodar_progressive_passes_graph, normalized =TRUE)
Krasnodar_progressive_passes_pagerank= page_rank(Krasnodar_progressive_passes_graph, algo ="power", vids = V(Krasnodar_progressive_passes_graph), directed = TRUE, weights = E(Krasnodar_progressive_passes_graph)$weight)
Krasnodar_progressive_passes_closeness = Krasnodar_progressive_passes_closeness[['res']]
Krasnodar_progressive_passes_betw = Krasnodar_progressive_passes_betw[['res']]
Krasnodar_progressive_passes_pagerank = Krasnodar_progressive_passes_pagerank[["vector"]]
Krasnodar_progressive_passes_transitivity = transitivity(Krasnodar_progressive_passes_graph,  type="weighted")
Krasnodar_progressive_passes_closeness[is.nan(Krasnodar_progressive_passes_closeness)] = 0
Krasnodar_progressive_passes_betw[is.nan(Krasnodar_progressive_passes_betw)] = 0
Krasnodar_progressive_passes_pagerank[is.nan(Krasnodar_progressive_passes_pagerank)] = 0
Krasnodar_progressive_passes_transitivity[is.nan(Krasnodar_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Krasnodar_progressive_passes_metrics=cbind(Krasnodar_players,Krasnodar_progressive_passes_closeness, Krasnodar_progressive_passes_betw,  Krasnodar_progressive_passes_pagerank, Krasnodar_progressive_passes_transitivity)
colnames(Krasnodar_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Krasnodar_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Krasnodar_total_passes_metrics, 
Krasnodar_forward_passes_metrics,
Krasnodar_back_passes_metrics,
Krasnodar_long_passes_metrics,
Krasnodar_final_3rd_passes_metrics,
Krasnodar_progressive_passes_metrics))



#norm_data
rownames(Krasnodar_all_passing_stats) = Krasnodar_players
Krasnodar_all_passing_stats$Player = NULL
Krasnodar_all_passing_stats = unfactor(Krasnodar_all_passing_stats)
Krasnodar_all_passing_stats_norm =  data.frame(lapply(Krasnodar_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Krasnodar_all_passing_stats_norm) = Krasnodar_players
colnames(Krasnodar_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Krasnodar_all_passing_stats, 'Krasnodar_passing.csv')

Luch_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Luch/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Luch_players = Luch_total_passes$X
Luch_total_passes$X = NULL
rownames(Luch_total_passes) = Luch_players
Luch_total_passes_matrix <- as.matrix(Luch_total_passes)
Luch_total_passes_graph = graph_from_adjacency_matrix(Luch_total_passes_matrix, mode = "directed", weighted = TRUE)
Luch_total_passes_closeness= centr_clo(Luch_total_passes_graph, mode='total', normalized = TRUE)
Luch_total_passes_betw = centralization.betweenness(Luch_total_passes_graph, normalized =TRUE)
Luch_total_passes_pagerank= page_rank(Luch_total_passes_graph, algo ="power", vids = V(Luch_total_passes_graph), directed = TRUE, weights = E(Luch_total_passes_graph)$weight)
Luch_total_passes_closeness = Luch_total_passes_closeness[['res']]
Luch_total_passes_betw = Luch_total_passes_betw[['res']]
Luch_total_passes_pagerank = Luch_total_passes_pagerank[["vector"]]
Luch_total_passes_transitivity = transitivity(Luch_total_passes_graph,  type="weighted")
Luch_total_passes_closeness[is.nan(Luch_total_passes_closeness)] = 0
Luch_total_passes_betw[is.nan(Luch_total_passes_betw)] = 0
Luch_total_passes_pagerank[is.nan(Luch_total_passes_pagerank)] = 0
Luch_total_passes_transitivity[is.nan(Luch_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Luch_total_passes_metrics=cbind(Luch_players,Luch_total_passes_closeness, Luch_total_passes_betw,  Luch_total_passes_pagerank, Luch_total_passes_transitivity)
colnames(Luch_total_passes_metrics)[1] = 'Player' 

#forward_passes
Luch_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Luch/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Luch_players = Luch_forward_passes$X
Luch_forward_passes$X = NULL
rownames(Luch_forward_passes) = Luch_players
Luch_forward_passes_matrix <- as.matrix(Luch_forward_passes)
Luch_forward_passes_graph = graph_from_adjacency_matrix(Luch_forward_passes_matrix, mode = "directed", weighted = TRUE)
Luch_forward_passes_closeness= centr_clo(Luch_forward_passes_graph, mode='total', normalized = TRUE)
Luch_forward_passes_betw = centralization.betweenness(Luch_forward_passes_graph, normalized =TRUE)
Luch_forward_passes_pagerank= page_rank(Luch_forward_passes_graph, algo ="power", vids = V(Luch_forward_passes_graph), directed = TRUE, weights = E(Luch_forward_passes_graph)$weight)
Luch_forward_passes_closeness = Luch_forward_passes_closeness[['res']]
Luch_forward_passes_betw = Luch_forward_passes_betw[['res']]
Luch_forward_passes_pagerank = Luch_forward_passes_pagerank[["vector"]]
Luch_forward_passes_transitivity = transitivity(Luch_forward_passes_graph,  type="weighted")
Luch_forward_passes_closeness[is.nan(Luch_forward_passes_closeness)] = 0
Luch_forward_passes_betw[is.nan(Luch_forward_passes_betw)] = 0
Luch_forward_passes_pagerank[is.nan(Luch_forward_passes_pagerank)] = 0
Luch_forward_passes_transitivity[is.nan(Luch_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Luch_forward_passes_metrics=cbind(Luch_players,Luch_forward_passes_closeness, Luch_forward_passes_betw,  Luch_forward_passes_pagerank, Luch_forward_passes_transitivity)
colnames(Luch_forward_passes_metrics)[1] = 'Player' 


#back_passes
Luch_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Luch/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Luch_players = Luch_back_passes$X
Luch_back_passes$X = NULL
rownames(Luch_back_passes) = Luch_players
Luch_back_passes_matrix <- as.matrix(Luch_back_passes)
Luch_back_passes_graph = graph_from_adjacency_matrix(Luch_back_passes_matrix, mode = "directed", weighted = TRUE)
Luch_back_passes_closeness= centr_clo(Luch_back_passes_graph, mode='total', normalized = TRUE)
Luch_back_passes_betw = centralization.betweenness(Luch_back_passes_graph, normalized =TRUE)
Luch_back_passes_pagerank= page_rank(Luch_back_passes_graph, algo ="power", vids = V(Luch_back_passes_graph), directed = TRUE, weights = E(Luch_back_passes_graph)$weight)
Luch_back_passes_closeness = Luch_back_passes_closeness[['res']]
Luch_back_passes_betw = Luch_back_passes_betw[['res']]
Luch_back_passes_pagerank = Luch_back_passes_pagerank[["vector"]]
Luch_back_passes_transitivity = transitivity(Luch_back_passes_graph,  type="weighted")
Luch_back_passes_closeness[is.nan(Luch_back_passes_closeness)] = 0
Luch_back_passes_betw[is.nan(Luch_back_passes_betw)] = 0
Luch_back_passes_pagerank[is.nan(Luch_back_passes_pagerank)] = 0
Luch_back_passes_transitivity[is.nan(Luch_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Luch_back_passes_metrics=cbind(Luch_players,Luch_back_passes_closeness, Luch_back_passes_betw,  Luch_back_passes_pagerank, Luch_back_passes_transitivity)
colnames(Luch_back_passes_metrics)[1] = 'Player'  


#long_passes
Luch_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Luch/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Luch_players = Luch_long_passes$X
Luch_long_passes$X = NULL
rownames(Luch_long_passes) = Luch_players
Luch_long_passes_matrix <- as.matrix(Luch_long_passes)
Luch_long_passes_graph = graph_from_adjacency_matrix(Luch_long_passes_matrix, mode = "directed", weighted = TRUE)
Luch_long_passes_closeness= centr_clo(Luch_long_passes_graph, mode='total', normalized = TRUE)
Luch_long_passes_betw = centralization.betweenness(Luch_long_passes_graph, normalized =TRUE)
Luch_long_passes_pagerank= page_rank(Luch_long_passes_graph, algo ="power", vids = V(Luch_long_passes_graph), directed = TRUE, weights = E(Luch_long_passes_graph)$weight)
Luch_long_passes_closeness = Luch_long_passes_closeness[['res']]
Luch_long_passes_betw = Luch_long_passes_betw[['res']]
Luch_long_passes_pagerank = Luch_long_passes_pagerank[["vector"]]
Luch_long_passes_transitivity = transitivity(Luch_long_passes_graph,  type="weighted")
Luch_long_passes_closeness[is.nan(Luch_long_passes_closeness)] = 0
Luch_long_passes_betw[is.nan(Luch_long_passes_betw)] = 0
Luch_long_passes_pagerank[is.nan(Luch_long_passes_pagerank)] = 0
Luch_long_passes_transitivity[is.nan(Luch_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Luch_long_passes_metrics=cbind(Luch_players,Luch_long_passes_closeness, Luch_long_passes_betw,  Luch_long_passes_pagerank, Luch_long_passes_transitivity)
colnames(Luch_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Luch_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Luch/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Luch_players = Luch_final_3rd_passes$X
Luch_final_3rd_passes$X = NULL
rownames(Luch_final_3rd_passes) = Luch_players
Luch_final_3rd_passes_matrix <- as.matrix(Luch_final_3rd_passes)
Luch_final_3rd_passes_graph = graph_from_adjacency_matrix(Luch_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Luch_final_3rd_passes_closeness= centr_clo(Luch_final_3rd_passes_graph, mode='total', normalized = TRUE)
Luch_final_3rd_passes_betw = centralization.betweenness(Luch_final_3rd_passes_graph, normalized =TRUE)
Luch_final_3rd_passes_pagerank= page_rank(Luch_final_3rd_passes_graph, algo ="power", vids = V(Luch_final_3rd_passes_graph), directed = TRUE, weights = E(Luch_final_3rd_passes_graph)$weight)
Luch_final_3rd_passes_closeness = Luch_final_3rd_passes_closeness[['res']]
Luch_final_3rd_passes_betw = Luch_final_3rd_passes_betw[['res']]
Luch_final_3rd_passes_pagerank = Luch_final_3rd_passes_pagerank[["vector"]]
Luch_final_3rd_passes_transitivity = transitivity(Luch_final_3rd_passes_graph,  type="weighted")
Luch_final_3rd_passes_closeness[is.nan(Luch_final_3rd_passes_closeness)] = 0
Luch_final_3rd_passes_betw[is.nan(Luch_final_3rd_passes_betw)] = 0
Luch_final_3rd_passes_pagerank[is.nan(Luch_final_3rd_passes_pagerank)] = 0
Luch_final_3rd_passes_transitivity[is.nan(Luch_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Luch_final_3rd_passes_metrics=cbind(Luch_players,Luch_final_3rd_passes_closeness, Luch_final_3rd_passes_betw,  Luch_final_3rd_passes_pagerank, Luch_final_3rd_passes_transitivity)
colnames(Luch_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Luch_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Luch/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Luch_players = Luch_progressive_passes$X
Luch_progressive_passes$X = NULL
rownames(Luch_progressive_passes) = Luch_players
Luch_progressive_passes_matrix <- as.matrix(Luch_progressive_passes)
Luch_progressive_passes_graph = graph_from_adjacency_matrix(Luch_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Luch_progressive_passes_closeness= centr_clo(Luch_progressive_passes_graph, mode='total', normalized = TRUE)
Luch_progressive_passes_betw = centralization.betweenness(Luch_progressive_passes_graph, normalized =TRUE)
Luch_progressive_passes_pagerank= page_rank(Luch_progressive_passes_graph, algo ="power", vids = V(Luch_progressive_passes_graph), directed = TRUE, weights = E(Luch_progressive_passes_graph)$weight)
Luch_progressive_passes_closeness = Luch_progressive_passes_closeness[['res']]
Luch_progressive_passes_betw = Luch_progressive_passes_betw[['res']]
Luch_progressive_passes_pagerank = Luch_progressive_passes_pagerank[["vector"]]
Luch_progressive_passes_transitivity = transitivity(Luch_progressive_passes_graph,  type="weighted")
Luch_progressive_passes_closeness[is.nan(Luch_progressive_passes_closeness)] = 0
Luch_progressive_passes_betw[is.nan(Luch_progressive_passes_betw)] = 0
Luch_progressive_passes_pagerank[is.nan(Luch_progressive_passes_pagerank)] = 0
Luch_progressive_passes_transitivity[is.nan(Luch_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Luch_progressive_passes_metrics=cbind(Luch_players,Luch_progressive_passes_closeness, Luch_progressive_passes_betw,  Luch_progressive_passes_pagerank, Luch_progressive_passes_transitivity)
colnames(Luch_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Luch_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Luch_total_passes_metrics, 
Luch_forward_passes_metrics,
Luch_back_passes_metrics,
Luch_long_passes_metrics,
Luch_final_3rd_passes_metrics,
Luch_progressive_passes_metrics))



#norm_data
rownames(Luch_all_passing_stats) = Luch_players
Luch_all_passing_stats$Player = NULL
Luch_all_passing_stats = unfactor(Luch_all_passing_stats)
Luch_all_passing_stats_norm =  data.frame(lapply(Luch_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Luch_all_passing_stats_norm) = Luch_players
colnames(Luch_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Luch_all_passing_stats, 'Luch_passing.csv')




Mordovia_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Mordovia/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Mordovia_players = Mordovia_total_passes$X
Mordovia_total_passes$X = NULL
rownames(Mordovia_total_passes) = Mordovia_players
Mordovia_total_passes_matrix <- as.matrix(Mordovia_total_passes)
Mordovia_total_passes_graph = graph_from_adjacency_matrix(Mordovia_total_passes_matrix, mode = "directed", weighted = TRUE)
Mordovia_total_passes_closeness= centr_clo(Mordovia_total_passes_graph, mode='total', normalized = TRUE)
Mordovia_total_passes_betw = centralization.betweenness(Mordovia_total_passes_graph, normalized =TRUE)
Mordovia_total_passes_pagerank= page_rank(Mordovia_total_passes_graph, algo ="power", vids = V(Mordovia_total_passes_graph), directed = TRUE, weights = E(Mordovia_total_passes_graph)$weight)
Mordovia_total_passes_closeness = Mordovia_total_passes_closeness[['res']]
Mordovia_total_passes_betw = Mordovia_total_passes_betw[['res']]
Mordovia_total_passes_pagerank = Mordovia_total_passes_pagerank[["vector"]]
Mordovia_total_passes_transitivity = transitivity(Mordovia_total_passes_graph,  type="weighted")
Mordovia_total_passes_closeness[is.nan(Mordovia_total_passes_closeness)] = 0
Mordovia_total_passes_betw[is.nan(Mordovia_total_passes_betw)] = 0
Mordovia_total_passes_pagerank[is.nan(Mordovia_total_passes_pagerank)] = 0
Mordovia_total_passes_transitivity[is.nan(Mordovia_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Mordovia_total_passes_metrics=cbind(Mordovia_players,Mordovia_total_passes_closeness, Mordovia_total_passes_betw,  Mordovia_total_passes_pagerank, Mordovia_total_passes_transitivity)
colnames(Mordovia_total_passes_metrics)[1] = 'Player' 

#forward_passes
Mordovia_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Mordovia/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Mordovia_players = Mordovia_forward_passes$X
Mordovia_forward_passes$X = NULL
rownames(Mordovia_forward_passes) = Mordovia_players
Mordovia_forward_passes_matrix <- as.matrix(Mordovia_forward_passes)
Mordovia_forward_passes_graph = graph_from_adjacency_matrix(Mordovia_forward_passes_matrix, mode = "directed", weighted = TRUE)
Mordovia_forward_passes_closeness= centr_clo(Mordovia_forward_passes_graph, mode='total', normalized = TRUE)
Mordovia_forward_passes_betw = centralization.betweenness(Mordovia_forward_passes_graph, normalized =TRUE)
Mordovia_forward_passes_pagerank= page_rank(Mordovia_forward_passes_graph, algo ="power", vids = V(Mordovia_forward_passes_graph), directed = TRUE, weights = E(Mordovia_forward_passes_graph)$weight)
Mordovia_forward_passes_closeness = Mordovia_forward_passes_closeness[['res']]
Mordovia_forward_passes_betw = Mordovia_forward_passes_betw[['res']]
Mordovia_forward_passes_pagerank = Mordovia_forward_passes_pagerank[["vector"]]
Mordovia_forward_passes_transitivity = transitivity(Mordovia_forward_passes_graph,  type="weighted")
Mordovia_forward_passes_closeness[is.nan(Mordovia_forward_passes_closeness)] = 0
Mordovia_forward_passes_betw[is.nan(Mordovia_forward_passes_betw)] = 0
Mordovia_forward_passes_pagerank[is.nan(Mordovia_forward_passes_pagerank)] = 0
Mordovia_forward_passes_transitivity[is.nan(Mordovia_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Mordovia_forward_passes_metrics=cbind(Mordovia_players,Mordovia_forward_passes_closeness, Mordovia_forward_passes_betw,  Mordovia_forward_passes_pagerank, Mordovia_forward_passes_transitivity)
colnames(Mordovia_forward_passes_metrics)[1] = 'Player' 


#back_passes
Mordovia_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Mordovia/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Mordovia_players = Mordovia_back_passes$X
Mordovia_back_passes$X = NULL
rownames(Mordovia_back_passes) = Mordovia_players
Mordovia_back_passes_matrix <- as.matrix(Mordovia_back_passes)
Mordovia_back_passes_graph = graph_from_adjacency_matrix(Mordovia_back_passes_matrix, mode = "directed", weighted = TRUE)
Mordovia_back_passes_closeness= centr_clo(Mordovia_back_passes_graph, mode='total', normalized = TRUE)
Mordovia_back_passes_betw = centralization.betweenness(Mordovia_back_passes_graph, normalized =TRUE)
Mordovia_back_passes_pagerank= page_rank(Mordovia_back_passes_graph, algo ="power", vids = V(Mordovia_back_passes_graph), directed = TRUE, weights = E(Mordovia_back_passes_graph)$weight)
Mordovia_back_passes_closeness = Mordovia_back_passes_closeness[['res']]
Mordovia_back_passes_betw = Mordovia_back_passes_betw[['res']]
Mordovia_back_passes_pagerank = Mordovia_back_passes_pagerank[["vector"]]
Mordovia_back_passes_transitivity = transitivity(Mordovia_back_passes_graph,  type="weighted")
Mordovia_back_passes_closeness[is.nan(Mordovia_back_passes_closeness)] = 0
Mordovia_back_passes_betw[is.nan(Mordovia_back_passes_betw)] = 0
Mordovia_back_passes_pagerank[is.nan(Mordovia_back_passes_pagerank)] = 0
Mordovia_back_passes_transitivity[is.nan(Mordovia_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Mordovia_back_passes_metrics=cbind(Mordovia_players,Mordovia_back_passes_closeness, Mordovia_back_passes_betw,  Mordovia_back_passes_pagerank, Mordovia_back_passes_transitivity)
colnames(Mordovia_back_passes_metrics)[1] = 'Player'  


#long_passes
Mordovia_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Mordovia/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Mordovia_players = Mordovia_long_passes$X
Mordovia_long_passes$X = NULL
rownames(Mordovia_long_passes) = Mordovia_players
Mordovia_long_passes_matrix <- as.matrix(Mordovia_long_passes)
Mordovia_long_passes_graph = graph_from_adjacency_matrix(Mordovia_long_passes_matrix, mode = "directed", weighted = TRUE)
Mordovia_long_passes_closeness= centr_clo(Mordovia_long_passes_graph, mode='total', normalized = TRUE)
Mordovia_long_passes_betw = centralization.betweenness(Mordovia_long_passes_graph, normalized =TRUE)
Mordovia_long_passes_pagerank= page_rank(Mordovia_long_passes_graph, algo ="power", vids = V(Mordovia_long_passes_graph), directed = TRUE, weights = E(Mordovia_long_passes_graph)$weight)
Mordovia_long_passes_closeness = Mordovia_long_passes_closeness[['res']]
Mordovia_long_passes_betw = Mordovia_long_passes_betw[['res']]
Mordovia_long_passes_pagerank = Mordovia_long_passes_pagerank[["vector"]]
Mordovia_long_passes_transitivity = transitivity(Mordovia_long_passes_graph,  type="weighted")
Mordovia_long_passes_closeness[is.nan(Mordovia_long_passes_closeness)] = 0
Mordovia_long_passes_betw[is.nan(Mordovia_long_passes_betw)] = 0
Mordovia_long_passes_pagerank[is.nan(Mordovia_long_passes_pagerank)] = 0
Mordovia_long_passes_transitivity[is.nan(Mordovia_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Mordovia_long_passes_metrics=cbind(Mordovia_players,Mordovia_long_passes_closeness, Mordovia_long_passes_betw,  Mordovia_long_passes_pagerank, Mordovia_long_passes_transitivity)
colnames(Mordovia_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Mordovia_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Mordovia/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Mordovia_players = Mordovia_final_3rd_passes$X
Mordovia_final_3rd_passes$X = NULL
rownames(Mordovia_final_3rd_passes) = Mordovia_players
Mordovia_final_3rd_passes_matrix <- as.matrix(Mordovia_final_3rd_passes)
Mordovia_final_3rd_passes_graph = graph_from_adjacency_matrix(Mordovia_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Mordovia_final_3rd_passes_closeness= centr_clo(Mordovia_final_3rd_passes_graph, mode='total', normalized = TRUE)
Mordovia_final_3rd_passes_betw = centralization.betweenness(Mordovia_final_3rd_passes_graph, normalized =TRUE)
Mordovia_final_3rd_passes_pagerank= page_rank(Mordovia_final_3rd_passes_graph, algo ="power", vids = V(Mordovia_final_3rd_passes_graph), directed = TRUE, weights = E(Mordovia_final_3rd_passes_graph)$weight)
Mordovia_final_3rd_passes_closeness = Mordovia_final_3rd_passes_closeness[['res']]
Mordovia_final_3rd_passes_betw = Mordovia_final_3rd_passes_betw[['res']]
Mordovia_final_3rd_passes_pagerank = Mordovia_final_3rd_passes_pagerank[["vector"]]
Mordovia_final_3rd_passes_transitivity = transitivity(Mordovia_final_3rd_passes_graph,  type="weighted")
Mordovia_final_3rd_passes_closeness[is.nan(Mordovia_final_3rd_passes_closeness)] = 0
Mordovia_final_3rd_passes_betw[is.nan(Mordovia_final_3rd_passes_betw)] = 0
Mordovia_final_3rd_passes_pagerank[is.nan(Mordovia_final_3rd_passes_pagerank)] = 0
Mordovia_final_3rd_passes_transitivity[is.nan(Mordovia_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Mordovia_final_3rd_passes_metrics=cbind(Mordovia_players,Mordovia_final_3rd_passes_closeness, Mordovia_final_3rd_passes_betw,  Mordovia_final_3rd_passes_pagerank, Mordovia_final_3rd_passes_transitivity)
colnames(Mordovia_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Mordovia_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Mordovia/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Mordovia_players = Mordovia_progressive_passes$X
Mordovia_progressive_passes$X = NULL
rownames(Mordovia_progressive_passes) = Mordovia_players
Mordovia_progressive_passes_matrix <- as.matrix(Mordovia_progressive_passes)
Mordovia_progressive_passes_graph = graph_from_adjacency_matrix(Mordovia_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Mordovia_progressive_passes_closeness= centr_clo(Mordovia_progressive_passes_graph, mode='total', normalized = TRUE)
Mordovia_progressive_passes_betw = centralization.betweenness(Mordovia_progressive_passes_graph, normalized =TRUE)
Mordovia_progressive_passes_pagerank= page_rank(Mordovia_progressive_passes_graph, algo ="power", vids = V(Mordovia_progressive_passes_graph), directed = TRUE, weights = E(Mordovia_progressive_passes_graph)$weight)
Mordovia_progressive_passes_closeness = Mordovia_progressive_passes_closeness[['res']]
Mordovia_progressive_passes_betw = Mordovia_progressive_passes_betw[['res']]
Mordovia_progressive_passes_pagerank = Mordovia_progressive_passes_pagerank[["vector"]]
Mordovia_progressive_passes_transitivity = transitivity(Mordovia_progressive_passes_graph,  type="weighted")
Mordovia_progressive_passes_closeness[is.nan(Mordovia_progressive_passes_closeness)] = 0
Mordovia_progressive_passes_betw[is.nan(Mordovia_progressive_passes_betw)] = 0
Mordovia_progressive_passes_pagerank[is.nan(Mordovia_progressive_passes_pagerank)] = 0
Mordovia_progressive_passes_transitivity[is.nan(Mordovia_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Mordovia_progressive_passes_metrics=cbind(Mordovia_players,Mordovia_progressive_passes_closeness, Mordovia_progressive_passes_betw,  Mordovia_progressive_passes_pagerank, Mordovia_progressive_passes_transitivity)
colnames(Mordovia_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Mordovia_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Mordovia_total_passes_metrics, 
Mordovia_forward_passes_metrics,
Mordovia_back_passes_metrics,
Mordovia_long_passes_metrics,
Mordovia_final_3rd_passes_metrics,
Mordovia_progressive_passes_metrics))



#norm_data
rownames(Mordovia_all_passing_stats) = Mordovia_players
Mordovia_all_passing_stats$Player = NULL
Mordovia_all_passing_stats = unfactor(Mordovia_all_passing_stats)
Mordovia_all_passing_stats_norm =  data.frame(lapply(Mordovia_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Mordovia_all_passing_stats_norm) = Mordovia_players
colnames(Mordovia_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Mordovia_all_passing_stats, 'Mordovia_passing.csv')


Neftekhimik_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Neftekhimik/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Neftekhimik_players = Neftekhimik_total_passes$X
Neftekhimik_total_passes$X = NULL
rownames(Neftekhimik_total_passes) = Neftekhimik_players
Neftekhimik_total_passes_matrix <- as.matrix(Neftekhimik_total_passes)
Neftekhimik_total_passes_graph = graph_from_adjacency_matrix(Neftekhimik_total_passes_matrix, mode = "directed", weighted = TRUE)
Neftekhimik_total_passes_closeness= centr_clo(Neftekhimik_total_passes_graph, mode='total', normalized = TRUE)
Neftekhimik_total_passes_betw = centralization.betweenness(Neftekhimik_total_passes_graph, normalized =TRUE)
Neftekhimik_total_passes_pagerank= page_rank(Neftekhimik_total_passes_graph, algo ="power", vids = V(Neftekhimik_total_passes_graph), directed = TRUE, weights = E(Neftekhimik_total_passes_graph)$weight)
Neftekhimik_total_passes_closeness = Neftekhimik_total_passes_closeness[['res']]
Neftekhimik_total_passes_betw = Neftekhimik_total_passes_betw[['res']]
Neftekhimik_total_passes_pagerank = Neftekhimik_total_passes_pagerank[["vector"]]
Neftekhimik_total_passes_transitivity = transitivity(Neftekhimik_total_passes_graph,  type="weighted")
Neftekhimik_total_passes_closeness[is.nan(Neftekhimik_total_passes_closeness)] = 0
Neftekhimik_total_passes_betw[is.nan(Neftekhimik_total_passes_betw)] = 0
Neftekhimik_total_passes_pagerank[is.nan(Neftekhimik_total_passes_pagerank)] = 0
Neftekhimik_total_passes_transitivity[is.nan(Neftekhimik_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Neftekhimik_total_passes_metrics=cbind(Neftekhimik_players,Neftekhimik_total_passes_closeness, Neftekhimik_total_passes_betw,  Neftekhimik_total_passes_pagerank, Neftekhimik_total_passes_transitivity)
colnames(Neftekhimik_total_passes_metrics)[1] = 'Player' 

#forward_passes
Neftekhimik_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Neftekhimik/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Neftekhimik_players = Neftekhimik_forward_passes$X
Neftekhimik_forward_passes$X = NULL
rownames(Neftekhimik_forward_passes) = Neftekhimik_players
Neftekhimik_forward_passes_matrix <- as.matrix(Neftekhimik_forward_passes)
Neftekhimik_forward_passes_graph = graph_from_adjacency_matrix(Neftekhimik_forward_passes_matrix, mode = "directed", weighted = TRUE)
Neftekhimik_forward_passes_closeness= centr_clo(Neftekhimik_forward_passes_graph, mode='total', normalized = TRUE)
Neftekhimik_forward_passes_betw = centralization.betweenness(Neftekhimik_forward_passes_graph, normalized =TRUE)
Neftekhimik_forward_passes_pagerank= page_rank(Neftekhimik_forward_passes_graph, algo ="power", vids = V(Neftekhimik_forward_passes_graph), directed = TRUE, weights = E(Neftekhimik_forward_passes_graph)$weight)
Neftekhimik_forward_passes_closeness = Neftekhimik_forward_passes_closeness[['res']]
Neftekhimik_forward_passes_betw = Neftekhimik_forward_passes_betw[['res']]
Neftekhimik_forward_passes_pagerank = Neftekhimik_forward_passes_pagerank[["vector"]]
Neftekhimik_forward_passes_transitivity = transitivity(Neftekhimik_forward_passes_graph,  type="weighted")
Neftekhimik_forward_passes_closeness[is.nan(Neftekhimik_forward_passes_closeness)] = 0
Neftekhimik_forward_passes_betw[is.nan(Neftekhimik_forward_passes_betw)] = 0
Neftekhimik_forward_passes_pagerank[is.nan(Neftekhimik_forward_passes_pagerank)] = 0
Neftekhimik_forward_passes_transitivity[is.nan(Neftekhimik_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Neftekhimik_forward_passes_metrics=cbind(Neftekhimik_players,Neftekhimik_forward_passes_closeness, Neftekhimik_forward_passes_betw,  Neftekhimik_forward_passes_pagerank, Neftekhimik_forward_passes_transitivity)
colnames(Neftekhimik_forward_passes_metrics)[1] = 'Player' 


#back_passes
Neftekhimik_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Neftekhimik/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Neftekhimik_players = Neftekhimik_back_passes$X
Neftekhimik_back_passes$X = NULL
rownames(Neftekhimik_back_passes) = Neftekhimik_players
Neftekhimik_back_passes_matrix <- as.matrix(Neftekhimik_back_passes)
Neftekhimik_back_passes_graph = graph_from_adjacency_matrix(Neftekhimik_back_passes_matrix, mode = "directed", weighted = TRUE)
Neftekhimik_back_passes_closeness= centr_clo(Neftekhimik_back_passes_graph, mode='total', normalized = TRUE)
Neftekhimik_back_passes_betw = centralization.betweenness(Neftekhimik_back_passes_graph, normalized =TRUE)
Neftekhimik_back_passes_pagerank= page_rank(Neftekhimik_back_passes_graph, algo ="power", vids = V(Neftekhimik_back_passes_graph), directed = TRUE, weights = E(Neftekhimik_back_passes_graph)$weight)
Neftekhimik_back_passes_closeness = Neftekhimik_back_passes_closeness[['res']]
Neftekhimik_back_passes_betw = Neftekhimik_back_passes_betw[['res']]
Neftekhimik_back_passes_pagerank = Neftekhimik_back_passes_pagerank[["vector"]]
Neftekhimik_back_passes_transitivity = transitivity(Neftekhimik_back_passes_graph,  type="weighted")
Neftekhimik_back_passes_closeness[is.nan(Neftekhimik_back_passes_closeness)] = 0
Neftekhimik_back_passes_betw[is.nan(Neftekhimik_back_passes_betw)] = 0
Neftekhimik_back_passes_pagerank[is.nan(Neftekhimik_back_passes_pagerank)] = 0
Neftekhimik_back_passes_transitivity[is.nan(Neftekhimik_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Neftekhimik_back_passes_metrics=cbind(Neftekhimik_players,Neftekhimik_back_passes_closeness, Neftekhimik_back_passes_betw,  Neftekhimik_back_passes_pagerank, Neftekhimik_back_passes_transitivity)
colnames(Neftekhimik_back_passes_metrics)[1] = 'Player'  


#long_passes
Neftekhimik_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Neftekhimik/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Neftekhimik_players = Neftekhimik_long_passes$X
Neftekhimik_long_passes$X = NULL
rownames(Neftekhimik_long_passes) = Neftekhimik_players
Neftekhimik_long_passes_matrix <- as.matrix(Neftekhimik_long_passes)
Neftekhimik_long_passes_graph = graph_from_adjacency_matrix(Neftekhimik_long_passes_matrix, mode = "directed", weighted = TRUE)
Neftekhimik_long_passes_closeness= centr_clo(Neftekhimik_long_passes_graph, mode='total', normalized = TRUE)
Neftekhimik_long_passes_betw = centralization.betweenness(Neftekhimik_long_passes_graph, normalized =TRUE)
Neftekhimik_long_passes_pagerank= page_rank(Neftekhimik_long_passes_graph, algo ="power", vids = V(Neftekhimik_long_passes_graph), directed = TRUE, weights = E(Neftekhimik_long_passes_graph)$weight)
Neftekhimik_long_passes_closeness = Neftekhimik_long_passes_closeness[['res']]
Neftekhimik_long_passes_betw = Neftekhimik_long_passes_betw[['res']]
Neftekhimik_long_passes_pagerank = Neftekhimik_long_passes_pagerank[["vector"]]
Neftekhimik_long_passes_transitivity = transitivity(Neftekhimik_long_passes_graph,  type="weighted")
Neftekhimik_long_passes_closeness[is.nan(Neftekhimik_long_passes_closeness)] = 0
Neftekhimik_long_passes_betw[is.nan(Neftekhimik_long_passes_betw)] = 0
Neftekhimik_long_passes_pagerank[is.nan(Neftekhimik_long_passes_pagerank)] = 0
Neftekhimik_long_passes_transitivity[is.nan(Neftekhimik_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Neftekhimik_long_passes_metrics=cbind(Neftekhimik_players,Neftekhimik_long_passes_closeness, Neftekhimik_long_passes_betw,  Neftekhimik_long_passes_pagerank, Neftekhimik_long_passes_transitivity)
colnames(Neftekhimik_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Neftekhimik_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Neftekhimik/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Neftekhimik_players = Neftekhimik_final_3rd_passes$X
Neftekhimik_final_3rd_passes$X = NULL
rownames(Neftekhimik_final_3rd_passes) = Neftekhimik_players
Neftekhimik_final_3rd_passes_matrix <- as.matrix(Neftekhimik_final_3rd_passes)
Neftekhimik_final_3rd_passes_graph = graph_from_adjacency_matrix(Neftekhimik_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Neftekhimik_final_3rd_passes_closeness= centr_clo(Neftekhimik_final_3rd_passes_graph, mode='total', normalized = TRUE)
Neftekhimik_final_3rd_passes_betw = centralization.betweenness(Neftekhimik_final_3rd_passes_graph, normalized =TRUE)
Neftekhimik_final_3rd_passes_pagerank= page_rank(Neftekhimik_final_3rd_passes_graph, algo ="power", vids = V(Neftekhimik_final_3rd_passes_graph), directed = TRUE, weights = E(Neftekhimik_final_3rd_passes_graph)$weight)
Neftekhimik_final_3rd_passes_closeness = Neftekhimik_final_3rd_passes_closeness[['res']]
Neftekhimik_final_3rd_passes_betw = Neftekhimik_final_3rd_passes_betw[['res']]
Neftekhimik_final_3rd_passes_pagerank = Neftekhimik_final_3rd_passes_pagerank[["vector"]]
Neftekhimik_final_3rd_passes_transitivity = transitivity(Neftekhimik_final_3rd_passes_graph,  type="weighted")
Neftekhimik_final_3rd_passes_closeness[is.nan(Neftekhimik_final_3rd_passes_closeness)] = 0
Neftekhimik_final_3rd_passes_betw[is.nan(Neftekhimik_final_3rd_passes_betw)] = 0
Neftekhimik_final_3rd_passes_pagerank[is.nan(Neftekhimik_final_3rd_passes_pagerank)] = 0
Neftekhimik_final_3rd_passes_transitivity[is.nan(Neftekhimik_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Neftekhimik_final_3rd_passes_metrics=cbind(Neftekhimik_players,Neftekhimik_final_3rd_passes_closeness, Neftekhimik_final_3rd_passes_betw,  Neftekhimik_final_3rd_passes_pagerank, Neftekhimik_final_3rd_passes_transitivity)
colnames(Neftekhimik_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Neftekhimik_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Neftekhimik/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Neftekhimik_players = Neftekhimik_progressive_passes$X
Neftekhimik_progressive_passes$X = NULL
rownames(Neftekhimik_progressive_passes) = Neftekhimik_players
Neftekhimik_progressive_passes_matrix <- as.matrix(Neftekhimik_progressive_passes)
Neftekhimik_progressive_passes_graph = graph_from_adjacency_matrix(Neftekhimik_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Neftekhimik_progressive_passes_closeness= centr_clo(Neftekhimik_progressive_passes_graph, mode='total', normalized = TRUE)
Neftekhimik_progressive_passes_betw = centralization.betweenness(Neftekhimik_progressive_passes_graph, normalized =TRUE)
Neftekhimik_progressive_passes_pagerank= page_rank(Neftekhimik_progressive_passes_graph, algo ="power", vids = V(Neftekhimik_progressive_passes_graph), directed = TRUE, weights = E(Neftekhimik_progressive_passes_graph)$weight)
Neftekhimik_progressive_passes_closeness = Neftekhimik_progressive_passes_closeness[['res']]
Neftekhimik_progressive_passes_betw = Neftekhimik_progressive_passes_betw[['res']]
Neftekhimik_progressive_passes_pagerank = Neftekhimik_progressive_passes_pagerank[["vector"]]
Neftekhimik_progressive_passes_transitivity = transitivity(Neftekhimik_progressive_passes_graph,  type="weighted")
Neftekhimik_progressive_passes_closeness[is.nan(Neftekhimik_progressive_passes_closeness)] = 0
Neftekhimik_progressive_passes_betw[is.nan(Neftekhimik_progressive_passes_betw)] = 0
Neftekhimik_progressive_passes_pagerank[is.nan(Neftekhimik_progressive_passes_pagerank)] = 0
Neftekhimik_progressive_passes_transitivity[is.nan(Neftekhimik_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Neftekhimik_progressive_passes_metrics=cbind(Neftekhimik_players,Neftekhimik_progressive_passes_closeness, Neftekhimik_progressive_passes_betw,  Neftekhimik_progressive_passes_pagerank, Neftekhimik_progressive_passes_transitivity)
colnames(Neftekhimik_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Neftekhimik_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Neftekhimik_total_passes_metrics, 
Neftekhimik_forward_passes_metrics,
Neftekhimik_back_passes_metrics,
Neftekhimik_long_passes_metrics,
Neftekhimik_final_3rd_passes_metrics,
Neftekhimik_progressive_passes_metrics))



#norm_data
rownames(Neftekhimik_all_passing_stats) = Neftekhimik_players
Neftekhimik_all_passing_stats$Player = NULL
Neftekhimik_all_passing_stats = unfactor(Neftekhimik_all_passing_stats)
Neftekhimik_all_passing_stats_norm =  data.frame(lapply(Neftekhimik_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Neftekhimik_all_passing_stats_norm) = Neftekhimik_players
colnames(Neftekhimik_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Neftekhimik_all_passing_stats, 'Neftekhimik_passing.csv')


NizhnyNovgorod_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/NizhnyNovgorod/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
NizhnyNovgorod_players = NizhnyNovgorod_total_passes$X
NizhnyNovgorod_total_passes$X = NULL
rownames(NizhnyNovgorod_total_passes) = NizhnyNovgorod_players
NizhnyNovgorod_total_passes_matrix <- as.matrix(NizhnyNovgorod_total_passes)
NizhnyNovgorod_total_passes_graph = graph_from_adjacency_matrix(NizhnyNovgorod_total_passes_matrix, mode = "directed", weighted = TRUE)
NizhnyNovgorod_total_passes_closeness= centr_clo(NizhnyNovgorod_total_passes_graph, mode='total', normalized = TRUE)
NizhnyNovgorod_total_passes_betw = centralization.betweenness(NizhnyNovgorod_total_passes_graph, normalized =TRUE)
NizhnyNovgorod_total_passes_pagerank= page_rank(NizhnyNovgorod_total_passes_graph, algo ="power", vids = V(NizhnyNovgorod_total_passes_graph), directed = TRUE, weights = E(NizhnyNovgorod_total_passes_graph)$weight)
NizhnyNovgorod_total_passes_closeness = NizhnyNovgorod_total_passes_closeness[['res']]
NizhnyNovgorod_total_passes_betw = NizhnyNovgorod_total_passes_betw[['res']]
NizhnyNovgorod_total_passes_pagerank = NizhnyNovgorod_total_passes_pagerank[["vector"]]
NizhnyNovgorod_total_passes_transitivity = transitivity(NizhnyNovgorod_total_passes_graph,  type="weighted")
NizhnyNovgorod_total_passes_closeness[is.nan(NizhnyNovgorod_total_passes_closeness)] = 0
NizhnyNovgorod_total_passes_betw[is.nan(NizhnyNovgorod_total_passes_betw)] = 0
NizhnyNovgorod_total_passes_pagerank[is.nan(NizhnyNovgorod_total_passes_pagerank)] = 0
NizhnyNovgorod_total_passes_transitivity[is.nan(NizhnyNovgorod_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
NizhnyNovgorod_total_passes_metrics=cbind(NizhnyNovgorod_players,NizhnyNovgorod_total_passes_closeness, NizhnyNovgorod_total_passes_betw,  NizhnyNovgorod_total_passes_pagerank, NizhnyNovgorod_total_passes_transitivity)
colnames(NizhnyNovgorod_total_passes_metrics)[1] = 'Player' 

#forward_passes
NizhnyNovgorod_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/NizhnyNovgorod/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
NizhnyNovgorod_players = NizhnyNovgorod_forward_passes$X
NizhnyNovgorod_forward_passes$X = NULL
rownames(NizhnyNovgorod_forward_passes) = NizhnyNovgorod_players
NizhnyNovgorod_forward_passes_matrix <- as.matrix(NizhnyNovgorod_forward_passes)
NizhnyNovgorod_forward_passes_graph = graph_from_adjacency_matrix(NizhnyNovgorod_forward_passes_matrix, mode = "directed", weighted = TRUE)
NizhnyNovgorod_forward_passes_closeness= centr_clo(NizhnyNovgorod_forward_passes_graph, mode='total', normalized = TRUE)
NizhnyNovgorod_forward_passes_betw = centralization.betweenness(NizhnyNovgorod_forward_passes_graph, normalized =TRUE)
NizhnyNovgorod_forward_passes_pagerank= page_rank(NizhnyNovgorod_forward_passes_graph, algo ="power", vids = V(NizhnyNovgorod_forward_passes_graph), directed = TRUE, weights = E(NizhnyNovgorod_forward_passes_graph)$weight)
NizhnyNovgorod_forward_passes_closeness = NizhnyNovgorod_forward_passes_closeness[['res']]
NizhnyNovgorod_forward_passes_betw = NizhnyNovgorod_forward_passes_betw[['res']]
NizhnyNovgorod_forward_passes_pagerank = NizhnyNovgorod_forward_passes_pagerank[["vector"]]
NizhnyNovgorod_forward_passes_transitivity = transitivity(NizhnyNovgorod_forward_passes_graph,  type="weighted")
NizhnyNovgorod_forward_passes_closeness[is.nan(NizhnyNovgorod_forward_passes_closeness)] = 0
NizhnyNovgorod_forward_passes_betw[is.nan(NizhnyNovgorod_forward_passes_betw)] = 0
NizhnyNovgorod_forward_passes_pagerank[is.nan(NizhnyNovgorod_forward_passes_pagerank)] = 0
NizhnyNovgorod_forward_passes_transitivity[is.nan(NizhnyNovgorod_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
NizhnyNovgorod_forward_passes_metrics=cbind(NizhnyNovgorod_players,NizhnyNovgorod_forward_passes_closeness, NizhnyNovgorod_forward_passes_betw,  NizhnyNovgorod_forward_passes_pagerank, NizhnyNovgorod_forward_passes_transitivity)
colnames(NizhnyNovgorod_forward_passes_metrics)[1] = 'Player' 


#back_passes
NizhnyNovgorod_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/NizhnyNovgorod/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
NizhnyNovgorod_players = NizhnyNovgorod_back_passes$X
NizhnyNovgorod_back_passes$X = NULL
rownames(NizhnyNovgorod_back_passes) = NizhnyNovgorod_players
NizhnyNovgorod_back_passes_matrix <- as.matrix(NizhnyNovgorod_back_passes)
NizhnyNovgorod_back_passes_graph = graph_from_adjacency_matrix(NizhnyNovgorod_back_passes_matrix, mode = "directed", weighted = TRUE)
NizhnyNovgorod_back_passes_closeness= centr_clo(NizhnyNovgorod_back_passes_graph, mode='total', normalized = TRUE)
NizhnyNovgorod_back_passes_betw = centralization.betweenness(NizhnyNovgorod_back_passes_graph, normalized =TRUE)
NizhnyNovgorod_back_passes_pagerank= page_rank(NizhnyNovgorod_back_passes_graph, algo ="power", vids = V(NizhnyNovgorod_back_passes_graph), directed = TRUE, weights = E(NizhnyNovgorod_back_passes_graph)$weight)
NizhnyNovgorod_back_passes_closeness = NizhnyNovgorod_back_passes_closeness[['res']]
NizhnyNovgorod_back_passes_betw = NizhnyNovgorod_back_passes_betw[['res']]
NizhnyNovgorod_back_passes_pagerank = NizhnyNovgorod_back_passes_pagerank[["vector"]]
NizhnyNovgorod_back_passes_transitivity = transitivity(NizhnyNovgorod_back_passes_graph,  type="weighted")
NizhnyNovgorod_back_passes_closeness[is.nan(NizhnyNovgorod_back_passes_closeness)] = 0
NizhnyNovgorod_back_passes_betw[is.nan(NizhnyNovgorod_back_passes_betw)] = 0
NizhnyNovgorod_back_passes_pagerank[is.nan(NizhnyNovgorod_back_passes_pagerank)] = 0
NizhnyNovgorod_back_passes_transitivity[is.nan(NizhnyNovgorod_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
NizhnyNovgorod_back_passes_metrics=cbind(NizhnyNovgorod_players,NizhnyNovgorod_back_passes_closeness, NizhnyNovgorod_back_passes_betw,  NizhnyNovgorod_back_passes_pagerank, NizhnyNovgorod_back_passes_transitivity)
colnames(NizhnyNovgorod_back_passes_metrics)[1] = 'Player'  


#long_passes
NizhnyNovgorod_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/NizhnyNovgorod/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
NizhnyNovgorod_players = NizhnyNovgorod_long_passes$X
NizhnyNovgorod_long_passes$X = NULL
rownames(NizhnyNovgorod_long_passes) = NizhnyNovgorod_players
NizhnyNovgorod_long_passes_matrix <- as.matrix(NizhnyNovgorod_long_passes)
NizhnyNovgorod_long_passes_graph = graph_from_adjacency_matrix(NizhnyNovgorod_long_passes_matrix, mode = "directed", weighted = TRUE)
NizhnyNovgorod_long_passes_closeness= centr_clo(NizhnyNovgorod_long_passes_graph, mode='total', normalized = TRUE)
NizhnyNovgorod_long_passes_betw = centralization.betweenness(NizhnyNovgorod_long_passes_graph, normalized =TRUE)
NizhnyNovgorod_long_passes_pagerank= page_rank(NizhnyNovgorod_long_passes_graph, algo ="power", vids = V(NizhnyNovgorod_long_passes_graph), directed = TRUE, weights = E(NizhnyNovgorod_long_passes_graph)$weight)
NizhnyNovgorod_long_passes_closeness = NizhnyNovgorod_long_passes_closeness[['res']]
NizhnyNovgorod_long_passes_betw = NizhnyNovgorod_long_passes_betw[['res']]
NizhnyNovgorod_long_passes_pagerank = NizhnyNovgorod_long_passes_pagerank[["vector"]]
NizhnyNovgorod_long_passes_transitivity = transitivity(NizhnyNovgorod_long_passes_graph,  type="weighted")
NizhnyNovgorod_long_passes_closeness[is.nan(NizhnyNovgorod_long_passes_closeness)] = 0
NizhnyNovgorod_long_passes_betw[is.nan(NizhnyNovgorod_long_passes_betw)] = 0
NizhnyNovgorod_long_passes_pagerank[is.nan(NizhnyNovgorod_long_passes_pagerank)] = 0
NizhnyNovgorod_long_passes_transitivity[is.nan(NizhnyNovgorod_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
NizhnyNovgorod_long_passes_metrics=cbind(NizhnyNovgorod_players,NizhnyNovgorod_long_passes_closeness, NizhnyNovgorod_long_passes_betw,  NizhnyNovgorod_long_passes_pagerank, NizhnyNovgorod_long_passes_transitivity)
colnames(NizhnyNovgorod_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
NizhnyNovgorod_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/NizhnyNovgorod/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
NizhnyNovgorod_players = NizhnyNovgorod_final_3rd_passes$X
NizhnyNovgorod_final_3rd_passes$X = NULL
rownames(NizhnyNovgorod_final_3rd_passes) = NizhnyNovgorod_players
NizhnyNovgorod_final_3rd_passes_matrix <- as.matrix(NizhnyNovgorod_final_3rd_passes)
NizhnyNovgorod_final_3rd_passes_graph = graph_from_adjacency_matrix(NizhnyNovgorod_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
NizhnyNovgorod_final_3rd_passes_closeness= centr_clo(NizhnyNovgorod_final_3rd_passes_graph, mode='total', normalized = TRUE)
NizhnyNovgorod_final_3rd_passes_betw = centralization.betweenness(NizhnyNovgorod_final_3rd_passes_graph, normalized =TRUE)
NizhnyNovgorod_final_3rd_passes_pagerank= page_rank(NizhnyNovgorod_final_3rd_passes_graph, algo ="power", vids = V(NizhnyNovgorod_final_3rd_passes_graph), directed = TRUE, weights = E(NizhnyNovgorod_final_3rd_passes_graph)$weight)
NizhnyNovgorod_final_3rd_passes_closeness = NizhnyNovgorod_final_3rd_passes_closeness[['res']]
NizhnyNovgorod_final_3rd_passes_betw = NizhnyNovgorod_final_3rd_passes_betw[['res']]
NizhnyNovgorod_final_3rd_passes_pagerank = NizhnyNovgorod_final_3rd_passes_pagerank[["vector"]]
NizhnyNovgorod_final_3rd_passes_transitivity = transitivity(NizhnyNovgorod_final_3rd_passes_graph,  type="weighted")
NizhnyNovgorod_final_3rd_passes_closeness[is.nan(NizhnyNovgorod_final_3rd_passes_closeness)] = 0
NizhnyNovgorod_final_3rd_passes_betw[is.nan(NizhnyNovgorod_final_3rd_passes_betw)] = 0
NizhnyNovgorod_final_3rd_passes_pagerank[is.nan(NizhnyNovgorod_final_3rd_passes_pagerank)] = 0
NizhnyNovgorod_final_3rd_passes_transitivity[is.nan(NizhnyNovgorod_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
NizhnyNovgorod_final_3rd_passes_metrics=cbind(NizhnyNovgorod_players,NizhnyNovgorod_final_3rd_passes_closeness, NizhnyNovgorod_final_3rd_passes_betw,  NizhnyNovgorod_final_3rd_passes_pagerank, NizhnyNovgorod_final_3rd_passes_transitivity)
colnames(NizhnyNovgorod_final_3rd_passes_metrics)[1] = 'Player'



#progressive
NizhnyNovgorod_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/NizhnyNovgorod/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
NizhnyNovgorod_players = NizhnyNovgorod_progressive_passes$X
NizhnyNovgorod_progressive_passes$X = NULL
rownames(NizhnyNovgorod_progressive_passes) = NizhnyNovgorod_players
NizhnyNovgorod_progressive_passes_matrix <- as.matrix(NizhnyNovgorod_progressive_passes)
NizhnyNovgorod_progressive_passes_graph = graph_from_adjacency_matrix(NizhnyNovgorod_progressive_passes_matrix, mode = "directed", weighted = TRUE)
NizhnyNovgorod_progressive_passes_closeness= centr_clo(NizhnyNovgorod_progressive_passes_graph, mode='total', normalized = TRUE)
NizhnyNovgorod_progressive_passes_betw = centralization.betweenness(NizhnyNovgorod_progressive_passes_graph, normalized =TRUE)
NizhnyNovgorod_progressive_passes_pagerank= page_rank(NizhnyNovgorod_progressive_passes_graph, algo ="power", vids = V(NizhnyNovgorod_progressive_passes_graph), directed = TRUE, weights = E(NizhnyNovgorod_progressive_passes_graph)$weight)
NizhnyNovgorod_progressive_passes_closeness = NizhnyNovgorod_progressive_passes_closeness[['res']]
NizhnyNovgorod_progressive_passes_betw = NizhnyNovgorod_progressive_passes_betw[['res']]
NizhnyNovgorod_progressive_passes_pagerank = NizhnyNovgorod_progressive_passes_pagerank[["vector"]]
NizhnyNovgorod_progressive_passes_transitivity = transitivity(NizhnyNovgorod_progressive_passes_graph,  type="weighted")
NizhnyNovgorod_progressive_passes_closeness[is.nan(NizhnyNovgorod_progressive_passes_closeness)] = 0
NizhnyNovgorod_progressive_passes_betw[is.nan(NizhnyNovgorod_progressive_passes_betw)] = 0
NizhnyNovgorod_progressive_passes_pagerank[is.nan(NizhnyNovgorod_progressive_passes_pagerank)] = 0
NizhnyNovgorod_progressive_passes_transitivity[is.nan(NizhnyNovgorod_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
NizhnyNovgorod_progressive_passes_metrics=cbind(NizhnyNovgorod_players,NizhnyNovgorod_progressive_passes_closeness, NizhnyNovgorod_progressive_passes_betw,  NizhnyNovgorod_progressive_passes_pagerank, NizhnyNovgorod_progressive_passes_transitivity)
colnames(NizhnyNovgorod_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
NizhnyNovgorod_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
NizhnyNovgorod_total_passes_metrics, 
NizhnyNovgorod_forward_passes_metrics,
NizhnyNovgorod_back_passes_metrics,
NizhnyNovgorod_long_passes_metrics,
NizhnyNovgorod_final_3rd_passes_metrics,
NizhnyNovgorod_progressive_passes_metrics))



#norm_data
rownames(NizhnyNovgorod_all_passing_stats) = NizhnyNovgorod_players
NizhnyNovgorod_all_passing_stats$Player = NULL
NizhnyNovgorod_all_passing_stats = unfactor(NizhnyNovgorod_all_passing_stats)
NizhnyNovgorod_all_passing_stats_norm =  data.frame(lapply(NizhnyNovgorod_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(NizhnyNovgorod_all_passing_stats_norm) = NizhnyNovgorod_players
colnames(NizhnyNovgorod_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(NizhnyNovgorod_all_passing_stats, 'NizhnyNovgorod_passing.csv')



Rotor_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Rotor/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Rotor_players = Rotor_total_passes$X
Rotor_total_passes$X = NULL
rownames(Rotor_total_passes) = Rotor_players
Rotor_total_passes_matrix <- as.matrix(Rotor_total_passes)
Rotor_total_passes_graph = graph_from_adjacency_matrix(Rotor_total_passes_matrix, mode = "directed", weighted = TRUE)
Rotor_total_passes_closeness= centr_clo(Rotor_total_passes_graph, mode='total', normalized = TRUE)
Rotor_total_passes_betw = centralization.betweenness(Rotor_total_passes_graph, normalized =TRUE)
Rotor_total_passes_pagerank= page_rank(Rotor_total_passes_graph, algo ="power", vids = V(Rotor_total_passes_graph), directed = TRUE, weights = E(Rotor_total_passes_graph)$weight)
Rotor_total_passes_closeness = Rotor_total_passes_closeness[['res']]
Rotor_total_passes_betw = Rotor_total_passes_betw[['res']]
Rotor_total_passes_pagerank = Rotor_total_passes_pagerank[["vector"]]
Rotor_total_passes_transitivity = transitivity(Rotor_total_passes_graph,  type="weighted")
Rotor_total_passes_closeness[is.nan(Rotor_total_passes_closeness)] = 0
Rotor_total_passes_betw[is.nan(Rotor_total_passes_betw)] = 0
Rotor_total_passes_pagerank[is.nan(Rotor_total_passes_pagerank)] = 0
Rotor_total_passes_transitivity[is.nan(Rotor_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Rotor_total_passes_metrics=cbind(Rotor_players,Rotor_total_passes_closeness, Rotor_total_passes_betw,  Rotor_total_passes_pagerank, Rotor_total_passes_transitivity)
colnames(Rotor_total_passes_metrics)[1] = 'Player' 

#forward_passes
Rotor_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Rotor/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Rotor_players = Rotor_forward_passes$X
Rotor_forward_passes$X = NULL
rownames(Rotor_forward_passes) = Rotor_players
Rotor_forward_passes_matrix <- as.matrix(Rotor_forward_passes)
Rotor_forward_passes_graph = graph_from_adjacency_matrix(Rotor_forward_passes_matrix, mode = "directed", weighted = TRUE)
Rotor_forward_passes_closeness= centr_clo(Rotor_forward_passes_graph, mode='total', normalized = TRUE)
Rotor_forward_passes_betw = centralization.betweenness(Rotor_forward_passes_graph, normalized =TRUE)
Rotor_forward_passes_pagerank= page_rank(Rotor_forward_passes_graph, algo ="power", vids = V(Rotor_forward_passes_graph), directed = TRUE, weights = E(Rotor_forward_passes_graph)$weight)
Rotor_forward_passes_closeness = Rotor_forward_passes_closeness[['res']]
Rotor_forward_passes_betw = Rotor_forward_passes_betw[['res']]
Rotor_forward_passes_pagerank = Rotor_forward_passes_pagerank[["vector"]]
Rotor_forward_passes_transitivity = transitivity(Rotor_forward_passes_graph,  type="weighted")
Rotor_forward_passes_closeness[is.nan(Rotor_forward_passes_closeness)] = 0
Rotor_forward_passes_betw[is.nan(Rotor_forward_passes_betw)] = 0
Rotor_forward_passes_pagerank[is.nan(Rotor_forward_passes_pagerank)] = 0
Rotor_forward_passes_transitivity[is.nan(Rotor_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Rotor_forward_passes_metrics=cbind(Rotor_players,Rotor_forward_passes_closeness, Rotor_forward_passes_betw,  Rotor_forward_passes_pagerank, Rotor_forward_passes_transitivity)
colnames(Rotor_forward_passes_metrics)[1] = 'Player' 


#back_passes
Rotor_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Rotor/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Rotor_players = Rotor_back_passes$X
Rotor_back_passes$X = NULL
rownames(Rotor_back_passes) = Rotor_players
Rotor_back_passes_matrix <- as.matrix(Rotor_back_passes)
Rotor_back_passes_graph = graph_from_adjacency_matrix(Rotor_back_passes_matrix, mode = "directed", weighted = TRUE)
Rotor_back_passes_closeness= centr_clo(Rotor_back_passes_graph, mode='total', normalized = TRUE)
Rotor_back_passes_betw = centralization.betweenness(Rotor_back_passes_graph, normalized =TRUE)
Rotor_back_passes_pagerank= page_rank(Rotor_back_passes_graph, algo ="power", vids = V(Rotor_back_passes_graph), directed = TRUE, weights = E(Rotor_back_passes_graph)$weight)
Rotor_back_passes_closeness = Rotor_back_passes_closeness[['res']]
Rotor_back_passes_betw = Rotor_back_passes_betw[['res']]
Rotor_back_passes_pagerank = Rotor_back_passes_pagerank[["vector"]]
Rotor_back_passes_transitivity = transitivity(Rotor_back_passes_graph,  type="weighted")
Rotor_back_passes_closeness[is.nan(Rotor_back_passes_closeness)] = 0
Rotor_back_passes_betw[is.nan(Rotor_back_passes_betw)] = 0
Rotor_back_passes_pagerank[is.nan(Rotor_back_passes_pagerank)] = 0
Rotor_back_passes_transitivity[is.nan(Rotor_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Rotor_back_passes_metrics=cbind(Rotor_players,Rotor_back_passes_closeness, Rotor_back_passes_betw,  Rotor_back_passes_pagerank, Rotor_back_passes_transitivity)
colnames(Rotor_back_passes_metrics)[1] = 'Player'  


#long_passes
Rotor_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Rotor/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Rotor_players = Rotor_long_passes$X
Rotor_long_passes$X = NULL
rownames(Rotor_long_passes) = Rotor_players
Rotor_long_passes_matrix <- as.matrix(Rotor_long_passes)
Rotor_long_passes_graph = graph_from_adjacency_matrix(Rotor_long_passes_matrix, mode = "directed", weighted = TRUE)
Rotor_long_passes_closeness= centr_clo(Rotor_long_passes_graph, mode='total', normalized = TRUE)
Rotor_long_passes_betw = centralization.betweenness(Rotor_long_passes_graph, normalized =TRUE)
Rotor_long_passes_pagerank= page_rank(Rotor_long_passes_graph, algo ="power", vids = V(Rotor_long_passes_graph), directed = TRUE, weights = E(Rotor_long_passes_graph)$weight)
Rotor_long_passes_closeness = Rotor_long_passes_closeness[['res']]
Rotor_long_passes_betw = Rotor_long_passes_betw[['res']]
Rotor_long_passes_pagerank = Rotor_long_passes_pagerank[["vector"]]
Rotor_long_passes_transitivity = transitivity(Rotor_long_passes_graph,  type="weighted")
Rotor_long_passes_closeness[is.nan(Rotor_long_passes_closeness)] = 0
Rotor_long_passes_betw[is.nan(Rotor_long_passes_betw)] = 0
Rotor_long_passes_pagerank[is.nan(Rotor_long_passes_pagerank)] = 0
Rotor_long_passes_transitivity[is.nan(Rotor_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Rotor_long_passes_metrics=cbind(Rotor_players,Rotor_long_passes_closeness, Rotor_long_passes_betw,  Rotor_long_passes_pagerank, Rotor_long_passes_transitivity)
colnames(Rotor_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Rotor_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Rotor/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Rotor_players = Rotor_final_3rd_passes$X
Rotor_final_3rd_passes$X = NULL
rownames(Rotor_final_3rd_passes) = Rotor_players
Rotor_final_3rd_passes_matrix <- as.matrix(Rotor_final_3rd_passes)
Rotor_final_3rd_passes_graph = graph_from_adjacency_matrix(Rotor_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Rotor_final_3rd_passes_closeness= centr_clo(Rotor_final_3rd_passes_graph, mode='total', normalized = TRUE)
Rotor_final_3rd_passes_betw = centralization.betweenness(Rotor_final_3rd_passes_graph, normalized =TRUE)
Rotor_final_3rd_passes_pagerank= page_rank(Rotor_final_3rd_passes_graph, algo ="power", vids = V(Rotor_final_3rd_passes_graph), directed = TRUE, weights = E(Rotor_final_3rd_passes_graph)$weight)
Rotor_final_3rd_passes_closeness = Rotor_final_3rd_passes_closeness[['res']]
Rotor_final_3rd_passes_betw = Rotor_final_3rd_passes_betw[['res']]
Rotor_final_3rd_passes_pagerank = Rotor_final_3rd_passes_pagerank[["vector"]]
Rotor_final_3rd_passes_transitivity = transitivity(Rotor_final_3rd_passes_graph,  type="weighted")
Rotor_final_3rd_passes_closeness[is.nan(Rotor_final_3rd_passes_closeness)] = 0
Rotor_final_3rd_passes_betw[is.nan(Rotor_final_3rd_passes_betw)] = 0
Rotor_final_3rd_passes_pagerank[is.nan(Rotor_final_3rd_passes_pagerank)] = 0
Rotor_final_3rd_passes_transitivity[is.nan(Rotor_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Rotor_final_3rd_passes_metrics=cbind(Rotor_players,Rotor_final_3rd_passes_closeness, Rotor_final_3rd_passes_betw,  Rotor_final_3rd_passes_pagerank, Rotor_final_3rd_passes_transitivity)
colnames(Rotor_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Rotor_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Rotor/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Rotor_players = Rotor_progressive_passes$X
Rotor_progressive_passes$X = NULL
rownames(Rotor_progressive_passes) = Rotor_players
Rotor_progressive_passes_matrix <- as.matrix(Rotor_progressive_passes)
Rotor_progressive_passes_graph = graph_from_adjacency_matrix(Rotor_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Rotor_progressive_passes_closeness= centr_clo(Rotor_progressive_passes_graph, mode='total', normalized = TRUE)
Rotor_progressive_passes_betw = centralization.betweenness(Rotor_progressive_passes_graph, normalized =TRUE)
Rotor_progressive_passes_pagerank= page_rank(Rotor_progressive_passes_graph, algo ="power", vids = V(Rotor_progressive_passes_graph), directed = TRUE, weights = E(Rotor_progressive_passes_graph)$weight)
Rotor_progressive_passes_closeness = Rotor_progressive_passes_closeness[['res']]
Rotor_progressive_passes_betw = Rotor_progressive_passes_betw[['res']]
Rotor_progressive_passes_pagerank = Rotor_progressive_passes_pagerank[["vector"]]
Rotor_progressive_passes_transitivity = transitivity(Rotor_progressive_passes_graph,  type="weighted")
Rotor_progressive_passes_closeness[is.nan(Rotor_progressive_passes_closeness)] = 0
Rotor_progressive_passes_betw[is.nan(Rotor_progressive_passes_betw)] = 0
Rotor_progressive_passes_pagerank[is.nan(Rotor_progressive_passes_pagerank)] = 0
Rotor_progressive_passes_transitivity[is.nan(Rotor_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Rotor_progressive_passes_metrics=cbind(Rotor_players,Rotor_progressive_passes_closeness, Rotor_progressive_passes_betw,  Rotor_progressive_passes_pagerank, Rotor_progressive_passes_transitivity)
colnames(Rotor_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Rotor_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Rotor_total_passes_metrics, 
Rotor_forward_passes_metrics,
Rotor_back_passes_metrics,
Rotor_long_passes_metrics,
Rotor_final_3rd_passes_metrics,
Rotor_progressive_passes_metrics))



#norm_data
rownames(Rotor_all_passing_stats) = Rotor_players
Rotor_all_passing_stats$Player = NULL
Rotor_all_passing_stats = unfactor(Rotor_all_passing_stats)
Rotor_all_passing_stats_norm =  data.frame(lapply(Rotor_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Rotor_all_passing_stats_norm) = Rotor_players
colnames(Rotor_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Rotor_all_passing_stats, 'Rotor_passing.csv')




Shinnik_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Shinnik/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Shinnik_players = Shinnik_total_passes$X
Shinnik_total_passes$X = NULL
rownames(Shinnik_total_passes) = Shinnik_players
Shinnik_total_passes_matrix <- as.matrix(Shinnik_total_passes)
Shinnik_total_passes_graph = graph_from_adjacency_matrix(Shinnik_total_passes_matrix, mode = "directed", weighted = TRUE)
Shinnik_total_passes_closeness= centr_clo(Shinnik_total_passes_graph, mode='total', normalized = TRUE)
Shinnik_total_passes_betw = centralization.betweenness(Shinnik_total_passes_graph, normalized =TRUE)
Shinnik_total_passes_pagerank= page_rank(Shinnik_total_passes_graph, algo ="power", vids = V(Shinnik_total_passes_graph), directed = TRUE, weights = E(Shinnik_total_passes_graph)$weight)
Shinnik_total_passes_closeness = Shinnik_total_passes_closeness[['res']]
Shinnik_total_passes_betw = Shinnik_total_passes_betw[['res']]
Shinnik_total_passes_pagerank = Shinnik_total_passes_pagerank[["vector"]]
Shinnik_total_passes_transitivity = transitivity(Shinnik_total_passes_graph,  type="weighted")
Shinnik_total_passes_closeness[is.nan(Shinnik_total_passes_closeness)] = 0
Shinnik_total_passes_betw[is.nan(Shinnik_total_passes_betw)] = 0
Shinnik_total_passes_pagerank[is.nan(Shinnik_total_passes_pagerank)] = 0
Shinnik_total_passes_transitivity[is.nan(Shinnik_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Shinnik_total_passes_metrics=cbind(Shinnik_players,Shinnik_total_passes_closeness, Shinnik_total_passes_betw,  Shinnik_total_passes_pagerank, Shinnik_total_passes_transitivity)
colnames(Shinnik_total_passes_metrics)[1] = 'Player' 

#forward_passes
Shinnik_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Shinnik/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Shinnik_players = Shinnik_forward_passes$X
Shinnik_forward_passes$X = NULL
rownames(Shinnik_forward_passes) = Shinnik_players
Shinnik_forward_passes_matrix <- as.matrix(Shinnik_forward_passes)
Shinnik_forward_passes_graph = graph_from_adjacency_matrix(Shinnik_forward_passes_matrix, mode = "directed", weighted = TRUE)
Shinnik_forward_passes_closeness= centr_clo(Shinnik_forward_passes_graph, mode='total', normalized = TRUE)
Shinnik_forward_passes_betw = centralization.betweenness(Shinnik_forward_passes_graph, normalized =TRUE)
Shinnik_forward_passes_pagerank= page_rank(Shinnik_forward_passes_graph, algo ="power", vids = V(Shinnik_forward_passes_graph), directed = TRUE, weights = E(Shinnik_forward_passes_graph)$weight)
Shinnik_forward_passes_closeness = Shinnik_forward_passes_closeness[['res']]
Shinnik_forward_passes_betw = Shinnik_forward_passes_betw[['res']]
Shinnik_forward_passes_pagerank = Shinnik_forward_passes_pagerank[["vector"]]
Shinnik_forward_passes_transitivity = transitivity(Shinnik_forward_passes_graph,  type="weighted")
Shinnik_forward_passes_closeness[is.nan(Shinnik_forward_passes_closeness)] = 0
Shinnik_forward_passes_betw[is.nan(Shinnik_forward_passes_betw)] = 0
Shinnik_forward_passes_pagerank[is.nan(Shinnik_forward_passes_pagerank)] = 0
Shinnik_forward_passes_transitivity[is.nan(Shinnik_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Shinnik_forward_passes_metrics=cbind(Shinnik_players,Shinnik_forward_passes_closeness, Shinnik_forward_passes_betw,  Shinnik_forward_passes_pagerank, Shinnik_forward_passes_transitivity)
colnames(Shinnik_forward_passes_metrics)[1] = 'Player' 


#back_passes
Shinnik_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Shinnik/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Shinnik_players = Shinnik_back_passes$X
Shinnik_back_passes$X = NULL
rownames(Shinnik_back_passes) = Shinnik_players
Shinnik_back_passes_matrix <- as.matrix(Shinnik_back_passes)
Shinnik_back_passes_graph = graph_from_adjacency_matrix(Shinnik_back_passes_matrix, mode = "directed", weighted = TRUE)
Shinnik_back_passes_closeness= centr_clo(Shinnik_back_passes_graph, mode='total', normalized = TRUE)
Shinnik_back_passes_betw = centralization.betweenness(Shinnik_back_passes_graph, normalized =TRUE)
Shinnik_back_passes_pagerank= page_rank(Shinnik_back_passes_graph, algo ="power", vids = V(Shinnik_back_passes_graph), directed = TRUE, weights = E(Shinnik_back_passes_graph)$weight)
Shinnik_back_passes_closeness = Shinnik_back_passes_closeness[['res']]
Shinnik_back_passes_betw = Shinnik_back_passes_betw[['res']]
Shinnik_back_passes_pagerank = Shinnik_back_passes_pagerank[["vector"]]
Shinnik_back_passes_transitivity = transitivity(Shinnik_back_passes_graph,  type="weighted")
Shinnik_back_passes_closeness[is.nan(Shinnik_back_passes_closeness)] = 0
Shinnik_back_passes_betw[is.nan(Shinnik_back_passes_betw)] = 0
Shinnik_back_passes_pagerank[is.nan(Shinnik_back_passes_pagerank)] = 0
Shinnik_back_passes_transitivity[is.nan(Shinnik_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Shinnik_back_passes_metrics=cbind(Shinnik_players,Shinnik_back_passes_closeness, Shinnik_back_passes_betw,  Shinnik_back_passes_pagerank, Shinnik_back_passes_transitivity)
colnames(Shinnik_back_passes_metrics)[1] = 'Player'  


#long_passes
Shinnik_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Shinnik/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Shinnik_players = Shinnik_long_passes$X
Shinnik_long_passes$X = NULL
rownames(Shinnik_long_passes) = Shinnik_players
Shinnik_long_passes_matrix <- as.matrix(Shinnik_long_passes)
Shinnik_long_passes_graph = graph_from_adjacency_matrix(Shinnik_long_passes_matrix, mode = "directed", weighted = TRUE)
Shinnik_long_passes_closeness= centr_clo(Shinnik_long_passes_graph, mode='total', normalized = TRUE)
Shinnik_long_passes_betw = centralization.betweenness(Shinnik_long_passes_graph, normalized =TRUE)
Shinnik_long_passes_pagerank= page_rank(Shinnik_long_passes_graph, algo ="power", vids = V(Shinnik_long_passes_graph), directed = TRUE, weights = E(Shinnik_long_passes_graph)$weight)
Shinnik_long_passes_closeness = Shinnik_long_passes_closeness[['res']]
Shinnik_long_passes_betw = Shinnik_long_passes_betw[['res']]
Shinnik_long_passes_pagerank = Shinnik_long_passes_pagerank[["vector"]]
Shinnik_long_passes_transitivity = transitivity(Shinnik_long_passes_graph,  type="weighted")
Shinnik_long_passes_closeness[is.nan(Shinnik_long_passes_closeness)] = 0
Shinnik_long_passes_betw[is.nan(Shinnik_long_passes_betw)] = 0
Shinnik_long_passes_pagerank[is.nan(Shinnik_long_passes_pagerank)] = 0
Shinnik_long_passes_transitivity[is.nan(Shinnik_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Shinnik_long_passes_metrics=cbind(Shinnik_players,Shinnik_long_passes_closeness, Shinnik_long_passes_betw,  Shinnik_long_passes_pagerank, Shinnik_long_passes_transitivity)
colnames(Shinnik_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Shinnik_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Shinnik/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Shinnik_players = Shinnik_final_3rd_passes$X
Shinnik_final_3rd_passes$X = NULL
rownames(Shinnik_final_3rd_passes) = Shinnik_players
Shinnik_final_3rd_passes_matrix <- as.matrix(Shinnik_final_3rd_passes)
Shinnik_final_3rd_passes_graph = graph_from_adjacency_matrix(Shinnik_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Shinnik_final_3rd_passes_closeness= centr_clo(Shinnik_final_3rd_passes_graph, mode='total', normalized = TRUE)
Shinnik_final_3rd_passes_betw = centralization.betweenness(Shinnik_final_3rd_passes_graph, normalized =TRUE)
Shinnik_final_3rd_passes_pagerank= page_rank(Shinnik_final_3rd_passes_graph, algo ="power", vids = V(Shinnik_final_3rd_passes_graph), directed = TRUE, weights = E(Shinnik_final_3rd_passes_graph)$weight)
Shinnik_final_3rd_passes_closeness = Shinnik_final_3rd_passes_closeness[['res']]
Shinnik_final_3rd_passes_betw = Shinnik_final_3rd_passes_betw[['res']]
Shinnik_final_3rd_passes_pagerank = Shinnik_final_3rd_passes_pagerank[["vector"]]
Shinnik_final_3rd_passes_transitivity = transitivity(Shinnik_final_3rd_passes_graph,  type="weighted")
Shinnik_final_3rd_passes_closeness[is.nan(Shinnik_final_3rd_passes_closeness)] = 0
Shinnik_final_3rd_passes_betw[is.nan(Shinnik_final_3rd_passes_betw)] = 0
Shinnik_final_3rd_passes_pagerank[is.nan(Shinnik_final_3rd_passes_pagerank)] = 0
Shinnik_final_3rd_passes_transitivity[is.nan(Shinnik_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Shinnik_final_3rd_passes_metrics=cbind(Shinnik_players,Shinnik_final_3rd_passes_closeness, Shinnik_final_3rd_passes_betw,  Shinnik_final_3rd_passes_pagerank, Shinnik_final_3rd_passes_transitivity)
colnames(Shinnik_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Shinnik_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Shinnik/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Shinnik_players = Shinnik_progressive_passes$X
Shinnik_progressive_passes$X = NULL
rownames(Shinnik_progressive_passes) = Shinnik_players
Shinnik_progressive_passes_matrix <- as.matrix(Shinnik_progressive_passes)
Shinnik_progressive_passes_graph = graph_from_adjacency_matrix(Shinnik_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Shinnik_progressive_passes_closeness= centr_clo(Shinnik_progressive_passes_graph, mode='total', normalized = TRUE)
Shinnik_progressive_passes_betw = centralization.betweenness(Shinnik_progressive_passes_graph, normalized =TRUE)
Shinnik_progressive_passes_pagerank= page_rank(Shinnik_progressive_passes_graph, algo ="power", vids = V(Shinnik_progressive_passes_graph), directed = TRUE, weights = E(Shinnik_progressive_passes_graph)$weight)
Shinnik_progressive_passes_closeness = Shinnik_progressive_passes_closeness[['res']]
Shinnik_progressive_passes_betw = Shinnik_progressive_passes_betw[['res']]
Shinnik_progressive_passes_pagerank = Shinnik_progressive_passes_pagerank[["vector"]]
Shinnik_progressive_passes_transitivity = transitivity(Shinnik_progressive_passes_graph,  type="weighted")
Shinnik_progressive_passes_closeness[is.nan(Shinnik_progressive_passes_closeness)] = 0
Shinnik_progressive_passes_betw[is.nan(Shinnik_progressive_passes_betw)] = 0
Shinnik_progressive_passes_pagerank[is.nan(Shinnik_progressive_passes_pagerank)] = 0
Shinnik_progressive_passes_transitivity[is.nan(Shinnik_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Shinnik_progressive_passes_metrics=cbind(Shinnik_players,Shinnik_progressive_passes_closeness, Shinnik_progressive_passes_betw,  Shinnik_progressive_passes_pagerank, Shinnik_progressive_passes_transitivity)
colnames(Shinnik_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Shinnik_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Shinnik_total_passes_metrics, 
Shinnik_forward_passes_metrics,
Shinnik_back_passes_metrics,
Shinnik_long_passes_metrics,
Shinnik_final_3rd_passes_metrics,
Shinnik_progressive_passes_metrics))



#norm_data
rownames(Shinnik_all_passing_stats) = Shinnik_players
Shinnik_all_passing_stats$Player = NULL
Shinnik_all_passing_stats = unfactor(Shinnik_all_passing_stats)
Shinnik_all_passing_stats_norm =  data.frame(lapply(Shinnik_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Shinnik_all_passing_stats_norm) = Shinnik_players
colnames(Shinnik_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Shinnik_all_passing_stats, 'Shinnik_passing.csv')


Ska_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/ska/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Ska_players = Ska_total_passes$X
Ska_total_passes$X = NULL
rownames(Ska_total_passes) = Ska_players
Ska_total_passes_matrix <- as.matrix(Ska_total_passes)
Ska_total_passes_graph = graph_from_adjacency_matrix(Ska_total_passes_matrix, mode = "directed", weighted = TRUE)
Ska_total_passes_closeness= centr_clo(Ska_total_passes_graph, mode='total', normalized = TRUE)
Ska_total_passes_betw = centralization.betweenness(Ska_total_passes_graph, normalized =TRUE)
Ska_total_passes_pagerank= page_rank(Ska_total_passes_graph, algo ="power", vids = V(Ska_total_passes_graph), directed = TRUE, weights = E(Ska_total_passes_graph)$weight)
Ska_total_passes_closeness = Ska_total_passes_closeness[['res']]
Ska_total_passes_betw = Ska_total_passes_betw[['res']]
Ska_total_passes_pagerank = Ska_total_passes_pagerank[["vector"]]
Ska_total_passes_transitivity = transitivity(Ska_total_passes_graph,  type="weighted")
Ska_total_passes_closeness[is.nan(Ska_total_passes_closeness)] = 0
Ska_total_passes_betw[is.nan(Ska_total_passes_betw)] = 0
Ska_total_passes_pagerank[is.nan(Ska_total_passes_pagerank)] = 0
Ska_total_passes_transitivity[is.nan(Ska_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Ska_total_passes_metrics=cbind(Ska_players,Ska_total_passes_closeness, Ska_total_passes_betw,  Ska_total_passes_pagerank, Ska_total_passes_transitivity)
colnames(Ska_total_passes_metrics)[1] = 'Player' 

#forward_passes
Ska_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/ska/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Ska_players = Ska_forward_passes$X
Ska_forward_passes$X = NULL
rownames(Ska_forward_passes) = Ska_players
Ska_forward_passes_matrix <- as.matrix(Ska_forward_passes)
Ska_forward_passes_graph = graph_from_adjacency_matrix(Ska_forward_passes_matrix, mode = "directed", weighted = TRUE)
Ska_forward_passes_closeness= centr_clo(Ska_forward_passes_graph, mode='total', normalized = TRUE)
Ska_forward_passes_betw = centralization.betweenness(Ska_forward_passes_graph, normalized =TRUE)
Ska_forward_passes_pagerank= page_rank(Ska_forward_passes_graph, algo ="power", vids = V(Ska_forward_passes_graph), directed = TRUE, weights = E(Ska_forward_passes_graph)$weight)
Ska_forward_passes_closeness = Ska_forward_passes_closeness[['res']]
Ska_forward_passes_betw = Ska_forward_passes_betw[['res']]
Ska_forward_passes_pagerank = Ska_forward_passes_pagerank[["vector"]]
Ska_forward_passes_transitivity = transitivity(Ska_forward_passes_graph,  type="weighted")
Ska_forward_passes_closeness[is.nan(Ska_forward_passes_closeness)] = 0
Ska_forward_passes_betw[is.nan(Ska_forward_passes_betw)] = 0
Ska_forward_passes_pagerank[is.nan(Ska_forward_passes_pagerank)] = 0
Ska_forward_passes_transitivity[is.nan(Ska_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Ska_forward_passes_metrics=cbind(Ska_players,Ska_forward_passes_closeness, Ska_forward_passes_betw,  Ska_forward_passes_pagerank, Ska_forward_passes_transitivity)
colnames(Ska_forward_passes_metrics)[1] = 'Player' 


#back_passes
Ska_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/ska/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Ska_players = Ska_back_passes$X
Ska_back_passes$X = NULL
rownames(Ska_back_passes) = Ska_players
Ska_back_passes_matrix <- as.matrix(Ska_back_passes)
Ska_back_passes_graph = graph_from_adjacency_matrix(Ska_back_passes_matrix, mode = "directed", weighted = TRUE)
Ska_back_passes_closeness= centr_clo(Ska_back_passes_graph, mode='total', normalized = TRUE)
Ska_back_passes_betw = centralization.betweenness(Ska_back_passes_graph, normalized =TRUE)
Ska_back_passes_pagerank= page_rank(Ska_back_passes_graph, algo ="power", vids = V(Ska_back_passes_graph), directed = TRUE, weights = E(Ska_back_passes_graph)$weight)
Ska_back_passes_closeness = Ska_back_passes_closeness[['res']]
Ska_back_passes_betw = Ska_back_passes_betw[['res']]
Ska_back_passes_pagerank = Ska_back_passes_pagerank[["vector"]]
Ska_back_passes_transitivity = transitivity(Ska_back_passes_graph,  type="weighted")
Ska_back_passes_closeness[is.nan(Ska_back_passes_closeness)] = 0
Ska_back_passes_betw[is.nan(Ska_back_passes_betw)] = 0
Ska_back_passes_pagerank[is.nan(Ska_back_passes_pagerank)] = 0
Ska_back_passes_transitivity[is.nan(Ska_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Ska_back_passes_metrics=cbind(Ska_players,Ska_back_passes_closeness, Ska_back_passes_betw,  Ska_back_passes_pagerank, Ska_back_passes_transitivity)
colnames(Ska_back_passes_metrics)[1] = 'Player'  


#long_passes
Ska_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/ska/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Ska_players = Ska_long_passes$X
Ska_long_passes$X = NULL
rownames(Ska_long_passes) = Ska_players
Ska_long_passes_matrix <- as.matrix(Ska_long_passes)
Ska_long_passes_graph = graph_from_adjacency_matrix(Ska_long_passes_matrix, mode = "directed", weighted = TRUE)
Ska_long_passes_closeness= centr_clo(Ska_long_passes_graph, mode='total', normalized = TRUE)
Ska_long_passes_betw = centralization.betweenness(Ska_long_passes_graph, normalized =TRUE)
Ska_long_passes_pagerank= page_rank(Ska_long_passes_graph, algo ="power", vids = V(Ska_long_passes_graph), directed = TRUE, weights = E(Ska_long_passes_graph)$weight)
Ska_long_passes_closeness = Ska_long_passes_closeness[['res']]
Ska_long_passes_betw = Ska_long_passes_betw[['res']]
Ska_long_passes_pagerank = Ska_long_passes_pagerank[["vector"]]
Ska_long_passes_transitivity = transitivity(Ska_long_passes_graph,  type="weighted")
Ska_long_passes_closeness[is.nan(Ska_long_passes_closeness)] = 0
Ska_long_passes_betw[is.nan(Ska_long_passes_betw)] = 0
Ska_long_passes_pagerank[is.nan(Ska_long_passes_pagerank)] = 0
Ska_long_passes_transitivity[is.nan(Ska_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Ska_long_passes_metrics=cbind(Ska_players,Ska_long_passes_closeness, Ska_long_passes_betw,  Ska_long_passes_pagerank, Ska_long_passes_transitivity)
colnames(Ska_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Ska_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/ska/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Ska_players = Ska_final_3rd_passes$X
Ska_final_3rd_passes$X = NULL
rownames(Ska_final_3rd_passes) = Ska_players
Ska_final_3rd_passes_matrix <- as.matrix(Ska_final_3rd_passes)
Ska_final_3rd_passes_graph = graph_from_adjacency_matrix(Ska_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Ska_final_3rd_passes_closeness= centr_clo(Ska_final_3rd_passes_graph, mode='total', normalized = TRUE)
Ska_final_3rd_passes_betw = centralization.betweenness(Ska_final_3rd_passes_graph, normalized =TRUE)
Ska_final_3rd_passes_pagerank= page_rank(Ska_final_3rd_passes_graph, algo ="power", vids = V(Ska_final_3rd_passes_graph), directed = TRUE, weights = E(Ska_final_3rd_passes_graph)$weight)
Ska_final_3rd_passes_closeness = Ska_final_3rd_passes_closeness[['res']]
Ska_final_3rd_passes_betw = Ska_final_3rd_passes_betw[['res']]
Ska_final_3rd_passes_pagerank = Ska_final_3rd_passes_pagerank[["vector"]]
Ska_final_3rd_passes_transitivity = transitivity(Ska_final_3rd_passes_graph,  type="weighted")
Ska_final_3rd_passes_closeness[is.nan(Ska_final_3rd_passes_closeness)] = 0
Ska_final_3rd_passes_betw[is.nan(Ska_final_3rd_passes_betw)] = 0
Ska_final_3rd_passes_pagerank[is.nan(Ska_final_3rd_passes_pagerank)] = 0
Ska_final_3rd_passes_transitivity[is.nan(Ska_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Ska_final_3rd_passes_metrics=cbind(Ska_players,Ska_final_3rd_passes_closeness, Ska_final_3rd_passes_betw,  Ska_final_3rd_passes_pagerank, Ska_final_3rd_passes_transitivity)
colnames(Ska_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Ska_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/ska/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Ska_players = Ska_progressive_passes$X
Ska_progressive_passes$X = NULL
rownames(Ska_progressive_passes) = Ska_players
Ska_progressive_passes_matrix <- as.matrix(Ska_progressive_passes)
Ska_progressive_passes_graph = graph_from_adjacency_matrix(Ska_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Ska_progressive_passes_closeness= centr_clo(Ska_progressive_passes_graph, mode='total', normalized = TRUE)
Ska_progressive_passes_betw = centralization.betweenness(Ska_progressive_passes_graph, normalized =TRUE)
Ska_progressive_passes_pagerank= page_rank(Ska_progressive_passes_graph, algo ="power", vids = V(Ska_progressive_passes_graph), directed = TRUE, weights = E(Ska_progressive_passes_graph)$weight)
Ska_progressive_passes_closeness = Ska_progressive_passes_closeness[['res']]
Ska_progressive_passes_betw = Ska_progressive_passes_betw[['res']]
Ska_progressive_passes_pagerank = Ska_progressive_passes_pagerank[["vector"]]
Ska_progressive_passes_transitivity = transitivity(Ska_progressive_passes_graph,  type="weighted")
Ska_progressive_passes_closeness[is.nan(Ska_progressive_passes_closeness)] = 0
Ska_progressive_passes_betw[is.nan(Ska_progressive_passes_betw)] = 0
Ska_progressive_passes_pagerank[is.nan(Ska_progressive_passes_pagerank)] = 0
Ska_progressive_passes_transitivity[is.nan(Ska_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Ska_progressive_passes_metrics=cbind(Ska_players,Ska_progressive_passes_closeness, Ska_progressive_passes_betw,  Ska_progressive_passes_pagerank, Ska_progressive_passes_transitivity)
colnames(Ska_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Ska_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Ska_total_passes_metrics, 
Ska_forward_passes_metrics,
Ska_back_passes_metrics,
Ska_long_passes_metrics,
Ska_final_3rd_passes_metrics,
Ska_progressive_passes_metrics))



#norm_data
rownames(Ska_all_passing_stats) = Ska_players
Ska_all_passing_stats$Player = NULL
Ska_all_passing_stats = unfactor(Ska_all_passing_stats)
Ska_all_passing_stats_norm =  data.frame(lapply(Ska_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Ska_all_passing_stats_norm) = Ska_players
colnames(Ska_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Ska_all_passing_stats, 'Ska_passing.csv')




Spartak_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/spartak/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Spartak_players = Spartak_total_passes$X
Spartak_total_passes$X = NULL
rownames(Spartak_total_passes) = Spartak_players
Spartak_total_passes_matrix <- as.matrix(Spartak_total_passes)
Spartak_total_passes_graph = graph_from_adjacency_matrix(Spartak_total_passes_matrix, mode = "directed", weighted = TRUE)
Spartak_total_passes_closeness= centr_clo(Spartak_total_passes_graph, mode='total', normalized = TRUE)
Spartak_total_passes_betw = centralization.betweenness(Spartak_total_passes_graph, normalized =TRUE)
Spartak_total_passes_pagerank= page_rank(Spartak_total_passes_graph, algo ="power", vids = V(Spartak_total_passes_graph), directed = TRUE, weights = E(Spartak_total_passes_graph)$weight)
Spartak_total_passes_closeness = Spartak_total_passes_closeness[['res']]
Spartak_total_passes_betw = Spartak_total_passes_betw[['res']]
Spartak_total_passes_pagerank = Spartak_total_passes_pagerank[["vector"]]
Spartak_total_passes_transitivity = transitivity(Spartak_total_passes_graph,  type="weighted")
Spartak_total_passes_closeness[is.nan(Spartak_total_passes_closeness)] = 0
Spartak_total_passes_betw[is.nan(Spartak_total_passes_betw)] = 0
Spartak_total_passes_pagerank[is.nan(Spartak_total_passes_pagerank)] = 0
Spartak_total_passes_transitivity[is.nan(Spartak_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Spartak_total_passes_metrics=cbind(Spartak_players,Spartak_total_passes_closeness, Spartak_total_passes_betw,  Spartak_total_passes_pagerank, Spartak_total_passes_transitivity)
colnames(Spartak_total_passes_metrics)[1] = 'Player' 

#forward_passes
Spartak_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/spartak/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Spartak_players = Spartak_forward_passes$X
Spartak_forward_passes$X = NULL
rownames(Spartak_forward_passes) = Spartak_players
Spartak_forward_passes_matrix <- as.matrix(Spartak_forward_passes)
Spartak_forward_passes_graph = graph_from_adjacency_matrix(Spartak_forward_passes_matrix, mode = "directed", weighted = TRUE)
Spartak_forward_passes_closeness= centr_clo(Spartak_forward_passes_graph, mode='total', normalized = TRUE)
Spartak_forward_passes_betw = centralization.betweenness(Spartak_forward_passes_graph, normalized =TRUE)
Spartak_forward_passes_pagerank= page_rank(Spartak_forward_passes_graph, algo ="power", vids = V(Spartak_forward_passes_graph), directed = TRUE, weights = E(Spartak_forward_passes_graph)$weight)
Spartak_forward_passes_closeness = Spartak_forward_passes_closeness[['res']]
Spartak_forward_passes_betw = Spartak_forward_passes_betw[['res']]
Spartak_forward_passes_pagerank = Spartak_forward_passes_pagerank[["vector"]]
Spartak_forward_passes_transitivity = transitivity(Spartak_forward_passes_graph,  type="weighted")
Spartak_forward_passes_closeness[is.nan(Spartak_forward_passes_closeness)] = 0
Spartak_forward_passes_betw[is.nan(Spartak_forward_passes_betw)] = 0
Spartak_forward_passes_pagerank[is.nan(Spartak_forward_passes_pagerank)] = 0
Spartak_forward_passes_transitivity[is.nan(Spartak_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Spartak_forward_passes_metrics=cbind(Spartak_players,Spartak_forward_passes_closeness, Spartak_forward_passes_betw,  Spartak_forward_passes_pagerank, Spartak_forward_passes_transitivity)
colnames(Spartak_forward_passes_metrics)[1] = 'Player' 


#back_passes
Spartak_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/spartak/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Spartak_players = Spartak_back_passes$X
Spartak_back_passes$X = NULL
rownames(Spartak_back_passes) = Spartak_players
Spartak_back_passes_matrix <- as.matrix(Spartak_back_passes)
Spartak_back_passes_graph = graph_from_adjacency_matrix(Spartak_back_passes_matrix, mode = "directed", weighted = TRUE)
Spartak_back_passes_closeness= centr_clo(Spartak_back_passes_graph, mode='total', normalized = TRUE)
Spartak_back_passes_betw = centralization.betweenness(Spartak_back_passes_graph, normalized =TRUE)
Spartak_back_passes_pagerank= page_rank(Spartak_back_passes_graph, algo ="power", vids = V(Spartak_back_passes_graph), directed = TRUE, weights = E(Spartak_back_passes_graph)$weight)
Spartak_back_passes_closeness = Spartak_back_passes_closeness[['res']]
Spartak_back_passes_betw = Spartak_back_passes_betw[['res']]
Spartak_back_passes_pagerank = Spartak_back_passes_pagerank[["vector"]]
Spartak_back_passes_transitivity = transitivity(Spartak_back_passes_graph,  type="weighted")
Spartak_back_passes_closeness[is.nan(Spartak_back_passes_closeness)] = 0
Spartak_back_passes_betw[is.nan(Spartak_back_passes_betw)] = 0
Spartak_back_passes_pagerank[is.nan(Spartak_back_passes_pagerank)] = 0
Spartak_back_passes_transitivity[is.nan(Spartak_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Spartak_back_passes_metrics=cbind(Spartak_players,Spartak_back_passes_closeness, Spartak_back_passes_betw,  Spartak_back_passes_pagerank, Spartak_back_passes_transitivity)
colnames(Spartak_back_passes_metrics)[1] = 'Player'  


#long_passes
Spartak_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/spartak/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Spartak_players = Spartak_long_passes$X
Spartak_long_passes$X = NULL
rownames(Spartak_long_passes) = Spartak_players
Spartak_long_passes_matrix <- as.matrix(Spartak_long_passes)
Spartak_long_passes_graph = graph_from_adjacency_matrix(Spartak_long_passes_matrix, mode = "directed", weighted = TRUE)
Spartak_long_passes_closeness= centr_clo(Spartak_long_passes_graph, mode='total', normalized = TRUE)
Spartak_long_passes_betw = centralization.betweenness(Spartak_long_passes_graph, normalized =TRUE)
Spartak_long_passes_pagerank= page_rank(Spartak_long_passes_graph, algo ="power", vids = V(Spartak_long_passes_graph), directed = TRUE, weights = E(Spartak_long_passes_graph)$weight)
Spartak_long_passes_closeness = Spartak_long_passes_closeness[['res']]
Spartak_long_passes_betw = Spartak_long_passes_betw[['res']]
Spartak_long_passes_pagerank = Spartak_long_passes_pagerank[["vector"]]
Spartak_long_passes_transitivity = transitivity(Spartak_long_passes_graph,  type="weighted")
Spartak_long_passes_closeness[is.nan(Spartak_long_passes_closeness)] = 0
Spartak_long_passes_betw[is.nan(Spartak_long_passes_betw)] = 0
Spartak_long_passes_pagerank[is.nan(Spartak_long_passes_pagerank)] = 0
Spartak_long_passes_transitivity[is.nan(Spartak_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Spartak_long_passes_metrics=cbind(Spartak_players,Spartak_long_passes_closeness, Spartak_long_passes_betw,  Spartak_long_passes_pagerank, Spartak_long_passes_transitivity)
colnames(Spartak_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Spartak_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/spartak/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Spartak_players = Spartak_final_3rd_passes$X
Spartak_final_3rd_passes$X = NULL
rownames(Spartak_final_3rd_passes) = Spartak_players
Spartak_final_3rd_passes_matrix <- as.matrix(Spartak_final_3rd_passes)
Spartak_final_3rd_passes_graph = graph_from_adjacency_matrix(Spartak_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Spartak_final_3rd_passes_closeness= centr_clo(Spartak_final_3rd_passes_graph, mode='total', normalized = TRUE)
Spartak_final_3rd_passes_betw = centralization.betweenness(Spartak_final_3rd_passes_graph, normalized =TRUE)
Spartak_final_3rd_passes_pagerank= page_rank(Spartak_final_3rd_passes_graph, algo ="power", vids = V(Spartak_final_3rd_passes_graph), directed = TRUE, weights = E(Spartak_final_3rd_passes_graph)$weight)
Spartak_final_3rd_passes_closeness = Spartak_final_3rd_passes_closeness[['res']]
Spartak_final_3rd_passes_betw = Spartak_final_3rd_passes_betw[['res']]
Spartak_final_3rd_passes_pagerank = Spartak_final_3rd_passes_pagerank[["vector"]]
Spartak_final_3rd_passes_transitivity = transitivity(Spartak_final_3rd_passes_graph,  type="weighted")
Spartak_final_3rd_passes_closeness[is.nan(Spartak_final_3rd_passes_closeness)] = 0
Spartak_final_3rd_passes_betw[is.nan(Spartak_final_3rd_passes_betw)] = 0
Spartak_final_3rd_passes_pagerank[is.nan(Spartak_final_3rd_passes_pagerank)] = 0
Spartak_final_3rd_passes_transitivity[is.nan(Spartak_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Spartak_final_3rd_passes_metrics=cbind(Spartak_players,Spartak_final_3rd_passes_closeness, Spartak_final_3rd_passes_betw,  Spartak_final_3rd_passes_pagerank, Spartak_final_3rd_passes_transitivity)
colnames(Spartak_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Spartak_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/spartak/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Spartak_players = Spartak_progressive_passes$X
Spartak_progressive_passes$X = NULL
rownames(Spartak_progressive_passes) = Spartak_players
Spartak_progressive_passes_matrix <- as.matrix(Spartak_progressive_passes)
Spartak_progressive_passes_graph = graph_from_adjacency_matrix(Spartak_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Spartak_progressive_passes_closeness= centr_clo(Spartak_progressive_passes_graph, mode='total', normalized = TRUE)
Spartak_progressive_passes_betw = centralization.betweenness(Spartak_progressive_passes_graph, normalized =TRUE)
Spartak_progressive_passes_pagerank= page_rank(Spartak_progressive_passes_graph, algo ="power", vids = V(Spartak_progressive_passes_graph), directed = TRUE, weights = E(Spartak_progressive_passes_graph)$weight)
Spartak_progressive_passes_closeness = Spartak_progressive_passes_closeness[['res']]
Spartak_progressive_passes_betw = Spartak_progressive_passes_betw[['res']]
Spartak_progressive_passes_pagerank = Spartak_progressive_passes_pagerank[["vector"]]
Spartak_progressive_passes_transitivity = transitivity(Spartak_progressive_passes_graph,  type="weighted")
Spartak_progressive_passes_closeness[is.nan(Spartak_progressive_passes_closeness)] = 0
Spartak_progressive_passes_betw[is.nan(Spartak_progressive_passes_betw)] = 0
Spartak_progressive_passes_pagerank[is.nan(Spartak_progressive_passes_pagerank)] = 0
Spartak_progressive_passes_transitivity[is.nan(Spartak_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Spartak_progressive_passes_metrics=cbind(Spartak_players,Spartak_progressive_passes_closeness, Spartak_progressive_passes_betw,  Spartak_progressive_passes_pagerank, Spartak_progressive_passes_transitivity)
colnames(Spartak_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Spartak_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Spartak_total_passes_metrics, 
Spartak_forward_passes_metrics,
Spartak_back_passes_metrics,
Spartak_long_passes_metrics,
Spartak_final_3rd_passes_metrics,
Spartak_progressive_passes_metrics))



#norm_data
rownames(Spartak_all_passing_stats) = Spartak_players
Spartak_all_passing_stats$Player = NULL
Spartak_all_passing_stats = unfactor(Spartak_all_passing_stats)
Spartak_all_passing_stats_norm =  data.frame(lapply(Spartak_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Spartak_all_passing_stats_norm) = Spartak_players
colnames(Spartak_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Spartak_all_passing_stats, 'Spartak_passing.csv')


Tekstilshchik_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Tekstilshchik/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Tekstilshchik_players = Tekstilshchik_total_passes$X
Tekstilshchik_total_passes$X = NULL
rownames(Tekstilshchik_total_passes) = Tekstilshchik_players
Tekstilshchik_total_passes_matrix <- as.matrix(Tekstilshchik_total_passes)
Tekstilshchik_total_passes_graph = graph_from_adjacency_matrix(Tekstilshchik_total_passes_matrix, mode = "directed", weighted = TRUE)
Tekstilshchik_total_passes_closeness= centr_clo(Tekstilshchik_total_passes_graph, mode='total', normalized = TRUE)
Tekstilshchik_total_passes_betw = centralization.betweenness(Tekstilshchik_total_passes_graph, normalized =TRUE)
Tekstilshchik_total_passes_pagerank= page_rank(Tekstilshchik_total_passes_graph, algo ="power", vids = V(Tekstilshchik_total_passes_graph), directed = TRUE, weights = E(Tekstilshchik_total_passes_graph)$weight)
Tekstilshchik_total_passes_closeness = Tekstilshchik_total_passes_closeness[['res']]
Tekstilshchik_total_passes_betw = Tekstilshchik_total_passes_betw[['res']]
Tekstilshchik_total_passes_pagerank = Tekstilshchik_total_passes_pagerank[["vector"]]
Tekstilshchik_total_passes_transitivity = transitivity(Tekstilshchik_total_passes_graph,  type="weighted")
Tekstilshchik_total_passes_closeness[is.nan(Tekstilshchik_total_passes_closeness)] = 0
Tekstilshchik_total_passes_betw[is.nan(Tekstilshchik_total_passes_betw)] = 0
Tekstilshchik_total_passes_pagerank[is.nan(Tekstilshchik_total_passes_pagerank)] = 0
Tekstilshchik_total_passes_transitivity[is.nan(Tekstilshchik_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Tekstilshchik_total_passes_metrics=cbind(Tekstilshchik_players,Tekstilshchik_total_passes_closeness, Tekstilshchik_total_passes_betw,  Tekstilshchik_total_passes_pagerank, Tekstilshchik_total_passes_transitivity)
colnames(Tekstilshchik_total_passes_metrics)[1] = 'Player' 

#forward_passes
Tekstilshchik_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Tekstilshchik/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Tekstilshchik_players = Tekstilshchik_forward_passes$X
Tekstilshchik_forward_passes$X = NULL
rownames(Tekstilshchik_forward_passes) = Tekstilshchik_players
Tekstilshchik_forward_passes_matrix <- as.matrix(Tekstilshchik_forward_passes)
Tekstilshchik_forward_passes_graph = graph_from_adjacency_matrix(Tekstilshchik_forward_passes_matrix, mode = "directed", weighted = TRUE)
Tekstilshchik_forward_passes_closeness= centr_clo(Tekstilshchik_forward_passes_graph, mode='total', normalized = TRUE)
Tekstilshchik_forward_passes_betw = centralization.betweenness(Tekstilshchik_forward_passes_graph, normalized =TRUE)
Tekstilshchik_forward_passes_pagerank= page_rank(Tekstilshchik_forward_passes_graph, algo ="power", vids = V(Tekstilshchik_forward_passes_graph), directed = TRUE, weights = E(Tekstilshchik_forward_passes_graph)$weight)
Tekstilshchik_forward_passes_closeness = Tekstilshchik_forward_passes_closeness[['res']]
Tekstilshchik_forward_passes_betw = Tekstilshchik_forward_passes_betw[['res']]
Tekstilshchik_forward_passes_pagerank = Tekstilshchik_forward_passes_pagerank[["vector"]]
Tekstilshchik_forward_passes_transitivity = transitivity(Tekstilshchik_forward_passes_graph,  type="weighted")
Tekstilshchik_forward_passes_closeness[is.nan(Tekstilshchik_forward_passes_closeness)] = 0
Tekstilshchik_forward_passes_betw[is.nan(Tekstilshchik_forward_passes_betw)] = 0
Tekstilshchik_forward_passes_pagerank[is.nan(Tekstilshchik_forward_passes_pagerank)] = 0
Tekstilshchik_forward_passes_transitivity[is.nan(Tekstilshchik_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Tekstilshchik_forward_passes_metrics=cbind(Tekstilshchik_players,Tekstilshchik_forward_passes_closeness, Tekstilshchik_forward_passes_betw,  Tekstilshchik_forward_passes_pagerank, Tekstilshchik_forward_passes_transitivity)
colnames(Tekstilshchik_forward_passes_metrics)[1] = 'Player' 


#back_passes
Tekstilshchik_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Tekstilshchik/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Tekstilshchik_players = Tekstilshchik_back_passes$X
Tekstilshchik_back_passes$X = NULL
rownames(Tekstilshchik_back_passes) = Tekstilshchik_players
Tekstilshchik_back_passes_matrix <- as.matrix(Tekstilshchik_back_passes)
Tekstilshchik_back_passes_graph = graph_from_adjacency_matrix(Tekstilshchik_back_passes_matrix, mode = "directed", weighted = TRUE)
Tekstilshchik_back_passes_closeness= centr_clo(Tekstilshchik_back_passes_graph, mode='total', normalized = TRUE)
Tekstilshchik_back_passes_betw = centralization.betweenness(Tekstilshchik_back_passes_graph, normalized =TRUE)
Tekstilshchik_back_passes_pagerank= page_rank(Tekstilshchik_back_passes_graph, algo ="power", vids = V(Tekstilshchik_back_passes_graph), directed = TRUE, weights = E(Tekstilshchik_back_passes_graph)$weight)
Tekstilshchik_back_passes_closeness = Tekstilshchik_back_passes_closeness[['res']]
Tekstilshchik_back_passes_betw = Tekstilshchik_back_passes_betw[['res']]
Tekstilshchik_back_passes_pagerank = Tekstilshchik_back_passes_pagerank[["vector"]]
Tekstilshchik_back_passes_transitivity = transitivity(Tekstilshchik_back_passes_graph,  type="weighted")
Tekstilshchik_back_passes_closeness[is.nan(Tekstilshchik_back_passes_closeness)] = 0
Tekstilshchik_back_passes_betw[is.nan(Tekstilshchik_back_passes_betw)] = 0
Tekstilshchik_back_passes_pagerank[is.nan(Tekstilshchik_back_passes_pagerank)] = 0
Tekstilshchik_back_passes_transitivity[is.nan(Tekstilshchik_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Tekstilshchik_back_passes_metrics=cbind(Tekstilshchik_players,Tekstilshchik_back_passes_closeness, Tekstilshchik_back_passes_betw,  Tekstilshchik_back_passes_pagerank, Tekstilshchik_back_passes_transitivity)
colnames(Tekstilshchik_back_passes_metrics)[1] = 'Player'  


#long_passes
Tekstilshchik_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Tekstilshchik/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Tekstilshchik_players = Tekstilshchik_long_passes$X
Tekstilshchik_long_passes$X = NULL
rownames(Tekstilshchik_long_passes) = Tekstilshchik_players
Tekstilshchik_long_passes_matrix <- as.matrix(Tekstilshchik_long_passes)
Tekstilshchik_long_passes_graph = graph_from_adjacency_matrix(Tekstilshchik_long_passes_matrix, mode = "directed", weighted = TRUE)
Tekstilshchik_long_passes_closeness= centr_clo(Tekstilshchik_long_passes_graph, mode='total', normalized = TRUE)
Tekstilshchik_long_passes_betw = centralization.betweenness(Tekstilshchik_long_passes_graph, normalized =TRUE)
Tekstilshchik_long_passes_pagerank= page_rank(Tekstilshchik_long_passes_graph, algo ="power", vids = V(Tekstilshchik_long_passes_graph), directed = TRUE, weights = E(Tekstilshchik_long_passes_graph)$weight)
Tekstilshchik_long_passes_closeness = Tekstilshchik_long_passes_closeness[['res']]
Tekstilshchik_long_passes_betw = Tekstilshchik_long_passes_betw[['res']]
Tekstilshchik_long_passes_pagerank = Tekstilshchik_long_passes_pagerank[["vector"]]
Tekstilshchik_long_passes_transitivity = transitivity(Tekstilshchik_long_passes_graph,  type="weighted")
Tekstilshchik_long_passes_closeness[is.nan(Tekstilshchik_long_passes_closeness)] = 0
Tekstilshchik_long_passes_betw[is.nan(Tekstilshchik_long_passes_betw)] = 0
Tekstilshchik_long_passes_pagerank[is.nan(Tekstilshchik_long_passes_pagerank)] = 0
Tekstilshchik_long_passes_transitivity[is.nan(Tekstilshchik_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Tekstilshchik_long_passes_metrics=cbind(Tekstilshchik_players,Tekstilshchik_long_passes_closeness, Tekstilshchik_long_passes_betw,  Tekstilshchik_long_passes_pagerank, Tekstilshchik_long_passes_transitivity)
colnames(Tekstilshchik_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Tekstilshchik_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Tekstilshchik/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Tekstilshchik_players = Tekstilshchik_final_3rd_passes$X
Tekstilshchik_final_3rd_passes$X = NULL
rownames(Tekstilshchik_final_3rd_passes) = Tekstilshchik_players
Tekstilshchik_final_3rd_passes_matrix <- as.matrix(Tekstilshchik_final_3rd_passes)
Tekstilshchik_final_3rd_passes_graph = graph_from_adjacency_matrix(Tekstilshchik_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Tekstilshchik_final_3rd_passes_closeness= centr_clo(Tekstilshchik_final_3rd_passes_graph, mode='total', normalized = TRUE)
Tekstilshchik_final_3rd_passes_betw = centralization.betweenness(Tekstilshchik_final_3rd_passes_graph, normalized =TRUE)
Tekstilshchik_final_3rd_passes_pagerank= page_rank(Tekstilshchik_final_3rd_passes_graph, algo ="power", vids = V(Tekstilshchik_final_3rd_passes_graph), directed = TRUE, weights = E(Tekstilshchik_final_3rd_passes_graph)$weight)
Tekstilshchik_final_3rd_passes_closeness = Tekstilshchik_final_3rd_passes_closeness[['res']]
Tekstilshchik_final_3rd_passes_betw = Tekstilshchik_final_3rd_passes_betw[['res']]
Tekstilshchik_final_3rd_passes_pagerank = Tekstilshchik_final_3rd_passes_pagerank[["vector"]]
Tekstilshchik_final_3rd_passes_transitivity = transitivity(Tekstilshchik_final_3rd_passes_graph,  type="weighted")
Tekstilshchik_final_3rd_passes_closeness[is.nan(Tekstilshchik_final_3rd_passes_closeness)] = 0
Tekstilshchik_final_3rd_passes_betw[is.nan(Tekstilshchik_final_3rd_passes_betw)] = 0
Tekstilshchik_final_3rd_passes_pagerank[is.nan(Tekstilshchik_final_3rd_passes_pagerank)] = 0
Tekstilshchik_final_3rd_passes_transitivity[is.nan(Tekstilshchik_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Tekstilshchik_final_3rd_passes_metrics=cbind(Tekstilshchik_players,Tekstilshchik_final_3rd_passes_closeness, Tekstilshchik_final_3rd_passes_betw,  Tekstilshchik_final_3rd_passes_pagerank, Tekstilshchik_final_3rd_passes_transitivity)
colnames(Tekstilshchik_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Tekstilshchik_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Tekstilshchik/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Tekstilshchik_players = Tekstilshchik_progressive_passes$X
Tekstilshchik_progressive_passes$X = NULL
rownames(Tekstilshchik_progressive_passes) = Tekstilshchik_players
Tekstilshchik_progressive_passes_matrix <- as.matrix(Tekstilshchik_progressive_passes)
Tekstilshchik_progressive_passes_graph = graph_from_adjacency_matrix(Tekstilshchik_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Tekstilshchik_progressive_passes_closeness= centr_clo(Tekstilshchik_progressive_passes_graph, mode='total', normalized = TRUE)
Tekstilshchik_progressive_passes_betw = centralization.betweenness(Tekstilshchik_progressive_passes_graph, normalized =TRUE)
Tekstilshchik_progressive_passes_pagerank= page_rank(Tekstilshchik_progressive_passes_graph, algo ="power", vids = V(Tekstilshchik_progressive_passes_graph), directed = TRUE, weights = E(Tekstilshchik_progressive_passes_graph)$weight)
Tekstilshchik_progressive_passes_closeness = Tekstilshchik_progressive_passes_closeness[['res']]
Tekstilshchik_progressive_passes_betw = Tekstilshchik_progressive_passes_betw[['res']]
Tekstilshchik_progressive_passes_pagerank = Tekstilshchik_progressive_passes_pagerank[["vector"]]
Tekstilshchik_progressive_passes_transitivity = transitivity(Tekstilshchik_progressive_passes_graph,  type="weighted")
Tekstilshchik_progressive_passes_closeness[is.nan(Tekstilshchik_progressive_passes_closeness)] = 0
Tekstilshchik_progressive_passes_betw[is.nan(Tekstilshchik_progressive_passes_betw)] = 0
Tekstilshchik_progressive_passes_pagerank[is.nan(Tekstilshchik_progressive_passes_pagerank)] = 0
Tekstilshchik_progressive_passes_transitivity[is.nan(Tekstilshchik_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Tekstilshchik_progressive_passes_metrics=cbind(Tekstilshchik_players,Tekstilshchik_progressive_passes_closeness, Tekstilshchik_progressive_passes_betw,  Tekstilshchik_progressive_passes_pagerank, Tekstilshchik_progressive_passes_transitivity)
colnames(Tekstilshchik_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Tekstilshchik_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Tekstilshchik_total_passes_metrics, 
Tekstilshchik_forward_passes_metrics,
Tekstilshchik_back_passes_metrics,
Tekstilshchik_long_passes_metrics,
Tekstilshchik_final_3rd_passes_metrics,
Tekstilshchik_progressive_passes_metrics))



#norm_data
rownames(Tekstilshchik_all_passing_stats) = Tekstilshchik_players
Tekstilshchik_all_passing_stats$Player = NULL
Tekstilshchik_all_passing_stats = unfactor(Tekstilshchik_all_passing_stats)
Tekstilshchik_all_passing_stats_norm =  data.frame(lapply(Tekstilshchik_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Tekstilshchik_all_passing_stats_norm) = Tekstilshchik_players
colnames(Tekstilshchik_all_passing_stats_norm) = column_names
setwd("~/Desktop/ML_SPORTS/fnl_all_model")
write.csv(Tekstilshchik_all_passing_stats, 'Tekstilshchik_passing.csv')

Tomsk_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Tomsk/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Tomsk_players = Tomsk_total_passes$X
Tomsk_total_passes$X = NULL
rownames(Tomsk_total_passes) = Tomsk_players
Tomsk_total_passes_matrix <- as.matrix(Tomsk_total_passes)
Tomsk_total_passes_graph = graph_from_adjacency_matrix(Tomsk_total_passes_matrix, mode = "directed", weighted = TRUE)
Tomsk_total_passes_closeness= centr_clo(Tomsk_total_passes_graph, mode='total', normalized = TRUE)
Tomsk_total_passes_betw = centralization.betweenness(Tomsk_total_passes_graph, normalized =TRUE)
Tomsk_total_passes_pagerank= page_rank(Tomsk_total_passes_graph, algo ="power", vids = V(Tomsk_total_passes_graph), directed = TRUE, weights = E(Tomsk_total_passes_graph)$weight)
Tomsk_total_passes_closeness = Tomsk_total_passes_closeness[['res']]
Tomsk_total_passes_betw = Tomsk_total_passes_betw[['res']]
Tomsk_total_passes_pagerank = Tomsk_total_passes_pagerank[["vector"]]
Tomsk_total_passes_transitivity = transitivity(Tomsk_total_passes_graph,  type="weighted")
Tomsk_total_passes_closeness[is.nan(Tomsk_total_passes_closeness)] = 0
Tomsk_total_passes_betw[is.nan(Tomsk_total_passes_betw)] = 0
Tomsk_total_passes_pagerank[is.nan(Tomsk_total_passes_pagerank)] = 0
Tomsk_total_passes_transitivity[is.nan(Tomsk_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Tomsk_total_passes_metrics=cbind(Tomsk_players,Tomsk_total_passes_closeness, Tomsk_total_passes_betw,  Tomsk_total_passes_pagerank, Tomsk_total_passes_transitivity)
colnames(Tomsk_total_passes_metrics)[1] = 'Player' 

#forward_passes
Tomsk_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Tomsk/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Tomsk_players = Tomsk_forward_passes$X
Tomsk_forward_passes$X = NULL
rownames(Tomsk_forward_passes) = Tomsk_players
Tomsk_forward_passes_matrix <- as.matrix(Tomsk_forward_passes)
Tomsk_forward_passes_graph = graph_from_adjacency_matrix(Tomsk_forward_passes_matrix, mode = "directed", weighted = TRUE)
Tomsk_forward_passes_closeness= centr_clo(Tomsk_forward_passes_graph, mode='total', normalized = TRUE)
Tomsk_forward_passes_betw = centralization.betweenness(Tomsk_forward_passes_graph, normalized =TRUE)
Tomsk_forward_passes_pagerank= page_rank(Tomsk_forward_passes_graph, algo ="power", vids = V(Tomsk_forward_passes_graph), directed = TRUE, weights = E(Tomsk_forward_passes_graph)$weight)
Tomsk_forward_passes_closeness = Tomsk_forward_passes_closeness[['res']]
Tomsk_forward_passes_betw = Tomsk_forward_passes_betw[['res']]
Tomsk_forward_passes_pagerank = Tomsk_forward_passes_pagerank[["vector"]]
Tomsk_forward_passes_transitivity = transitivity(Tomsk_forward_passes_graph,  type="weighted")
Tomsk_forward_passes_closeness[is.nan(Tomsk_forward_passes_closeness)] = 0
Tomsk_forward_passes_betw[is.nan(Tomsk_forward_passes_betw)] = 0
Tomsk_forward_passes_pagerank[is.nan(Tomsk_forward_passes_pagerank)] = 0
Tomsk_forward_passes_transitivity[is.nan(Tomsk_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Tomsk_forward_passes_metrics=cbind(Tomsk_players,Tomsk_forward_passes_closeness, Tomsk_forward_passes_betw,  Tomsk_forward_passes_pagerank, Tomsk_forward_passes_transitivity)
colnames(Tomsk_forward_passes_metrics)[1] = 'Player' 


#back_passes
Tomsk_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Tomsk/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Tomsk_players = Tomsk_back_passes$X
Tomsk_back_passes$X = NULL
rownames(Tomsk_back_passes) = Tomsk_players
Tomsk_back_passes_matrix <- as.matrix(Tomsk_back_passes)
Tomsk_back_passes_graph = graph_from_adjacency_matrix(Tomsk_back_passes_matrix, mode = "directed", weighted = TRUE)
Tomsk_back_passes_closeness= centr_clo(Tomsk_back_passes_graph, mode='total', normalized = TRUE)
Tomsk_back_passes_betw = centralization.betweenness(Tomsk_back_passes_graph, normalized =TRUE)
Tomsk_back_passes_pagerank= page_rank(Tomsk_back_passes_graph, algo ="power", vids = V(Tomsk_back_passes_graph), directed = TRUE, weights = E(Tomsk_back_passes_graph)$weight)
Tomsk_back_passes_closeness = Tomsk_back_passes_closeness[['res']]
Tomsk_back_passes_betw = Tomsk_back_passes_betw[['res']]
Tomsk_back_passes_pagerank = Tomsk_back_passes_pagerank[["vector"]]
Tomsk_back_passes_transitivity = transitivity(Tomsk_back_passes_graph,  type="weighted")
Tomsk_back_passes_closeness[is.nan(Tomsk_back_passes_closeness)] = 0
Tomsk_back_passes_betw[is.nan(Tomsk_back_passes_betw)] = 0
Tomsk_back_passes_pagerank[is.nan(Tomsk_back_passes_pagerank)] = 0
Tomsk_back_passes_transitivity[is.nan(Tomsk_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Tomsk_back_passes_metrics=cbind(Tomsk_players,Tomsk_back_passes_closeness, Tomsk_back_passes_betw,  Tomsk_back_passes_pagerank, Tomsk_back_passes_transitivity)
colnames(Tomsk_back_passes_metrics)[1] = 'Player'  


#long_passes
Tomsk_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Tomsk/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Tomsk_players = Tomsk_long_passes$X
Tomsk_long_passes$X = NULL
rownames(Tomsk_long_passes) = Tomsk_players
Tomsk_long_passes_matrix <- as.matrix(Tomsk_long_passes)
Tomsk_long_passes_graph = graph_from_adjacency_matrix(Tomsk_long_passes_matrix, mode = "directed", weighted = TRUE)
Tomsk_long_passes_closeness= centr_clo(Tomsk_long_passes_graph, mode='total', normalized = TRUE)
Tomsk_long_passes_betw = centralization.betweenness(Tomsk_long_passes_graph, normalized =TRUE)
Tomsk_long_passes_pagerank= page_rank(Tomsk_long_passes_graph, algo ="power", vids = V(Tomsk_long_passes_graph), directed = TRUE, weights = E(Tomsk_long_passes_graph)$weight)
Tomsk_long_passes_closeness = Tomsk_long_passes_closeness[['res']]
Tomsk_long_passes_betw = Tomsk_long_passes_betw[['res']]
Tomsk_long_passes_pagerank = Tomsk_long_passes_pagerank[["vector"]]
Tomsk_long_passes_transitivity = transitivity(Tomsk_long_passes_graph,  type="weighted")
Tomsk_long_passes_closeness[is.nan(Tomsk_long_passes_closeness)] = 0
Tomsk_long_passes_betw[is.nan(Tomsk_long_passes_betw)] = 0
Tomsk_long_passes_pagerank[is.nan(Tomsk_long_passes_pagerank)] = 0
Tomsk_long_passes_transitivity[is.nan(Tomsk_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Tomsk_long_passes_metrics=cbind(Tomsk_players,Tomsk_long_passes_closeness, Tomsk_long_passes_betw,  Tomsk_long_passes_pagerank, Tomsk_long_passes_transitivity)
colnames(Tomsk_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Tomsk_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Tomsk/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Tomsk_players = Tomsk_final_3rd_passes$X
Tomsk_final_3rd_passes$X = NULL
rownames(Tomsk_final_3rd_passes) = Tomsk_players
Tomsk_final_3rd_passes_matrix <- as.matrix(Tomsk_final_3rd_passes)
Tomsk_final_3rd_passes_graph = graph_from_adjacency_matrix(Tomsk_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Tomsk_final_3rd_passes_closeness= centr_clo(Tomsk_final_3rd_passes_graph, mode='total', normalized = TRUE)
Tomsk_final_3rd_passes_betw = centralization.betweenness(Tomsk_final_3rd_passes_graph, normalized =TRUE)
Tomsk_final_3rd_passes_pagerank= page_rank(Tomsk_final_3rd_passes_graph, algo ="power", vids = V(Tomsk_final_3rd_passes_graph), directed = TRUE, weights = E(Tomsk_final_3rd_passes_graph)$weight)
Tomsk_final_3rd_passes_closeness = Tomsk_final_3rd_passes_closeness[['res']]
Tomsk_final_3rd_passes_betw = Tomsk_final_3rd_passes_betw[['res']]
Tomsk_final_3rd_passes_pagerank = Tomsk_final_3rd_passes_pagerank[["vector"]]
Tomsk_final_3rd_passes_transitivity = transitivity(Tomsk_final_3rd_passes_graph,  type="weighted")
Tomsk_final_3rd_passes_closeness[is.nan(Tomsk_final_3rd_passes_closeness)] = 0
Tomsk_final_3rd_passes_betw[is.nan(Tomsk_final_3rd_passes_betw)] = 0
Tomsk_final_3rd_passes_pagerank[is.nan(Tomsk_final_3rd_passes_pagerank)] = 0
Tomsk_final_3rd_passes_transitivity[is.nan(Tomsk_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Tomsk_final_3rd_passes_metrics=cbind(Tomsk_players,Tomsk_final_3rd_passes_closeness, Tomsk_final_3rd_passes_betw,  Tomsk_final_3rd_passes_pagerank, Tomsk_final_3rd_passes_transitivity)
colnames(Tomsk_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Tomsk_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Tomsk/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Tomsk_players = Tomsk_progressive_passes$X
Tomsk_progressive_passes$X = NULL
rownames(Tomsk_progressive_passes) = Tomsk_players
Tomsk_progressive_passes_matrix <- as.matrix(Tomsk_progressive_passes)
Tomsk_progressive_passes_graph = graph_from_adjacency_matrix(Tomsk_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Tomsk_progressive_passes_closeness= centr_clo(Tomsk_progressive_passes_graph, mode='total', normalized = TRUE)
Tomsk_progressive_passes_betw = centralization.betweenness(Tomsk_progressive_passes_graph, normalized =TRUE)
Tomsk_progressive_passes_pagerank= page_rank(Tomsk_progressive_passes_graph, algo ="power", vids = V(Tomsk_progressive_passes_graph), directed = TRUE, weights = E(Tomsk_progressive_passes_graph)$weight)
Tomsk_progressive_passes_closeness = Tomsk_progressive_passes_closeness[['res']]
Tomsk_progressive_passes_betw = Tomsk_progressive_passes_betw[['res']]
Tomsk_progressive_passes_pagerank = Tomsk_progressive_passes_pagerank[["vector"]]
Tomsk_progressive_passes_transitivity = transitivity(Tomsk_progressive_passes_graph,  type="weighted")
Tomsk_progressive_passes_closeness[is.nan(Tomsk_progressive_passes_closeness)] = 0
Tomsk_progressive_passes_betw[is.nan(Tomsk_progressive_passes_betw)] = 0
Tomsk_progressive_passes_pagerank[is.nan(Tomsk_progressive_passes_pagerank)] = 0
Tomsk_progressive_passes_transitivity[is.nan(Tomsk_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Tomsk_progressive_passes_metrics=cbind(Tomsk_players,Tomsk_progressive_passes_closeness, Tomsk_progressive_passes_betw,  Tomsk_progressive_passes_pagerank, Tomsk_progressive_passes_transitivity)
colnames(Tomsk_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Tomsk_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Tomsk_total_passes_metrics, 
Tomsk_forward_passes_metrics,
Tomsk_back_passes_metrics,
Tomsk_long_passes_metrics,
Tomsk_final_3rd_passes_metrics,
Tomsk_progressive_passes_metrics))



#norm_data
rownames(Tomsk_all_passing_stats) = Tomsk_players
Tomsk_all_passing_stats$Player = NULL
Tomsk_all_passing_stats = unfactor(Tomsk_all_passing_stats)
Tomsk_all_passing_stats_norm =  data.frame(lapply(Tomsk_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Tomsk_all_passing_stats_norm) = Tomsk_players
colnames(Tomsk_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Tomsk_all_passing_stats, 'Tomsk_passing.csv')


Torpedo_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Torpedo/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Torpedo_players = Torpedo_total_passes$X
Torpedo_total_passes$X = NULL
rownames(Torpedo_total_passes) = Torpedo_players
Torpedo_total_passes_matrix <- as.matrix(Torpedo_total_passes)
Torpedo_total_passes_graph = graph_from_adjacency_matrix(Torpedo_total_passes_matrix, mode = "directed", weighted = TRUE)
Torpedo_total_passes_closeness= centr_clo(Torpedo_total_passes_graph, mode='total', normalized = TRUE)
Torpedo_total_passes_betw = centralization.betweenness(Torpedo_total_passes_graph, normalized =TRUE)
Torpedo_total_passes_pagerank= page_rank(Torpedo_total_passes_graph, algo ="power", vids = V(Torpedo_total_passes_graph), directed = TRUE, weights = E(Torpedo_total_passes_graph)$weight)
Torpedo_total_passes_closeness = Torpedo_total_passes_closeness[['res']]
Torpedo_total_passes_betw = Torpedo_total_passes_betw[['res']]
Torpedo_total_passes_pagerank = Torpedo_total_passes_pagerank[["vector"]]
Torpedo_total_passes_transitivity = transitivity(Torpedo_total_passes_graph,  type="weighted")
Torpedo_total_passes_closeness[is.nan(Torpedo_total_passes_closeness)] = 0
Torpedo_total_passes_betw[is.nan(Torpedo_total_passes_betw)] = 0
Torpedo_total_passes_pagerank[is.nan(Torpedo_total_passes_pagerank)] = 0
Torpedo_total_passes_transitivity[is.nan(Torpedo_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Torpedo_total_passes_metrics=cbind(Torpedo_players,Torpedo_total_passes_closeness, Torpedo_total_passes_betw,  Torpedo_total_passes_pagerank, Torpedo_total_passes_transitivity)
colnames(Torpedo_total_passes_metrics)[1] = 'Player' 

#forward_passes
Torpedo_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Torpedo/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Torpedo_players = Torpedo_forward_passes$X
Torpedo_forward_passes$X = NULL
rownames(Torpedo_forward_passes) = Torpedo_players
Torpedo_forward_passes_matrix <- as.matrix(Torpedo_forward_passes)
Torpedo_forward_passes_graph = graph_from_adjacency_matrix(Torpedo_forward_passes_matrix, mode = "directed", weighted = TRUE)
Torpedo_forward_passes_closeness= centr_clo(Torpedo_forward_passes_graph, mode='total', normalized = TRUE)
Torpedo_forward_passes_betw = centralization.betweenness(Torpedo_forward_passes_graph, normalized =TRUE)
Torpedo_forward_passes_pagerank= page_rank(Torpedo_forward_passes_graph, algo ="power", vids = V(Torpedo_forward_passes_graph), directed = TRUE, weights = E(Torpedo_forward_passes_graph)$weight)
Torpedo_forward_passes_closeness = Torpedo_forward_passes_closeness[['res']]
Torpedo_forward_passes_betw = Torpedo_forward_passes_betw[['res']]
Torpedo_forward_passes_pagerank = Torpedo_forward_passes_pagerank[["vector"]]
Torpedo_forward_passes_transitivity = transitivity(Torpedo_forward_passes_graph,  type="weighted")
Torpedo_forward_passes_closeness[is.nan(Torpedo_forward_passes_closeness)] = 0
Torpedo_forward_passes_betw[is.nan(Torpedo_forward_passes_betw)] = 0
Torpedo_forward_passes_pagerank[is.nan(Torpedo_forward_passes_pagerank)] = 0
Torpedo_forward_passes_transitivity[is.nan(Torpedo_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Torpedo_forward_passes_metrics=cbind(Torpedo_players,Torpedo_forward_passes_closeness, Torpedo_forward_passes_betw,  Torpedo_forward_passes_pagerank, Torpedo_forward_passes_transitivity)
colnames(Torpedo_forward_passes_metrics)[1] = 'Player' 


#back_passes
Torpedo_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Torpedo/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Torpedo_players = Torpedo_back_passes$X
Torpedo_back_passes$X = NULL
rownames(Torpedo_back_passes) = Torpedo_players
Torpedo_back_passes_matrix <- as.matrix(Torpedo_back_passes)
Torpedo_back_passes_graph = graph_from_adjacency_matrix(Torpedo_back_passes_matrix, mode = "directed", weighted = TRUE)
Torpedo_back_passes_closeness= centr_clo(Torpedo_back_passes_graph, mode='total', normalized = TRUE)
Torpedo_back_passes_betw = centralization.betweenness(Torpedo_back_passes_graph, normalized =TRUE)
Torpedo_back_passes_pagerank= page_rank(Torpedo_back_passes_graph, algo ="power", vids = V(Torpedo_back_passes_graph), directed = TRUE, weights = E(Torpedo_back_passes_graph)$weight)
Torpedo_back_passes_closeness = Torpedo_back_passes_closeness[['res']]
Torpedo_back_passes_betw = Torpedo_back_passes_betw[['res']]
Torpedo_back_passes_pagerank = Torpedo_back_passes_pagerank[["vector"]]
Torpedo_back_passes_transitivity = transitivity(Torpedo_back_passes_graph,  type="weighted")
Torpedo_back_passes_closeness[is.nan(Torpedo_back_passes_closeness)] = 0
Torpedo_back_passes_betw[is.nan(Torpedo_back_passes_betw)] = 0
Torpedo_back_passes_pagerank[is.nan(Torpedo_back_passes_pagerank)] = 0
Torpedo_back_passes_transitivity[is.nan(Torpedo_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Torpedo_back_passes_metrics=cbind(Torpedo_players,Torpedo_back_passes_closeness, Torpedo_back_passes_betw,  Torpedo_back_passes_pagerank, Torpedo_back_passes_transitivity)
colnames(Torpedo_back_passes_metrics)[1] = 'Player'  


#long_passes
Torpedo_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Torpedo/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Torpedo_players = Torpedo_long_passes$X
Torpedo_long_passes$X = NULL
rownames(Torpedo_long_passes) = Torpedo_players
Torpedo_long_passes_matrix <- as.matrix(Torpedo_long_passes)
Torpedo_long_passes_graph = graph_from_adjacency_matrix(Torpedo_long_passes_matrix, mode = "directed", weighted = TRUE)
Torpedo_long_passes_closeness= centr_clo(Torpedo_long_passes_graph, mode='total', normalized = TRUE)
Torpedo_long_passes_betw = centralization.betweenness(Torpedo_long_passes_graph, normalized =TRUE)
Torpedo_long_passes_pagerank= page_rank(Torpedo_long_passes_graph, algo ="power", vids = V(Torpedo_long_passes_graph), directed = TRUE, weights = E(Torpedo_long_passes_graph)$weight)
Torpedo_long_passes_closeness = Torpedo_long_passes_closeness[['res']]
Torpedo_long_passes_betw = Torpedo_long_passes_betw[['res']]
Torpedo_long_passes_pagerank = Torpedo_long_passes_pagerank[["vector"]]
Torpedo_long_passes_transitivity = transitivity(Torpedo_long_passes_graph,  type="weighted")
Torpedo_long_passes_closeness[is.nan(Torpedo_long_passes_closeness)] = 0
Torpedo_long_passes_betw[is.nan(Torpedo_long_passes_betw)] = 0
Torpedo_long_passes_pagerank[is.nan(Torpedo_long_passes_pagerank)] = 0
Torpedo_long_passes_transitivity[is.nan(Torpedo_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Torpedo_long_passes_metrics=cbind(Torpedo_players,Torpedo_long_passes_closeness, Torpedo_long_passes_betw,  Torpedo_long_passes_pagerank, Torpedo_long_passes_transitivity)
colnames(Torpedo_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Torpedo_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Torpedo/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Torpedo_players = Torpedo_final_3rd_passes$X
Torpedo_final_3rd_passes$X = NULL
rownames(Torpedo_final_3rd_passes) = Torpedo_players
Torpedo_final_3rd_passes_matrix <- as.matrix(Torpedo_final_3rd_passes)
Torpedo_final_3rd_passes_graph = graph_from_adjacency_matrix(Torpedo_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Torpedo_final_3rd_passes_closeness= centr_clo(Torpedo_final_3rd_passes_graph, mode='total', normalized = TRUE)
Torpedo_final_3rd_passes_betw = centralization.betweenness(Torpedo_final_3rd_passes_graph, normalized =TRUE)
Torpedo_final_3rd_passes_pagerank= page_rank(Torpedo_final_3rd_passes_graph, algo ="power", vids = V(Torpedo_final_3rd_passes_graph), directed = TRUE, weights = E(Torpedo_final_3rd_passes_graph)$weight)
Torpedo_final_3rd_passes_closeness = Torpedo_final_3rd_passes_closeness[['res']]
Torpedo_final_3rd_passes_betw = Torpedo_final_3rd_passes_betw[['res']]
Torpedo_final_3rd_passes_pagerank = Torpedo_final_3rd_passes_pagerank[["vector"]]
Torpedo_final_3rd_passes_transitivity = transitivity(Torpedo_final_3rd_passes_graph,  type="weighted")
Torpedo_final_3rd_passes_closeness[is.nan(Torpedo_final_3rd_passes_closeness)] = 0
Torpedo_final_3rd_passes_betw[is.nan(Torpedo_final_3rd_passes_betw)] = 0
Torpedo_final_3rd_passes_pagerank[is.nan(Torpedo_final_3rd_passes_pagerank)] = 0
Torpedo_final_3rd_passes_transitivity[is.nan(Torpedo_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Torpedo_final_3rd_passes_metrics=cbind(Torpedo_players,Torpedo_final_3rd_passes_closeness, Torpedo_final_3rd_passes_betw,  Torpedo_final_3rd_passes_pagerank, Torpedo_final_3rd_passes_transitivity)
colnames(Torpedo_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Torpedo_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Torpedo/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Torpedo_players = Torpedo_progressive_passes$X
Torpedo_progressive_passes$X = NULL
rownames(Torpedo_progressive_passes) = Torpedo_players
Torpedo_progressive_passes_matrix <- as.matrix(Torpedo_progressive_passes)
Torpedo_progressive_passes_graph = graph_from_adjacency_matrix(Torpedo_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Torpedo_progressive_passes_closeness= centr_clo(Torpedo_progressive_passes_graph, mode='total', normalized = TRUE)
Torpedo_progressive_passes_betw = centralization.betweenness(Torpedo_progressive_passes_graph, normalized =TRUE)
Torpedo_progressive_passes_pagerank= page_rank(Torpedo_progressive_passes_graph, algo ="power", vids = V(Torpedo_progressive_passes_graph), directed = TRUE, weights = E(Torpedo_progressive_passes_graph)$weight)
Torpedo_progressive_passes_closeness = Torpedo_progressive_passes_closeness[['res']]
Torpedo_progressive_passes_betw = Torpedo_progressive_passes_betw[['res']]
Torpedo_progressive_passes_pagerank = Torpedo_progressive_passes_pagerank[["vector"]]
Torpedo_progressive_passes_transitivity = transitivity(Torpedo_progressive_passes_graph,  type="weighted")
Torpedo_progressive_passes_closeness[is.nan(Torpedo_progressive_passes_closeness)] = 0
Torpedo_progressive_passes_betw[is.nan(Torpedo_progressive_passes_betw)] = 0
Torpedo_progressive_passes_pagerank[is.nan(Torpedo_progressive_passes_pagerank)] = 0
Torpedo_progressive_passes_transitivity[is.nan(Torpedo_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Torpedo_progressive_passes_metrics=cbind(Torpedo_players,Torpedo_progressive_passes_closeness, Torpedo_progressive_passes_betw,  Torpedo_progressive_passes_pagerank, Torpedo_progressive_passes_transitivity)
colnames(Torpedo_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Torpedo_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Torpedo_total_passes_metrics, 
Torpedo_forward_passes_metrics,
Torpedo_back_passes_metrics,
Torpedo_long_passes_metrics,
Torpedo_final_3rd_passes_metrics,
Torpedo_progressive_passes_metrics))



#norm_data
rownames(Torpedo_all_passing_stats) = Torpedo_players
Torpedo_all_passing_stats$Player = NULL
Torpedo_all_passing_stats = unfactor(Torpedo_all_passing_stats)
Torpedo_all_passing_stats_norm =  data.frame(lapply(Torpedo_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Torpedo_all_passing_stats_norm) = Torpedo_players
colnames(Torpedo_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Torpedo_all_passing_stats, 'Torpedo_passing.csv')


Yenesiy_total_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Yenesiy/passes/gen_matrix/avg_gen_1.csv', stringsAsFactors  = FALSE)
Yenesiy_players = Yenesiy_total_passes$X
Yenesiy_total_passes$X = NULL
rownames(Yenesiy_total_passes) = Yenesiy_players
Yenesiy_total_passes_matrix <- as.matrix(Yenesiy_total_passes)
Yenesiy_total_passes_graph = graph_from_adjacency_matrix(Yenesiy_total_passes_matrix, mode = "directed", weighted = TRUE)
Yenesiy_total_passes_closeness= centr_clo(Yenesiy_total_passes_graph, mode='total', normalized = TRUE)
Yenesiy_total_passes_betw = centralization.betweenness(Yenesiy_total_passes_graph, normalized =TRUE)
Yenesiy_total_passes_pagerank= page_rank(Yenesiy_total_passes_graph, algo ="power", vids = V(Yenesiy_total_passes_graph), directed = TRUE, weights = E(Yenesiy_total_passes_graph)$weight)
Yenesiy_total_passes_closeness = Yenesiy_total_passes_closeness[['res']]
Yenesiy_total_passes_betw = Yenesiy_total_passes_betw[['res']]
Yenesiy_total_passes_pagerank = Yenesiy_total_passes_pagerank[["vector"]]
Yenesiy_total_passes_transitivity = transitivity(Yenesiy_total_passes_graph,  type="weighted")
Yenesiy_total_passes_closeness[is.nan(Yenesiy_total_passes_closeness)] = 0
Yenesiy_total_passes_betw[is.nan(Yenesiy_total_passes_betw)] = 0
Yenesiy_total_passes_pagerank[is.nan(Yenesiy_total_passes_pagerank)] = 0
Yenesiy_total_passes_transitivity[is.nan(Yenesiy_total_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Yenesiy_total_passes_metrics=cbind(Yenesiy_players,Yenesiy_total_passes_closeness, Yenesiy_total_passes_betw,  Yenesiy_total_passes_pagerank, Yenesiy_total_passes_transitivity)
colnames(Yenesiy_total_passes_metrics)[1] = 'Player' 

#forward_passes
Yenesiy_forward_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Yenesiy/passes/gen_matrix/avg_gen_2.csv', stringsAsFactors  = FALSE)
Yenesiy_players = Yenesiy_forward_passes$X
Yenesiy_forward_passes$X = NULL
rownames(Yenesiy_forward_passes) = Yenesiy_players
Yenesiy_forward_passes_matrix <- as.matrix(Yenesiy_forward_passes)
Yenesiy_forward_passes_graph = graph_from_adjacency_matrix(Yenesiy_forward_passes_matrix, mode = "directed", weighted = TRUE)
Yenesiy_forward_passes_closeness= centr_clo(Yenesiy_forward_passes_graph, mode='total', normalized = TRUE)
Yenesiy_forward_passes_betw = centralization.betweenness(Yenesiy_forward_passes_graph, normalized =TRUE)
Yenesiy_forward_passes_pagerank= page_rank(Yenesiy_forward_passes_graph, algo ="power", vids = V(Yenesiy_forward_passes_graph), directed = TRUE, weights = E(Yenesiy_forward_passes_graph)$weight)
Yenesiy_forward_passes_closeness = Yenesiy_forward_passes_closeness[['res']]
Yenesiy_forward_passes_betw = Yenesiy_forward_passes_betw[['res']]
Yenesiy_forward_passes_pagerank = Yenesiy_forward_passes_pagerank[["vector"]]
Yenesiy_forward_passes_transitivity = transitivity(Yenesiy_forward_passes_graph,  type="weighted")
Yenesiy_forward_passes_closeness[is.nan(Yenesiy_forward_passes_closeness)] = 0
Yenesiy_forward_passes_betw[is.nan(Yenesiy_forward_passes_betw)] = 0
Yenesiy_forward_passes_pagerank[is.nan(Yenesiy_forward_passes_pagerank)] = 0
Yenesiy_forward_passes_transitivity[is.nan(Yenesiy_forward_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Yenesiy_forward_passes_metrics=cbind(Yenesiy_players,Yenesiy_forward_passes_closeness, Yenesiy_forward_passes_betw,  Yenesiy_forward_passes_pagerank, Yenesiy_forward_passes_transitivity)
colnames(Yenesiy_forward_passes_metrics)[1] = 'Player' 


#back_passes
Yenesiy_back_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Yenesiy/passes/gen_matrix/avg_gen_3.csv', stringsAsFactors  = FALSE)
Yenesiy_players = Yenesiy_back_passes$X
Yenesiy_back_passes$X = NULL
rownames(Yenesiy_back_passes) = Yenesiy_players
Yenesiy_back_passes_matrix <- as.matrix(Yenesiy_back_passes)
Yenesiy_back_passes_graph = graph_from_adjacency_matrix(Yenesiy_back_passes_matrix, mode = "directed", weighted = TRUE)
Yenesiy_back_passes_closeness= centr_clo(Yenesiy_back_passes_graph, mode='total', normalized = TRUE)
Yenesiy_back_passes_betw = centralization.betweenness(Yenesiy_back_passes_graph, normalized =TRUE)
Yenesiy_back_passes_pagerank= page_rank(Yenesiy_back_passes_graph, algo ="power", vids = V(Yenesiy_back_passes_graph), directed = TRUE, weights = E(Yenesiy_back_passes_graph)$weight)
Yenesiy_back_passes_closeness = Yenesiy_back_passes_closeness[['res']]
Yenesiy_back_passes_betw = Yenesiy_back_passes_betw[['res']]
Yenesiy_back_passes_pagerank = Yenesiy_back_passes_pagerank[["vector"]]
Yenesiy_back_passes_transitivity = transitivity(Yenesiy_back_passes_graph,  type="weighted")
Yenesiy_back_passes_closeness[is.nan(Yenesiy_back_passes_closeness)] = 0
Yenesiy_back_passes_betw[is.nan(Yenesiy_back_passes_betw)] = 0
Yenesiy_back_passes_pagerank[is.nan(Yenesiy_back_passes_pagerank)] = 0
Yenesiy_back_passes_transitivity[is.nan(Yenesiy_back_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Yenesiy_back_passes_metrics=cbind(Yenesiy_players,Yenesiy_back_passes_closeness, Yenesiy_back_passes_betw,  Yenesiy_back_passes_pagerank, Yenesiy_back_passes_transitivity)
colnames(Yenesiy_back_passes_metrics)[1] = 'Player'  


#long_passes
Yenesiy_long_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Yenesiy/passes/gen_matrix/avg_gen_5.csv', stringsAsFactors  = FALSE)
Yenesiy_players = Yenesiy_long_passes$X
Yenesiy_long_passes$X = NULL
rownames(Yenesiy_long_passes) = Yenesiy_players
Yenesiy_long_passes_matrix <- as.matrix(Yenesiy_long_passes)
Yenesiy_long_passes_graph = graph_from_adjacency_matrix(Yenesiy_long_passes_matrix, mode = "directed", weighted = TRUE)
Yenesiy_long_passes_closeness= centr_clo(Yenesiy_long_passes_graph, mode='total', normalized = TRUE)
Yenesiy_long_passes_betw = centralization.betweenness(Yenesiy_long_passes_graph, normalized =TRUE)
Yenesiy_long_passes_pagerank= page_rank(Yenesiy_long_passes_graph, algo ="power", vids = V(Yenesiy_long_passes_graph), directed = TRUE, weights = E(Yenesiy_long_passes_graph)$weight)
Yenesiy_long_passes_closeness = Yenesiy_long_passes_closeness[['res']]
Yenesiy_long_passes_betw = Yenesiy_long_passes_betw[['res']]
Yenesiy_long_passes_pagerank = Yenesiy_long_passes_pagerank[["vector"]]
Yenesiy_long_passes_transitivity = transitivity(Yenesiy_long_passes_graph,  type="weighted")
Yenesiy_long_passes_closeness[is.nan(Yenesiy_long_passes_closeness)] = 0
Yenesiy_long_passes_betw[is.nan(Yenesiy_long_passes_betw)] = 0
Yenesiy_long_passes_pagerank[is.nan(Yenesiy_long_passes_pagerank)] = 0
Yenesiy_long_passes_transitivity[is.nan(Yenesiy_long_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Yenesiy_long_passes_metrics=cbind(Yenesiy_players,Yenesiy_long_passes_closeness, Yenesiy_long_passes_betw,  Yenesiy_long_passes_pagerank, Yenesiy_long_passes_transitivity)
colnames(Yenesiy_long_passes_metrics)[1] = 'Player'   


#final_3rd_passes
Yenesiy_final_3rd_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Yenesiy/passes/gen_matrix/avg_gen_6.csv', stringsAsFactors  = FALSE)
Yenesiy_players = Yenesiy_final_3rd_passes$X
Yenesiy_final_3rd_passes$X = NULL
rownames(Yenesiy_final_3rd_passes) = Yenesiy_players
Yenesiy_final_3rd_passes_matrix <- as.matrix(Yenesiy_final_3rd_passes)
Yenesiy_final_3rd_passes_graph = graph_from_adjacency_matrix(Yenesiy_final_3rd_passes_matrix, mode = "directed", weighted = TRUE)
Yenesiy_final_3rd_passes_closeness= centr_clo(Yenesiy_final_3rd_passes_graph, mode='total', normalized = TRUE)
Yenesiy_final_3rd_passes_betw = centralization.betweenness(Yenesiy_final_3rd_passes_graph, normalized =TRUE)
Yenesiy_final_3rd_passes_pagerank= page_rank(Yenesiy_final_3rd_passes_graph, algo ="power", vids = V(Yenesiy_final_3rd_passes_graph), directed = TRUE, weights = E(Yenesiy_final_3rd_passes_graph)$weight)
Yenesiy_final_3rd_passes_closeness = Yenesiy_final_3rd_passes_closeness[['res']]
Yenesiy_final_3rd_passes_betw = Yenesiy_final_3rd_passes_betw[['res']]
Yenesiy_final_3rd_passes_pagerank = Yenesiy_final_3rd_passes_pagerank[["vector"]]
Yenesiy_final_3rd_passes_transitivity = transitivity(Yenesiy_final_3rd_passes_graph,  type="weighted")
Yenesiy_final_3rd_passes_closeness[is.nan(Yenesiy_final_3rd_passes_closeness)] = 0
Yenesiy_final_3rd_passes_betw[is.nan(Yenesiy_final_3rd_passes_betw)] = 0
Yenesiy_final_3rd_passes_pagerank[is.nan(Yenesiy_final_3rd_passes_pagerank)] = 0
Yenesiy_final_3rd_passes_transitivity[is.nan(Yenesiy_final_3rd_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Yenesiy_final_3rd_passes_metrics=cbind(Yenesiy_players,Yenesiy_final_3rd_passes_closeness, Yenesiy_final_3rd_passes_betw,  Yenesiy_final_3rd_passes_pagerank, Yenesiy_final_3rd_passes_transitivity)
colnames(Yenesiy_final_3rd_passes_metrics)[1] = 'Player'



#progressive
Yenesiy_progressive_passes = read.csv('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_passing/Yenesiy/passes/gen_matrix/avg_gen_7.csv', stringsAsFactors  = FALSE)
Yenesiy_players = Yenesiy_progressive_passes$X
Yenesiy_progressive_passes$X = NULL
rownames(Yenesiy_progressive_passes) = Yenesiy_players
Yenesiy_progressive_passes_matrix <- as.matrix(Yenesiy_progressive_passes)
Yenesiy_progressive_passes_graph = graph_from_adjacency_matrix(Yenesiy_progressive_passes_matrix, mode = "directed", weighted = TRUE)
Yenesiy_progressive_passes_closeness= centr_clo(Yenesiy_progressive_passes_graph, mode='total', normalized = TRUE)
Yenesiy_progressive_passes_betw = centralization.betweenness(Yenesiy_progressive_passes_graph, normalized =TRUE)
Yenesiy_progressive_passes_pagerank= page_rank(Yenesiy_progressive_passes_graph, algo ="power", vids = V(Yenesiy_progressive_passes_graph), directed = TRUE, weights = E(Yenesiy_progressive_passes_graph)$weight)
Yenesiy_progressive_passes_closeness = Yenesiy_progressive_passes_closeness[['res']]
Yenesiy_progressive_passes_betw = Yenesiy_progressive_passes_betw[['res']]
Yenesiy_progressive_passes_pagerank = Yenesiy_progressive_passes_pagerank[["vector"]]
Yenesiy_progressive_passes_transitivity = transitivity(Yenesiy_progressive_passes_graph,  type="weighted")
Yenesiy_progressive_passes_closeness[is.nan(Yenesiy_progressive_passes_closeness)] = 0
Yenesiy_progressive_passes_betw[is.nan(Yenesiy_progressive_passes_betw)] = 0
Yenesiy_progressive_passes_pagerank[is.nan(Yenesiy_progressive_passes_pagerank)] = 0
Yenesiy_progressive_passes_transitivity[is.nan(Yenesiy_progressive_passes_transitivity)] = 0
clo_name<- "Closeness"
betw_name = 'Betweenness'
transitivity_name= 'Transitivity'
pagerank_name = 'Pagerank'
Yenesiy_progressive_passes_metrics=cbind(Yenesiy_players,Yenesiy_progressive_passes_closeness, Yenesiy_progressive_passes_betw,  Yenesiy_progressive_passes_pagerank, Yenesiy_progressive_passes_transitivity)
colnames(Yenesiy_progressive_passes_metrics)[1] = 'Player' 


#passing_stats
Yenesiy_all_passing_stats=Reduce(function(x, y) merge(x, y, by='Player'), list(
Yenesiy_total_passes_metrics, 
Yenesiy_forward_passes_metrics,
Yenesiy_back_passes_metrics,
Yenesiy_long_passes_metrics,
Yenesiy_final_3rd_passes_metrics,
Yenesiy_progressive_passes_metrics))



#norm_data
rownames(Yenesiy_all_passing_stats) = Yenesiy_players
Yenesiy_all_passing_stats$Player = NULL
Yenesiy_all_passing_stats = unfactor(Yenesiy_all_passing_stats)
Yenesiy_all_passing_stats_norm =  data.frame(lapply(Yenesiy_all_passing_stats, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
rownames(Yenesiy_all_passing_stats_norm) = Yenesiy_players
colnames(Yenesiy_all_passing_stats_norm) = column_names
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(Yenesiy_all_passing_stats, 'Yenesiy_passing.csv')

all_passing_stats_norm = rbind(Avangard_all_passing_stats_norm, Armavir_all_passing_stats_norm, Baltika_all_passing_stats_norm,Chayka_all_passing_stats_norm,Chertanovo_all_passing_stats_norm,Fakel_all_passing_stats_norm,Khimki_all_passing_stats_norm,Krasnodar_all_passing_stats_norm,Luch_all_passing_stats_norm,Mordovia_all_passing_stats_norm,Neftekhimik_all_passing_stats_norm,NizhnyNovgorod_all_passing_stats_norm,Rotor_all_passing_stats_norm,Shinnik_all_passing_stats_norm,
Ska_all_passing_stats_norm,Spartak_all_passing_stats_norm,Tekstilshchik_all_passing_stats_norm,
Tomsk_all_passing_stats_norm,Torpedo_all_passing_stats_norm,Yenesiy_all_passing_stats_norm)
#setwd("~/Desktop/ML_SPORTS/fnl_all_model")
#write.csv(all_passing_stats_norm, 'FNL_passing.csv')



```



write.csv(all_passing_stats_norm, 'FNL_passing.csv')


```{r}

             
             
             



fviz_nbclust(all_passing_stats_norm  , kmeans,
             method = 'gap_stat')


km.res <- kmeans(all_passing_stats_norm,  8, nstart = 25)
all_passing_stats_norm_with_clusters=all_passing_stats_norm
clusters = km.res[["cluster"]]
cluster_centers = km.res[["centers"]]
all_passing_stats_norm_with_clusters<- clusters
all_passing_stats_norm_with_clusters= cbind(all_passing_stats_norm_with_clusters, all_passing_stats_norm_with_clusters)
all_passing_stats_norm$Cluster = all_passing_stats_norm_with_clusters
write.csv(all_passing_stats_norm, 'clustering_output.csv')









#plot=fviz_cluster(km.res, data =all_data_with_clusters,  ellipse = TRUE,
            # ellipse.type = "convex", pointsize = 2, labelsize = 8, ellipse.alpha=0.8, 
#             palette = "jco",
#             repel = TRUE,
#             ggtheme = theme_gray(),
#             alpha = 0.75,show_labels = FALSE)
#plot(plot)

library(autoplotly)
p=autoplotly(km.res, data = all_passing_stats_norm, frame = T,label = F, label.size = 3)
p %>% plotly::layout(annotations = list(
  text = "Example Text",
  font = list(
    family = "Courier New, monospace",
    size = 18,
    color = "black"),
  x = 2,
  y = 2,
  showarrow = TRUE))
#all_data_with_clusters$cluster

#all_data_to_export$clusters = all_data_with_clusters$cluster
```



```{r,model_data}

fnl_all_stats=read.xlsx('/Users/aleksandr/Desktop/ML_SPORTS/FNL/FNL_advanced_data/FNL_general.xlsx', sheet=1)
fnl_all_stats = subset(fnl_all_stats,  fnl_all_stats$Position!='GK')
data_to_model = fnl_all_stats
data_to_model_Player = data_to_model$Player

data_to_model$Player = NULL
data_to_model$Team = NULL
data_to_model$Position= NULL
data_to_model$Market.value = NULL
data_to_model$Contract.expires = NULL
data_to_model$Matches.played = NULL
data_to_model$Minutes.played = NULL
data_to_model$Goals.total =  NULL
data_to_model$Birth.country  = NULL
data_to_model$Passport.country = NULL
data_to_model$Foot = NULL
data_to_model$Height = NULL
data_to_model$Weight = NULL                     
data_to_model$On.loan = NULL 
data_to_model$Age= NULL 
data_to_model[is.na(data_to_model)] = 0
data_to_model[data_to_model==" "]<-0
data_to_model_norm=  data.frame(lapply(data_to_model, function(x) round((x-min(x))/(max(x)-min(x)), 1)))
data_to_model_norm$Player = data_to_model_Player


all_passing_stats_norm$Player =  rownames(all_passing_stats_norm)
all_passing_stats_norm = all_passing_stats_norm %>% separate (Player, c('Number', 'Name', 'Surname'))
all_passing_stats_norm$dot='.'
all_passing_stats_norm$Key_temp <- paste(all_passing_stats_norm$Name,all_passing_stats_norm$dot)
all_passing_stats_norm$Key_temp <- str_replace_all(all_passing_stats_norm$Key_temp, fixed(" "), "")
all_passing_stats_norm$Player = paste(all_passing_stats_norm$Key_temp, all_passing_stats_norm$Surname)
all_passing_stats_norm[ ,c('Number', 'Name', 'Surname', 'Key_temp', 'dot')] <- list(NULL)



adv_colnames = colnames(data_to_model_norm)
adv_colnames = rev(adv_colnames)
data_to_model_norm<- data_to_model_norm[, adv_colnames]


model_data= merge(x = all_passing_stats_norm, y = data_to_model_norm, by = "Player")

model_data=model_data[!duplicated(model_data$Player), ]
rownames(model_data) = model_data$Player
model_data$Player = NULL

```

fviz_nbclust(x, FUNcluster = NULL, method = c("silhouette", "wss",
  "gap_stat"), diss = NULL, k.max = 10, nboot = 100,
  verbose = interactive(), barfill = "steelblue",
  barcolor = "steelblue", linecolor = "steelblue",
  print.summary = TRUE, ...)

```{r}

             
             
             



fviz_nbclust(model_data  , kmeans,
             method = 'gap_stat', k.max=30)

fviz_nbclust(model_data  , kmeans,
             method = 'silhouette', k.max=30)

fviz_nbclust(model_data  , kmeans,
             method = 'wss', k.max=30)



km.res <- kmeans(model_data , 30, nstart = 25)
model_data_with_clusters=model_data
clusters = km.res[["cluster"]]
cluster_centers = km.res[["centers"]]

#all_passing_stats_norm_with_clusters= cbind(all_passing_stats_norm_with_clusters, all_passing_stats_norm_with_clusters)
#all_passing_stats_norm$Cluster = all_passing_stats_norm_with_clusters
write.csv(all_passing_stats_norm, 'clustering_output.csv')









#plot=fviz_cluster(km.res, data =all_data_with_clusters,  ellipse = TRUE,
            # ellipse.type = "convex", pointsize = 2, labelsize = 8, ellipse.alpha=0.8, 
#             palette = "jco",
#             repel = TRUE,
#             ggtheme = theme_gray(),
#             alpha = 0.75,show_labels = FALSE)
#plot(plot)

library(autoplotly)
p=autoplotly(km.res, data = model_data_with_clusters, frame = F,label = F, label.size = 3)
p %>% plotly::layout(annotations = list(
  text = "Example Text",
  font = list(
    family = "Courier New, monospace",
    size = 18,
    color = "black"),
  x = 2,
  y = 2,
  showarrow = TRUE))
#all_data_with_clusters$cluster

#all_data_to_export$clusters = all_data_with_clusters$cluster
model_data_with_clusters$Player = rownames(model_data_with_clusters)
model_data_with_clusters$cluster<- clusters






```

write.csv(model_data_with_clusters, 'clustering_output.csv')
write.csv(cluster_centers, 'cluster_centers.csv')


rownames(fnl_all_stats) = fnl_all_stats$Player

fnl_all_stats=fnl_all_stats[!duplicated(fnl_all_stats$Player), ]
rownames(fnl_all_stats) = fnl_all_stats$Player
model_data$Player = NULL



fnl_to_export= merge(x = fnl_all_stats, y = model_data_with_clusters$cluster, by="row.names")


model_data_with_clusters$Player
fnl_all_stats$Player



************
to_split = all_passing_stats_norm
to_split$Player = rownames(to_split)
to_split = to_split %>% separate (Player, c('Number', 'Name', 'Surname'))
to_split$dot='.'
to_split$Key_temp <- paste(to_split$Name,to_split$dot)
to_split$Key_temp <- str_replace_all(to_split$Key_temp, fixed(" "), "")
to_split$Player = paste(to_split$Key_temp, to_split$Surname)
to_split[ ,c('Number', 'Name', 'Surname', 'Key_temp', 'dot')] <- list(NULL)
test_merge= merge(x = to_split, y = fnl_all_stats, by = "Player")
************




